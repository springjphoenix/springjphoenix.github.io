{"version":3,"sources":["webpack:///path---page-5-f514c60eb5c029cd6f8d.js","webpack:///./.cache/json/page-5.json"],"names":["webpackJsonp","630","module","exports","data","site","siteMetadata","title","allMarkdownRemark","edges","node","html","timeToRead","excerpt","fields","slug","frontmatter","date","category","tags","pathContext","current","skip","total"],"mappings":"AAAAA,cAAc,gBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,MAAA,mBAA0BC,mBAAsBC,QAAUC,MAAQC,KAAA,4xFAAAC,WAAA,EAAAC,QAAA,IAAAC,QAAw3FC,KAAA,gBAAsBC,aAAgBT,MAAA,SAAAU,KAAA,aAAAC,SAAA,KAAAC,MAAA,yDAAsHT,MAAQC,KAAA,umaAAu3XC,WAAA,EAAAC,QAAA,sHAAAC,QAA01DC,KAAA,kBAAwBC,aAAgBT,MAAA,eAAAU,KAAA,aAAAC,SAAA,KAAAC,MAAA,2CAA8GT,MAAQC,KAAA;AAAq5iDC,WAAA,EAAAC,QAAA,qIAAAC,QAAoSC,KAAA,uCAA6CC,aAAgBT,MAAA,sCAAAU,KAAA,aAAAC,SAAA,KAAAC,MAAA,aAAuGT,MAAQC,KAAA,gUAA4RC,WAAA,EAAAC,QAAA,sIAAAC,QAAsNC,KAAA,2CAAiDC,aAAgBT,MAAA,+BAAAU,KAAA,aAAAC,SAAA,UAAAC,MAAA,8BAAsHT,MAAQC,KAAA,yLAAAC,WAAA,EAAAC,QAAA,6FAAAC,QAAkUC,KAAA,2BAAiCC,aAAgBT,MAAA,iBAAAU,KAAA,aAAAC,SAAA,KAAAC,MAAA,6BAAkGT,MAAQC,KAAA,qqSAA8vDC,WAAA,EAAAC,QAAA,mIAAAC,QAAotPC,KAAA,iCAAuCC,aAAgBT,MAAA,sBAAAU,KAAA,aAAAC,SAAA,SAAAC,MAAA,yBAAuGT,MAAQC,KAAA,uxPAAAC,WAAA,EAAAC,QAAA,wIAAAC,QAAqtQC,KAAA,wBAA8BC,aAAgBT,MAAA,iBAAAU,KAAA,aAAAC,SAAA,UAAAC,MAAA,mCAA6GT,MAAQC,KAAA,mmUAA2rRC,WAAA,EAAAC,QAAA,yIAAAC,QAA+/DC,KAAA,gBAAsBC,aAAgBT,MAAA,WAAAU,KAAA,aAAAC,SAAA,OAAAC,MAAA,gDAAiHT,MAAQC,KAAA;AAA4yUC,WAAA,EAAAC,QAAA,wIAAAC,QAA02IC,KAAA,8BAAoCC,aAAgBT,MAAA,gBAAAU,KAAA,aAAAC,SAAA,OAAAC,MAAA,2BAAiGT,MAAQC,KAAA;AAA8pwFC,WAAA,EAAAC,QAAA,sIAAAC,QAA2gFC,KAAA,8CAAoDC,aAAgBT,MAAA,qCAAAU,KAAA,aAAAC,SAAA,OAAAC,MAAA,yCAAmIC,aAAgBC,QAAA,EAAAC,KAAA,GAAAC,MAAA","file":"path---page-5-f514c60eb5c029cd6f8d.js","sourcesContent":["webpackJsonp([10891958300999],{\n\n/***/ 630:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Magicly's Blog\"}},\"allMarkdownRemark\":{\"edges\":[{\"node\":{\"html\":\"<p>æœºå™¨å­¦ä¹ å·²ç»å½±å“äº†æˆ‘ä»¬ç”Ÿæ´»ä¸­çš„æ¯ä¸€ä¸ªåœ°æ–¹ï¼Œ äº†è§£ä¸€äº›æœºå™¨å­¦ä¹ çŸ¥è¯†ï¼Œ ä¾¿äºæé«˜ç«äº‰åŠ›ï¼Œ é¿å…è¢«æœºå™¨æ›¿ä»£ã€‚\\nä¸‹é¢æ˜¯æˆ‘å‚è€ƒå’¨è¯¢äº†å¾ˆå¤šå¤§ç‰›ä¹‹åæœé›†æ•´ç†çš„ä¸€äº›å­¦ä¹ èµ„æ–™ï¼Œ åŸºæœ¬éƒ½æ˜¯è¯¥é¢†åŸŸä¸–ç•Œæœ€é¡¶å°–çš„é«˜æ‰‹äº²è‡ªæˆè¯¾ï¼Œä»¥åŠä¸€äº›æœ€æµè¡Œçš„å·¥å…·åº“ï¼Œ å€¼å¾—å­¦ä¹ ã€‚</p>\\n<!-- more -->\\n<ul>\\n<li>å°æ¹¾å¤§å­¦æå®æ¯…è€å¸ˆçš„æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ è¯¾ç¨‹ï¼Œ<a href=\\\"http://speech.ee.ntu.edu.tw/~tlkagk/courses.html%EF%BC%8C\\\">http://speech.ee.ntu.edu.tw/~tlkagk/courses.htmlï¼Œ</a> bilibiliä¸Šæœ‰è§†é¢‘ï¼š<a href=\\\"https://www.bilibili.com/video/av10590361/\\\">https://www.bilibili.com/video/av10590361/</a> , <a href=\\\"https://www.bilibili.com/video/av9770302/\\\">https://www.bilibili.com/video/av9770302/</a> ã€‚ å¦å¤–æœ‰ä¸ªå¾ˆå¥½çš„pdfå¯ä»¥å¿«é€Ÿäº†è§£æœºå™¨å­¦ä¹ å†…å®¹ï¼š<a href=\\\"https://www.slideshare.net/tw_dsconf/ss-62245351\\\">https://www.slideshare.net/tw_dsconf/ss-62245351</a> </li>\\n<li>Fast.aiè¯¾ç¨‹ï¼Œ<a href=\\\"http://course.fast.ai/\\\">http://course.fast.ai/</a> ï¼Œ ä¸­æ–‡ç‰ˆ<a href=\\\"http://geek.ai100.com.cn/tag/fast-ai\\\">http://geek.ai100.com.cn/tag/fast-ai</a> ï¼Œå·²å®Œæˆï¼Œè¿™ä¸ªæ˜¯æˆ‘ç›®å‰è§‰å¾—æœ€å¥½çš„è¯¾ç¨‹ã€‚</li>\\n<li>Andrew NG <a href=\\\"https://www.coursera.org/learn/machine-learning\\\">https://www.coursera.org/learn/machine-learning</a> ï¼ˆå·²å®Œæˆï¼‰</li>\\n<li>Andrew NG Unsupervised Feature Learning and Deep Learning <a href=\\\"http://deeplearning.stanford.edu/tutorial/\\\">http://deeplearning.stanford.edu/tutorial/</a> ï¼ˆå­¦ä¹ ingï¼‰</li>\\n<li><a href=\\\"http://neuralnetworksanddeeplearning.com/\\\">http://neuralnetworksanddeeplearning.com/</a> ï¼ˆå·²å®Œæˆï¼‰</li>\\n<li>Andrew NG, standfordçš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ä¹‹ä¸€ï¼Œ <a href=\\\"http://cs229.stanford.edu/\\\">http://cs229.stanford.edu/</a></li>\\n<li>Neural Networks for Machine Learning <a href=\\\"https://www.coursera.org/learn/neural-networks\\\">https://www.coursera.org/learn/neural-networks</a> by Geoffrey Hinton, Professor(æ·±åº¦å­¦ä¹ åˆ›å§‹äºº) ï¼ˆå­¦ä¹ ä¸­ï¼‰ï¼Œæœ‰ç‚¹åæ‚”ï¼Œ è¿™ä¸ªè¯¾ç¨‹å¹¶ä¸æ˜¯é€‚åˆåˆå­¦è€…ã€‚å‚è€ƒ<a href=\\\"https://www.quora.com/Is-it-wise-to-learn-deep-learning-from-Hintons-course-on-Coursera\\\">è¿™é‡Œ</a></li>\\n<li>æé£é£è¯¾ç¨‹<a href=\\\"http://cs231n.github.io/\\\">http://cs231n.github.io/</a></li>\\n<li>æ–¯å¦ç¦è‡ªç„¶è¯­è¨€å¤„ç† <a href=\\\"http://web.stanford.edu/class/cs224n/\\\">http://web.stanford.edu/class/cs224n/</a></li>\\n<li>Tensorflow for Deep Learning Research <a href=\\\"http://web.stanford.edu/class/cs20si/\\\">http://web.stanford.edu/class/cs20si/</a></li>\\n<li>ä¼¯å…‹åˆ©äººå·¥æ™ºèƒ½è¯¾ç¨‹ <a href=\\\"http://www-inst.eecs.berkeley.edu/~cs188/archives.html\\\">http://www-inst.eecs.berkeley.edu/~cs188/archives.html</a></li>\\n<li><a href=\\\"http://www.deeplearningbook.org/\\\">http://www.deeplearningbook.org/</a>, by Ian Goodfellow and Yoshua Bengioï¼ˆæ·±åº¦å­¦ä¹ å››å¤§é‡‘åˆšä¹‹ä¸€ï¼‰ and Aaron Courville</li>\\n<li>udacityæ·±åº¦å­¦ä¹ è¯¾ç¨‹tensorflow <a href=\\\"https://classroom.udacity.com/courses/ud730/\\\">https://classroom.udacity.com/courses/ud730/</a> ï¼ˆå·²å®Œæˆï¼‰</li>\\n<li><a href=\\\"https://keras.io\\\">https://keras.io</a></li>\\n<li><a href=\\\"https://scikit-learn.org\\\">https://scikit-learn.org</a></li>\\n<li><a href=\\\"https://www.tensorflow.org\\\">https://www.tensorflow.org</a></li>\\n<li><a href=\\\"http://deeplearning.net/\\\">http://deeplearning.net/</a></li>\\n<li><a href=\\\"https://www.kaggle.com\\\">https://www.kaggle.com</a></li>\\n</ul>\",\"timeToRead\":2,\"excerpt\":\"â€¦\",\"fields\":{\"slug\":\"/ml-content/\"},\"frontmatter\":{\"title\":\"æœºå™¨å­¦ä¹ è®¡åˆ’\",\"date\":\"2017-02-12\",\"category\":\"ML\",\"tags\":[\"AI\",\"ML\",\"machine learning\",\"deep learning\",\"æ·±åº¦å­¦ä¹ \"]}}},{\"node\":{\"html\":\"<h1 id=\\\"ä»€ä¹ˆæ˜¯è´å¡å°”æ›²çº¿\\\"><a href=\\\"#%E4%BB%80%E4%B9%88%E6%98%AF%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ä»€ä¹ˆæ˜¯è´å¡å°”æ›²çº¿</h1>\\n<p>æœ€è¿‘åšä¸€ä¸ªåŠ¨ç”»æ•ˆæœæ—¶éœ€è¦å°†ç‰©ä½“åšæ›²çº¿ç§»åŠ¨ï¼Œ æœ¬æ¥è®°å¾—css3é‡Œçš„åŠ¨ç”»æ˜¯å¯ä»¥æŒ‡å®šbeizer curveçš„ï¼Œ ç»“æœç”¨çš„æ—¶å€™å‘ç°css3çš„beizer curveåªç”¨æ¥åšeasing timing functionã€‚ç®€å•æ¥è¯´å°±æ˜¯æ‹¿æ¥æ§åˆ¶åŠ¨ç”»â€œéçº¿æ€§â€ç§»åŠ¨ï¼Œæ¯”å¦‚è¶Šæ¥è¶Šå¿«ï¼ˆease-inï¼‰ï¼Œ è¶Šæ¥è¶Šæ…¢ï¼ˆease-outï¼‰ï¼Œå…ˆæ…¢åå¿«å†æ…¢ï¼ˆease-in-outï¼‰ç­‰ï¼Œ è®©åŠ¨ç”»æ•ˆæœæ›´â€œçµåŠ¨â€ï¼Œ é¿å…çº¿æ€§ï¼ˆlinearï¼‰çš„æ­»æ¿ã€‚</p>\\n<p>å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªé¡µé¢ï¼Œ æœ‰ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ã€‚</p>\\n<!-- more -->\\n<ul>\\n<li><a href=\\\"http://cubic-bezier.com/\\\">http://cubic-bezier.com/</a></li>\\n<li><a href=\\\"http://easings.net/zh-cn\\\">http://easings.net/zh-cn</a></li>\\n</ul>\\n<p>beizer curveåœ¨css3ä¸­çš„ä½¿ç”¨ï¼Œ å¯ä»¥è‡ªå·±googleä¸€ä¸‹ï¼Œ æˆ–è€…çœ‹ä¸‹ï¼š</p>\\n<ul>\\n<li><a href=\\\"http://www.w3school.com.cn/css3/css3_transition.asp\\\">http://www.w3school.com.cn/css3/css3_transition.asp</a></li>\\n<li><a href=\\\"http://www.ruanyifeng.com/blog/2014/02/css_transition_and_animation.html\\\">http://www.ruanyifeng.com/blog/2014/02/css<em>transition</em>and_animation.html</a></li>\\n</ul>\\n<p>å¼•ç”¨wikiä¸Šçš„ä»‹ç»ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">    åœ¨æ•°å­¦çš„æ•°å€¼åˆ†æé¢†åŸŸä¸­ï¼Œè´å¡å°”æ›²çº¿ï¼ˆè‹±è¯­ï¼šBÃ©zier curveï¼‰æ˜¯è®¡ç®—æœºå›¾å½¢å­¦ä¸­ç›¸å½“é‡è¦çš„å‚æ•°æ›²çº¿ã€‚æ›´é«˜ç»´åº¦çš„å¹¿æ³›åŒ–è´å¡å°”æ›²çº¿å°±ç§°ä½œè´å¡å°”æ›²é¢ï¼Œå…¶ä¸­è´å¡å°”ä¸‰è§’æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®ä¾‹ã€‚\\n    è´å¡å°”æ›²çº¿äº1962å¹´ï¼Œç”±æ³•å›½å·¥ç¨‹å¸ˆçš®åŸƒå°”Â·è´å¡å°”ï¼ˆPierre BÃ©zierï¼‰æ‰€å¹¿æ³›å‘è¡¨ï¼Œä»–è¿ç”¨è´å¡å°”æ›²çº¿æ¥ä¸ºæ±½è½¦çš„ä¸»ä½“è¿›è¡Œè®¾è®¡ã€‚è´å¡å°”æ›²çº¿æœ€åˆç”±Paul de Casteljauäº1959å¹´è¿ç”¨de Casteljauç®—æ³•å¼€å‘ï¼Œä»¥ç¨³å®šæ•°å€¼çš„æ–¹æ³•æ±‚å‡ºè´å¡å°”æ›²çº¿ã€‚</code></pre>\\n      </div>\\n<p>æœ‰æ•°å­¦åŠŸåº•æˆ–è€…æœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒä¸‹é¢å‡ ç¯‡æ–‡ç« ï¼Œ æˆ‘å°±ä¸èµ˜è¿°äº†ï¼ˆæœ€è®¨åŒé‚£ç§ä»€ä¹ˆéƒ½è¦copyè¿‡æ¥ï¼Œå¼„å¾—å¥½åƒè·Ÿæ˜¯è‡ªå·±å†™çš„æ ·ï¼Œ åˆ«äººå·²ç»å†™å¾—å¾ˆæ¸…æ¥šäº†ï¼Œ å¹²å˜›å†é‡å¤åŠ³åŠ¨ä¸€éå‘¢ï¼Œ åˆæ²¡æœ‰è‡ªå·±çš„æ–°çš„è§è§£ï¼Œèµ äººé“¾æ¥ï¼Œ æ‰‹ç•™ä½™é¦™ã€‚ ğŸ˜å“ˆï¼‰ã€‚</p>\\n<ul>\\n<li><a href=\\\"https://en.wikipedia.org/wiki/B%C3%A9zier_curve\\\">https://en.wikipedia.org/wiki/B%C3%A9zier_curve</a></li>\\n<li><a href=\\\"https://zh.wikipedia.org/wiki/%E8%B2%9D%E8%8C%B2%E6%9B%B2%E7%B7%9A\\\">https://zh.wikipedia.org/wiki/%E8%B2%9D%E8%8C%B2%E6%9B%B2%E7%B7%9A</a></li>\\n<li><a href=\\\"http://www.html-js.com/article/1628\\\">http://www.html-js.com/article/1628</a></li>\\n<li><a href=\\\"http://www.cnblogs.com/hnfxs/p/3148483.html\\\">http://www.cnblogs.com/hnfxs/p/3148483.html</a></li>\\n<li></li>\\n</ul>\\n<h1 id=\\\"åœ¨çº¿å·¥å…·\\\"><a href=\\\"#%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>åœ¨çº¿å·¥å…·</h1>\\n<p>ä¸‹é¢æ˜¯å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å·¥å…·ï¼Œ æ–¹ä¾¿å¤§å®¶ã€‚</p>\\n<ul>\\n<li><a href=\\\"http://blogs.sitepointstatic.com/examples/tech/canvas-curves/quadratic-curve.html\\\">http://blogs.sitepointstatic.com/examples/tech/canvas-curves/quadratic-curve.html</a></li>\\n<li><a href=\\\"http://myst729.github.io/bezier-curve/\\\">http://myst729.github.io/bezier-curve/</a></li>\\n<li><a href=\\\"http://xuanfengge.com/easeing/ceaser/\\\">http://xuanfengge.com/easeing/ceaser/</a></li>\\n<li><a href=\\\"http://yisibl.github.io/cubic-bezier/#.17,.67,.83,.67\\\">http://yisibl.github.io/cubic-bezier/#.17,.67,.83,.67</a></li>\\n<li><a href=\\\"http://cubic-bezier.com/#.17,.67,.83,.67\\\">http://cubic-bezier.com/#.17,.67,.83,.67</a></li>\\n</ul>\\n<h1 id=\\\"å®ç°\\\"><a href=\\\"#%E5%AE%9E%E7%8E%B0\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å®ç°</h1>\\n<p>å‰é¢èµ„æ–™éƒ½æ˜¯æŠŠbezier curveæ‹¿æ¥å½“timing functionçš„ï¼Œ è€Œæˆ‘çš„éœ€æ±‚æ˜¯è¦è®©ç‰©ä½“ï¼ˆæŸä¸ªdomèŠ‚ç‚¹ï¼‰æ²¿ç€æŸæ¡beizer curveç§»åŠ¨ï¼Œäºæ˜¯ç»§ç»­googleï¼Œ æ‰¾åˆ°äº†å‡ ä¸ªã€‚</p>\\n<ul>\\n<li>Androidå®ç°: <a href=\\\"https://github.com/Yasic/QQBubbleView\\\">https://github.com/Yasic/QQBubbleView</a></li>\\n</ul>\\n<p>Androidçš„æˆ‘ç”¨ä¸åˆ°ï¼Œ æ”¾è¿™é‡Œä¸»è¦æ˜¯é‡Œé¢çš„gifå›¾å¾ˆç›´è§‚ï¼Œå“ˆå“ˆã€‚</p>\\n<ul>\\n<li>CSSå®ç°ï¼š<a href=\\\"http://jinlong.github.io/2016/01/14/moving-along-a-curved-path-in-css-with-layered-animation/%EF%BC%8C\\\">http://jinlong.github.io/2016/01/14/moving-along-a-curved-path-in-css-with-layered-animation/ï¼Œ</a> åŸæ–‡ï¼š<a href=\\\"http://tobiasahlin.com/blog/curved-path-animations-in-css/\\\">http://tobiasahlin.com/blog/curved-path-animations-in-css/</a></li>\\n</ul>\\n<p>CSSçš„å®ç°çœŸæ˜¯ç›¸å½“trickyï¼Œ æˆ‘è§£é‡Šä¸€ä¸‹ã€‚CSSé‡Œé¢çš„animation translateæ˜¯ç›´æ¥æŒ‰ç…§ç›´çº¿ç§»åŠ¨åˆ°ç›®çš„åœ°çš„ï¼Œ è¿™æ˜¯å› ä¸ºæ²¿Xè½´å’ŒYè½´éƒ½æ˜¯åŒ€é€Ÿè¿åŠ¨ï¼ˆlinearï¼‰ï¼Œæ‰€ä»¥åˆæˆä¹‹åçš„é€Ÿåº¦å¿…ç„¶æ˜¯æ–œè§’45Â°ç§»åŠ¨è¿‡å»çš„ã€‚æˆ‘ä»¬å¯ä»¥æŠŠXè½´çœ‹æˆæ—¶é—´è½´ï¼Œ è¿™æ—¶å¦‚æœYè½´çš„ç§»åŠ¨å‡½æ•°æ˜¯æŸä¸ªbeizer curveï¼Œé‚£åˆæˆä¹‹åçš„ç§»åŠ¨æ›²çº¿å°±æ˜¯beizer curveäº†ã€‚å…·ä½“å®ç°çš„æ—¶å€™è¿˜ç”¨åˆ°äº†:afterä¼ªå…ƒç´ äº†ã€‚</p>\\n<p>å¤æ‚ä¸€ç‚¹çš„æˆ‘è§‰å¾—è¿˜æ˜¯éœ€è¦ç”¨jså»æ§åˆ¶ï¼Œ äºæ˜¯è‡ªç„¶æƒ³åˆ°äº†ç”¨jsä»£ç å»æŒ‰ç…§beizer curveå…¬å¼å®ç°ã€‚</p>\\n<ul>\\n<li>JSå®ç°ï¼š <a href=\\\"http://blog.csdn.net/cuixiping/article/details/6872095\\\">http://blog.csdn.net/cuixiping/article/details/6872095</a></li>\\n</ul>\\n<p>è¿™ä¸ªç”¨çš„å…¬å¼ä¸ç›´è§‚ï¼Œåº”è¯¥æ˜¯è¿›è¡Œäº†å˜æ¢ä¹‹åçš„ï¼Œ æˆ‘ç›´æ¥ç…§ç€å…¬å¼å†™äº†ä¸€ä¸ªã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"gatsby-highlight-code-line\\\"><span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">PointOnCubicBezier2</span><span class=\\\"token punctuation\\\">(</span>cp<span class=\\\"token punctuation\\\">,</span> t<span class=\\\"token punctuation\\\">)</span>  <span class=\\\"token punctuation\\\">{</span>\\n</span><span class=\\\"gatsby-highlight-code-line\\\">   <span class=\\\"token comment\\\">// B(t) = P0 * (1-t)^3 + 3 * P1 * t * (1-t)^2 + 3 * P2 * t^2 * (1-t) + P3 * t^3</span>\\n</span>        <span class=\\\"token keyword\\\">const</span> one_t <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1.0</span> <span class=\\\"token operator\\\">-</span> t<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P0</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P1</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P2</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P3</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> x <span class=\\\"token operator\\\">=</span>  <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">P0</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P1</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> t <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P2</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">*</span> one_t <span class=\\\"token operator\\\">+</span> <span class=\\\"token constant\\\">P3</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> y <span class=\\\"token operator\\\">=</span>  <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">P0</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P1</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> t <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P2</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">*</span> one_t <span class=\\\"token operator\\\">+</span> <span class=\\\"token constant\\\">P3</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> pointF <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Point2D</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> pointF<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¯¹æ¯”äº†ä¸€ä¸‹ä¸¤ä¸ªå‡½æ•°çš„è¾“å‡ºå€¼ï¼Œ å®Œå…¨æ˜¯ä¸€æ ·çš„ï¼Œ åº”è¯¥å°±æ˜¯æ•°å­¦å˜æ¢è€Œå·²ï¼Œ æˆ‘æ‡’å¾—å»åšæ¨å€’äº†ã€‚</p>\\n<p>åæ¥æ‰¾åˆ°ä¸€ä¸ªä¸‰é˜¶beizer curveçš„å®ç°ï¼Œçœ‹è¿™é‡Œ\\n<a href=\\\"https://github.com/gre/bezier-easing%EF%BC%8C\\\">https://github.com/gre/bezier-easingï¼Œ</a> è¿™ä¸ªå®ç°å¯èƒ½æœ‰ç‚¹NBï¼Œä»¥è‡³äº<a href=\\\"https://facebook.github.io/react-native/\\\">React Native</a>ã€<a href=\\\"http://velocityjs.org/\\\">Velocity</a>ç­‰é¡¹ç›®éƒ½ä½¿ç”¨äº†ï¼Œå±Œå±Œçš„ã€‚</p>\\n<p>ç”¨<a href=\\\"https://github.com/bestiejs/benchmark.js\\\">benchmark</a>è·‘ä¸€ä¸‹åˆ†ï¼š<a href=\\\"https://jsperf.com/beizer-curve5\\\">çœ‹è¿™é‡Œ</a>ï¼Œ chromeä¸‹æˆ‘å†™çš„æ–¹æ³•å±…ç„¶æ…¢äº†94%ï¼çœ‹æ ·å­ä»£ç å¯è¯»æ€§æ˜¯è¦ä»˜å‡ºä»£ä»·çš„å“ˆã€‚æˆ‘è¿˜æ˜¯è€è€å®å®ç”¨<a href=\\\"https://github.com/gre/bezier-easing%E5%90%A7%E3%80%82\\\">https://github.com/gre/bezier-easingå§ã€‚</a></p>\\n<p>åˆšåˆšåˆæœåˆ°ä¸€ç¯‡æ–‡ç« ï¼Œ è®²è§£åœ°æ›´ç»†è‡´æ·±å…¥ï¼Œ å®³å¾—æˆ‘ä¸æƒ³ç»§ç»­å†™äº†ã€‚ ç›´æ¥çœ‹è¿™é‡Œå§ã€‚<a href=\\\"http://www.jianshu.com/p/55c721887568\\\">http://www.jianshu.com/p/55c721887568</a></p>\\n<h1 id=\\\"å¦‚ä½•å°†å¤šä¸ªç‚¹ç”¨è´å¡å°”æ›²çº¿è¿èµ·æ¥\\\"><a href=\\\"#%E5%A6%82%E4%BD%95%E5%B0%86%E5%A4%9A%E4%B8%AA%E7%82%B9%E7%94%A8%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF%E8%BF%9E%E8%B5%B7%E6%9D%A5\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å¦‚ä½•å°†å¤šä¸ªç‚¹ç”¨è´å¡å°”æ›²çº¿è¿èµ·æ¥</h1>\\n<ul>\\n<li><a href=\\\"http://www.zheng-hang.com/?id=43\\\">http://www.zheng-hang.com/?id=43</a></li>\\n<li><a href=\\\"http://www.cnblogs.com/hnfxs/p/3148743.html\\\">http://www.cnblogs.com/hnfxs/p/3148743.html</a></li>\\n</ul>\",\"timeToRead\":4,\"excerpt\":\"ä»€ä¹ˆæ˜¯è´å¡å°”æ›²çº¿ æœ€è¿‘åšä¸€ä¸ªåŠ¨ç”»æ•ˆæœæ—¶éœ€è¦å°†ç‰©ä½“åšæ›²çº¿ç§»åŠ¨ï¼Œ æœ¬æ¥è®°å¾—css3é‡Œçš„åŠ¨ç”»æ˜¯å¯ä»¥æŒ‡å®šbeizer curveçš„ï¼Œ ç»“æœç”¨çš„æ—¶å€™å‘ç°css3çš„beizer curveåªç”¨æ¥åšeasing timing functionâ€¦\",\"fields\":{\"slug\":\"/bezier-curve/\"},\"frontmatter\":{\"title\":\"bezier-curve\",\"date\":\"2016-11-29\",\"category\":\"FE\",\"tags\":[\"js\",\"css\",\"animation\",\"beizer curve\"]}}},{\"node\":{\"html\":\"<p>ç”¨äº†ä¸€å¹´å¤šçš„<a href=\\\"https://facebook.github.io/react/\\\">React</a>ï¼ŒçœŸæ˜¯çˆ½çš„ä¸è¦ä¸è¦çš„ï¼Œ è°ç”¨è°çŸ¥é“ï¼Œ ä¸€èˆ¬äººæˆ‘ä¸å‘Šè¯‰ä»–ï¼</p>\\n<p>æœ€è¿‘ç”¨çš„è¿‡ç¨‹ä¸­å‘ç°consoleé‡Œé¢æ€»æ˜¯å‡ºç°è¿™æ ·çš„è­¦å‘Š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">react.js:20478 Warning: setState(...): Can only update a mounted or mounting component. This usually means you called setState() on an unmounted component. This is a no-op. Please check the code for the Small component.</code></pre>\\n      </div>\\n<p>è™½ä¸å½±å“ä½¿ç”¨ï¼Œ ä½†æ˜¯å¯¹äºä¸€ä¸ªæœ‰ä»£ç æ´ç™–çš„æœ‰è¿½æ±‚çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œ æ€ä¹ˆå—å¾—äº†å‘¢ï¼</p>\\n<p>reactçš„erroræˆ–è€…warningä¿¡æ¯è¿˜æ˜¯å†™å¾—æ¯”è¾ƒå¥½çš„ï¼Œ ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåŸå› æ˜¯æˆ‘ä»¬åœ¨ä¸€ä¸ªunmountedçš„componentä¸Šè°ƒç”¨setStateæ–¹æ³•ã€‚åˆ†æä¸šåŠ¡ä»£ç ï¼Œ å‘ç°æ˜¯æŸä¸ªå¼¹çª—componentéœ€è¦ä»serveråŠ è½½æ•°æ®ï¼Œ æœ‰æ—¶å€™ç½‘ç»œæ…¢ï¼Œ è¿˜æ²¡æœ‰åŠ è½½å‡ºæ¥ç”¨æˆ·å°±æŠŠå¼¹çª—å…³äº†ï¼Œ æ‰€ä»¥å¯¹åº”çš„componentå˜æˆäº†unmountedï¼Œ ç­‰åˆ°fetchè¯·æ±‚æˆåŠŸä¹‹åï¼Œ å†è°ƒç”¨setStateå°±warningäº†ã€‚</p>\\n<p>ä¸ºäº†æ–¹ä¾¿åˆ†æé—®é¢˜ï¼Œ æˆ‘æŠŠé—®é¢˜ç®€åŒ–äº†ï¼Œ åŒæ—¶ä¸ºäº†ç”¨æˆ·ç›´æ¥èƒ½åœ¨æµè§ˆå™¨æ‰“å¼€çœ‹åˆ°æ•ˆæœï¼Œ è€Œä¸ç”¨nodejsã€npmã€babelã€webpackã€reactç­‰ä¸€å †ä¸œè¥¿installåŠå¤©ï¼Œ æˆ‘ç›´æ¥å¼•ç”¨äº†react cdnä¸Šçš„æ–‡ä»¶ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token doctype\\\">&lt;!DOCTYPE html></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>meta</span> <span class=\\\"token attr-name\\\">charset</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>UTF-8<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>title</span><span class=\\\"token punctuation\\\">></span></span>Hello World<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>title</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react@latest/dist/react.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react-dom@latest/dist/react-dom.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/babel-standalone@6.15.0/babel.min.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text/babel<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\">\\n\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Big</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function-variable function\\\">closeSmall</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'closeSmall'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Big Component <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h2 onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>closeSmall<span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">></span>close small <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h2<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>small <span class=\\\"token operator\\\">?</span> <span class=\\\"token operator\\\">&lt;</span>Small <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Small</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'init data'</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">componentDidMount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'componentDidMount'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token function\\\">setTimeout</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fetch data from server succeed...'</span><span class=\\\"token punctuation\\\">)</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`this._isMounted: </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">`</span></span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'data from server'</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Small Component <span class=\\\"token operator\\\">...</span>  <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n      ReactDOM<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>Big <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n        document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    </span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>ä»£ç é‡Œé¢ç”¨setTimeoutæ¨¡æ‹Ÿäº†ä»serverè·å–æ•°æ®ï¼Œ å¤§å®¶å¦‚æœåœ¨5så†…ç‚¹å‡»close smallï¼Œ å°±å¯ä»¥é‡ç°è¿™ä¸ªé—®é¢˜ã€‚</p>\\n<p>é—®é¢˜çš„è§£å†³æ–¹æ³•å¾ˆè‡ªç„¶åœ°æƒ³åˆ°ï¼Œå¦‚æœå¯ä»¥åœ¨setStateä¹‹å‰æ£€æŸ¥ä¸€ä¸‹this componentæ˜¯å¦è¿˜æ˜¯mountedçŠ¶æ€å°±å¯ä»¥äº†ã€‚æŸ¥reactçš„æ–‡æ¡£ï¼Œå‘ç°åŸæ¥ä¹‹å‰ç¡®å®æ˜¯æœ‰isMounted()è¿™ä¸ªæ–¹æ³•çš„ï¼Œ ä¸è¿‡å·²ç»ä¸æ¨èä½¿ç”¨äº†ï¼Œ å› ä¸º<a href=\\\"https://facebook.github.io/react/blog/2015/12/16/ismounted-antipattern.html\\\">isMounted is an Antipattern</a>ã€‚</p>\\n<p>ç¬¬ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯è‡ªå·±æ¨¡æ‹Ÿå®ç°isMountedè¿™ä¸ªæ–¹æ³•ï¼Œ è™½ç„¶å·²ç»è¢«è´´ä¸ŠAntipatternçš„æ ‡ç­¾ï¼Œ ä½†æ˜¯æœ‰äº›æ—¶å€™ç”¨è¿™ç§æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token doctype\\\">&lt;!DOCTYPE html></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>meta</span> <span class=\\\"token attr-name\\\">charset</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>UTF-8<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>title</span><span class=\\\"token punctuation\\\">></span></span>Hello World<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>title</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react@latest/dist/react.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react-dom@latest/dist/react-dom.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/babel-standalone@6.15.0/babel.min.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text/babel<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\">\\n\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Big</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function-variable function\\\">closeSmall</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'closeSmall'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Big Component <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h2 onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>closeSmall<span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">></span>close small <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h2<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>small <span class=\\\"token operator\\\">?</span> <span class=\\\"token operator\\\">&lt;</span>Small <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Small</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'init data'</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">componentDidMount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'componentDidMount'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token function\\\">setTimeout</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fetch data from server succeed...'</span><span class=\\\"token punctuation\\\">)</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`this._isMounted: </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">`</span></span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'data from server'</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">componentWillUnmount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Small Component <span class=\\\"token operator\\\">...</span>  <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n      ReactDOM<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>Big <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n        document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    </span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>å¯¹äºcallbackç°åœ¨å·²ç»æœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œ ä¼Ÿå¤§çš„<a href=\\\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\\\">Promise</a>ï¼å¦‚æœè¿™ä¸ªpromiseèƒ½åœ¨componentWillUnmount()çš„æ—¶å€™cancelæ‰å°±å®Œç¾äº†ã€‚å¯æƒœgoogleä¹‹åå‘ç°å®˜æ–¹Promiseå®ç°ç›®å‰å¹¶ä¸æ”¯æŒcancelï¼<a href=\\\"http://stackoverflow.com/questions/29478751/how-to-cancel-an-emcascript6-vanilla-javascript-promise-chain\\\">çœ‹è¿™é‡Œ</a>ï¼Œ è¿˜æœ‰<a href=\\\"http://stackoverflow.com/questions/30233302/promise-is-it-possible-to-force-cancel-a-promise\\\">è¿™é‡Œ</a>ï¼Œæ‰€ä»¥é™¤éä½ ä½¿ç”¨ç¬¬ä¸‰æ–¹Promiseåº“ï¼Œ æ¯”å¦‚æ®è¯´æ€§èƒ½æ¯”åŸç”Ÿè¿˜å¥½çš„<a href=\\\"http://bluebirdjs.com/docs/api/cancellation.html\\\">Bluebird</a>ã€‚</p>\\n<p>å½“ç„¶æœ‰äº›æ—¶å€™æ²¡å¿…è¦æè¿™ä¹ˆå¤æ‚ï¼Œ facebookçš„<a href=\\\"https://facebook.github.io/react/blog/2015/12/16/ismounted-antipattern.html\\\">æ–‡æ¡£</a>ç»™äº†ä¸€ä¸ªç®€æ˜“çš„cancelableçš„Promiseã€‚æœ€å¥½ä»£ç å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token doctype\\\">&lt;!DOCTYPE html></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>meta</span> <span class=\\\"token attr-name\\\">charset</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>UTF-8<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>title</span><span class=\\\"token punctuation\\\">></span></span>Hello World<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>title</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react@latest/dist/react.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react-dom@latest/dist/react-dom.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/babel-standalone@6.15.0/babel.min.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text/babel<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\">\\n\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Big</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n      small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function-variable function\\\">closeSmall</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'closeSmall'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Component <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token operator\\\">&lt;</span>h2 onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>closeSmall<span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">></span>close small <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h2<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>small <span class=\\\"token operator\\\">?</span> <span class=\\\"token operator\\\">&lt;</span>Small <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Small</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n      data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'init data'</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">componentDidMount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'componentDidMount'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>cancelablePromise <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">makeCancelable</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Promise</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>resolve<span class=\\\"token punctuation\\\">,</span> reject<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token function\\\">setTimeout</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fetch data from server succeed...'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'data from server'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>cancelablePromise\\n      <span class=\\\"token punctuation\\\">.</span>promise\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span>data <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'resolved: '</span><span class=\\\"token punctuation\\\">,</span> data<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> data <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span>reason <span class=\\\"token operator\\\">=></span> console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>reason<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">' isCanceled'</span><span class=\\\"token punctuation\\\">,</span> reason<span class=\\\"token punctuation\\\">.</span>isCanceled<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">componentWillUnmount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>cancelablePromise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">cancel</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">// Cancel the promise</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Small Component <span class=\\\"token operator\\\">...</span>  <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n      data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">const</span> <span class=\\\"token function-variable function\\\">makeCancelable</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>promise<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">let</span> hasCanceled_ <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">const</span> wrappedPromise <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Promise</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>resolve<span class=\\\"token punctuation\\\">,</span> reject<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>val<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span>\\n      hasCanceled_ <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">reject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> isCanceled<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span>val<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span>\\n      hasCanceled_ <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">reject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> isCanceled<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token function\\\">reject</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">{</span>\\n    promise<span class=\\\"token punctuation\\\">:</span> wrappedPromise<span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token function\\\">cancel</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      hasCanceled_ <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n      ReactDOM<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>Big <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n        document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    </span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>well, itâ€™s ok now!</p>\",\"timeToRead\":4,\"excerpt\":\"ç”¨äº†ä¸€å¹´å¤šçš„ React ï¼ŒçœŸæ˜¯çˆ½çš„ä¸è¦ä¸è¦çš„ï¼Œ è°ç”¨è°çŸ¥é“ï¼Œ ä¸€èˆ¬äººæˆ‘ä¸å‘Šè¯‰ä»–ï¼ æœ€è¿‘ç”¨çš„è¿‡ç¨‹ä¸­å‘ç°consoleé‡Œé¢æ€»æ˜¯å‡ºç°è¿™æ ·çš„è­¦å‘Š è™½ä¸å½±å“ä½¿ç”¨ï¼Œ ä½†æ˜¯å¯¹äºä¸€ä¸ªæœ‰ä»£ç æ´ç™–çš„æœ‰è¿½æ±‚çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œ æ€ä¹ˆå—å¾—äº†å‘¢ï¼ reactçš„erroræˆ–è€…warningâ€¦\",\"fields\":{\"slug\":\"/react-ismounted-is-an-antipattern/\"},\"frontmatter\":{\"title\":\"reactç³»åˆ—ä¹‹isMounted is an Antipattern\",\"date\":\"2016-11-19\",\"category\":\"FE\",\"tags\":[\"react\"]}}},{\"node\":{\"html\":\"<p><a href=\\\"http://blog.coderzh.com/2015/09/13/use-webhook-automated-deploy-hugo/?hmsr=toutiao.io&#x26;utm_medium=toutiao.io&#x26;utm_source=toutiao.io\\\">http://blog.coderzh.com/2015/09/13/use-webhook-automated-deploy-hugo/?hmsr=toutiao.io&#x26;utm<em>medium=toutiao.io&#x26;utm</em>source=toutiao.io</a></p>\\n<p>â€¦</p>\",\"timeToRead\":1,\"excerpt\":\"http://blog.coderzh.com/2015/09/13/use-webhook-automated-deploy-hugo/?hmsr=toutiao.io&utm medium=toutiao.io&utm source=toutiao.io â€¦\",\"fields\":{\"slug\":\"/auto-deploy-githubPages-by-webhook-md/\"},\"frontmatter\":{\"title\":\"åˆ©ç”¨webhookå®ç°github pagesçš„è‡ªåŠ¨éƒ¨ç½²\",\"date\":\"2015-09-16\",\"category\":\"default\",\"tags\":[\"github\",\"webhook\",\"ssh\"]}}},{\"node\":{\"html\":\"<p>javascript es6 arrow function.</p>\\n<!-- more -->\\n<p>å¼€å§‹å­¦ä¹ ES6.\\n<a href=\\\"https://hacks.mozilla.org/category/es6-in-depth/\\\">https://hacks.mozilla.org/category/es6-in-depth/</a></p>\",\"timeToRead\":1,\"excerpt\":\"javascript es6 arrow function. å¼€å§‹å­¦ä¹ ES6.\\n https://hacks.mozilla.org/category/es6-in-depth/\",\"fields\":{\"slug\":\"/js-arrow-functions-md/\"},\"frontmatter\":{\"title\":\"javascriptç®­å¤´å‡½æ•°\",\"date\":\"2015-09-07\",\"category\":\"JS\",\"tags\":[\"js\",\"javascript\",\"es6\"]}}},{\"node\":{\"html\":\"<p>å¾®ä¿¡å…¬å…±å·ç°åœ¨å¾ˆç«ï¼Œä¸€äº›ç®€å•çš„åº”ç”¨ï¼Œåšä¸€ä¸ªå…¬å…±å·æ¯”å¼€å‘ä¸€æ¬¾appæˆæœ¬è¦å°å¾ˆå¤šï¼Œè€Œä¸”åˆ©ç”¨æœ‹å‹åœˆçš„è½¬å‘ï¼Œç›¸æ¯”appå»app storeé‡Œä¸Šæ¶ç­‰ç€ç”¨æˆ·ä¸‹è½½ï¼Œè¦å®¹æ˜“å¾ˆå¤šã€‚</p>\\n<p>ä½†æ˜¯å¾®ä¿¡å…¬å…±å·çš„è°ƒè¯•æœ‰ç‚¹ä¸æ–¹ä¾¿ï¼Œå¿…é¡»åœ¨å¾®ä¿¡<a href=\\\"https://mp.weixin.qq.com/\\\">ç®¡ç†åå°</a>é…ç½®ä¸€ä¸ªå¾®ä¿¡èƒ½è®¿é—®åˆ°ï¼ˆå…¬ç½‘ï¼‰çš„urlï¼Œç„¶ååœ¨å…¬å…±å·é‡Œè¾“å…¥å†…å®¹ï¼Œå¾®ä¿¡ä»¥xmlæ ¼å¼è½¬å‘ç»™è¿™ä¸ªurlï¼Œurlå›å¤ä¹‹åå¾®ä¿¡å†å°†responseå›å¤ç»™ä½¿ç”¨å…¬å…±å·çš„å¾®ä¿¡ç”¨æˆ·ã€‚å½“ç„¶å¾®ä¿¡ä¹Ÿæä¾›äº†<a href=\\\"http://mp.weixin.qq.com/debug\\\">è°ƒè¯•å·¥å…·</a>ï¼Œ å¯ä»¥ç›´æ¥æ„é€ æ•°æ®ï¼Œæ–¹ä¾¿è°ƒè¯•å„ä¸ªæ¥å£ã€‚ ä½†æ˜¯ä¾ç„¶éœ€è¦ä¸€ä¸ªå…¬ç½‘çš„urlä½œä¸ºæ¥å£ã€‚äºæ˜¯æœ€åŸå§‹çš„å¼€å‘æ–¹å¼å°±æ˜¯ï¼Œä¿®æ”¹ä»£ç ï¼Œä¸Šä¼ åˆ°serverï¼Œï¼ˆå¦‚æœæ˜¯æœ‰äº›é™æ€è¯­è¨€è¿˜éœ€è¦é‡å¯æœåŠ¡å™¨ï¼‰ï¼Œç„¶åçœ‹æ˜¯å¦æ­£å¸¸workï¼Œå¦‚æœä¸è¡Œçš„è¯ï¼Œåœ¨å¯èƒ½é”™è¯¯çš„åœ°æ–¹æ‰“å‡ºlogï¼Œç„¶ååˆæ˜¯ä¿®æ”¹ä»£ç ï¼Œä¸Šä¼ serverï¼Œé‡å¯ã€‚ã€‚ã€‚ã€‚ã€‚å°±è¿™æ ·ï¼Œæ¯æ¬¡æ”¹ä¸€ç‚¹ç‚¹ï¼Œä½ éƒ½å¯ä»¥æ³¡æ¯å’–å•¡äº†ï¼Œè€æ¿å°±ä¼šè§‰å¾—ä½ å¾ˆé—²ã€‚å‚çœ‹<a href=\\\"http://www.oschina.net/news/15579/reasons-why-people-who-work-with-computers-seem-to\\\">ä¸ºä»€ä¹ˆæè®¡ç®—æœºå·¥ä½œçš„äººæ€»æ˜¯çœ‹ä¸Šå»å¾ˆæ¸…é—²</a>ã€‚</p>\\n<!-- more -->\\n<p>æœ‰æ²¡æœ‰åŠæ³•å¯ä»¥ç›´æ¥åœ¨æœ¬åœ°è°ƒè¯•å‘¢ï¼Œç®€å•è¯´ï¼Œå°±æ˜¯å¾®ä¿¡æŠŠæ•°æ®ä¼ åˆ°æˆ‘æœ¬åœ°çš„ç”µè„‘ä¸Šï¼Œæˆ‘æ¯æ¬¡æ”¹å®Œä»£ç ï¼Œä¸ç”¨é‡æ–°ä¸Šä¼ serverï¼Œç›´æ¥åœ¨æœ¬åœ°åŠ logç­‰ã€‚ç»è¿‡ç ”ç©¶ï¼Œæ‰¾åˆ°å‡ ä¸ªæ–¹æ³•ï¼Œè®°å½•ä¸‹æ¥ï¼Œä¸å¤§å®¶åˆ†äº«ï¼Œç»å¯¹èƒ½èŠ‚çº¦å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šæ—¶é—´ï¼Œç„¶åå°±å¯ä»¥å»é™ªå¦¹çº¸äº†ï¼Œ å¦‚æœä½ æœ‰çš„è¯ï¼Œæ²¡æœ‰çš„è¯<a href=\\\"http://www.zhihu.com/question/20385321\\\">here</a>ã€‚</p>\\n<p>ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä½ æœ¬åœ°ç”µè„‘æœ‰å…¬ç½‘ipã€‚æ¯”å¦‚å®¶é‡Œå®½å¸¦ï¼Œæ²¡ç”¨è·¯ç”±ï¼Œç›´æ¥æŠŠç½‘çº¿æ’ä¸Šï¼Œåº”è¯¥å°±æ˜¯å…¬ç½‘IPï¼Œå§ã€‚ å¦‚æœå®¶é‡Œæœ‰å¤šäººä½¿ç”¨ï¼Œä½ å¯ä»¥å†è·¯ç”±å™¨é‡Œé…ç½®NATåœ°å€è½¬æ¢ã€‚è‡ªè¡Œ<a href=\\\"https://www.google.com.hk/webhp?sourceid=chrome-instant&#x26;ion=1&#x26;espv=2&#x26;ie=UTF-8#q=NAT%20%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2\\\">Google</a>å§ã€‚</p>\\n<p>ç¬¬äºŒç§ï¼Œä¹Ÿæ˜¯æˆ‘æœåˆ°çš„æœ€å¤šçš„ï¼Œç”¨ngrokè¿™ä¸ªç¥å™¨ï¼ç½‘ä¸Šä¸€å †èµ„æ–™ï¼Œæ¯”å¦‚<a href=\\\"http://www.mbnow.tk/2014/12/05/ngrok/\\\">è¿™ä¸ª</a>ï¼Œæˆ‘Googleåˆ°çš„æœ€å¤šçš„ä¹Ÿæ˜¯è¿™ä¸ªï¼Œè€Œä¸”çœ‹ä¸Šå»ä¹Ÿåº”è¯¥å¾ˆç®€å•ã€‚ <a href=\\\"http://www.oray.com/\\\">èŠ±ç”Ÿå£³</a>æˆ‘10å¹´å‰ç”¨è¿‡ï¼ˆxï¼Œä¸å°å¿ƒæš´éœ²å¹´é¾„äº†ï¼‰ï¼Œåº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚ç½‘ä¸Šè¯´ï¼Œç¼ºç‚¹æ˜¯</p>\\n<blockquote>\\n<p>ä¸è¿‡ ngrok é€Ÿåº¦è¾ƒæ…¢ï¼Œå¾®ä¿¡æœåŠ¡å™¨å¯¹å®æ—¶æ€§è¦æ±‚è¾ƒé«˜ï¼Œæ¯æ¬¡é€šä¿¡è¶…è¿‡ 5 ç§’ä¾¿è¶…æ—¶ï¼Œæ‰€ä»¥æ­¤æ³•ä¹Ÿä¸å»ºè®®ä½¿ç”¨ã€‚</p>\\n</blockquote>\\n<p>æˆ‘è§‰å¾—ç”¨èŠ±ç”Ÿå£³çš„è¯å¯èƒ½å¥½ç‚¹ï¼Œå› ä¸ºæ˜¯å›½å†…çš„ï¼ˆæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å»è¯•è¯•å“ˆï¼‰ã€‚æ²¡æœ‰ç”¨ngrokè¯•ä¸€ä¸‹ï¼Œå› ä¸ºâ€œæ— æ³•æ˜¾ç¤ºæ­¤ç½‘é¡µâ€ï¼ç½‘ä¸Šå°±æ˜¯â€œéª—å­â€å¤šï¼Œæ˜æ˜æ²¡æœ‰çš„ç½‘ç«™ï¼Œå¤§å®¶éƒ½æç»˜çš„ç»˜å£°ç»˜è‰²ã€‚</p>\\n<p>ç¬¬ä¸‰ç§ï¼Œç”¨sshå»ºç«‹åå‘é€šé“ã€‚å¯¹äº†ï¼Œä½¿ç”¨æ­¤ç§æ–¹æ³•ï¼Œä½ è¿˜æ˜¯éœ€è¦ä¸€ä¸ªå…¬ç½‘IPçš„ã€‚ ä½œä¸ºä¸€åä¸“ä¸šå·¥ç¨‹å¸ˆï¼Œæ‹¥æœ‰å…¬ç½‘ ip åœ°å€çš„ VPS æœåŠ¡å™¨åŸºæœ¬æˆäº†æ ‡é…ï¼Œ<a href=\\\"http://www.qcloud.com/redirect.php?redirect=1002&#x26;cps_key=0a3641075e434bf76a016a44d2918e4a\\\">è…¾è®¯äº‘VPS</a> æœ€ä¾¿å®œçš„ä¸€æ¬¾æ¯å¹´ä¹Ÿå°±å‡ ç™¾å—é’±ï¼Œå¹³æ—¶æŒ‚æŒ‚è‡ªå·±å–œæ¬¢çš„æœåŠ¡ï¼Œåšä¸ªç«™é•¿ï¼Œè·‘è·‘è‡ªå·±çš„å¼€æºé¡¹ç›®ç”šçˆ½ã€‚</p>\\n<ol>\\n<li>ç”³è¯·<a href=\\\"http://www.qcloud.com/redirect.php?redirect=1001&#x26;cps_key=0a3641075e434bf76a016a44d2918e4a\\\">è…¾è®¯äº‘</a></li>\\n<li>æœ¬åœ°å®‰è£…sshï¼Œå¦‚æœæ˜¯linuxæˆ–macï¼Œéƒ½æ˜¯è‡ªå¸¦çš„ã€‚å¦‚æœæ˜¯windowsçš„è¯ï¼Œå¯ä»¥å®‰è£…<a href=\\\"https://www.cygwin.com/\\\">Cygwin</a>ï¼Œå¦‚æœä½ å«Œå¼ƒå®ƒå¤ªé‡äº†ï¼Œå®‰è£…äº†<a href=\\\"https://git-scm.com/download/gui/win\\\">Git</a>ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å¦‚æœä½ ä¹Ÿä¸æƒ³è£…æˆ–è€…ä¸ä¼šè£…Gitï¼Œé¢ï¼Œ(âŠ™oâŠ™)â€¦ï¼Œå¥½å§ï¼Œé‚£ä½ è¿˜æ˜¯ä¸è¦å†™ç¨‹åºäº†ã€‚</li>\\n<li>\\n<p>å»ºç«‹sshåå‘é€šé“ã€‚\\nè¿™ä¸€æ­¥é‡Œæœ‰å¾ˆå¤šå‘ï¼Œæˆ‘èŠ±äº†å·®ä¸å¤šä¸€å¤©æ‰å®Œå…¨æå®šã€‚ä½ ä»¬å¯ä»¥å…ˆå‚è€ƒè¿™å‡ ç¯‡æ–‡ç« ï¼Œäº†è§£ä¸‹åŸç†å•¥çš„ã€‚</p>\\n<ul>\\n<li><a href=\\\"http://blog.zjutoe.net/?p=95\\\">http://blog.zjutoe.net/?p=95</a></li>\\n<li><a href=\\\"http://my.oschina.net/abcfy2/blog/177094\\\">http://my.oschina.net/abcfy2/blog/177094</a></li>\\n<li><a href=\\\"http://www.zzbaike.com/wiki/PuTTY/Putty%E5%BB%BA%E7%AB%8B%E9%9A%A7%E9%81%93%E7%9A%84%E6%96%B9%E6%B3%95\\\">http://www.zzbaike.com/wiki/PuTTY/Putty%E5%BB%BA%E7%AB%8B%E9%9A%A7%E9%81%93%E7%9A%84%E6%96%B9%E6%B3%95</a></li>\\n<li><a href=\\\"http://www.freeoa.net/osuport/netmanage/linux-ssh-tunneling-proxy_1892.html\\\">http://www.freeoa.net/osuport/netmanage/linux-ssh-tunneling-proxy_1892.html</a></li>\\n<li><a href=\\\"https://qdan.me/list/VOSXmsI4tv7fIciF\\\">https://qdan.me/list/VOSXmsI4tv7fIciF</a></li>\\n</ul>\\n</li>\\n</ol>\\n<p>å¥½å§ï¼Œæ¥çœ‹æˆ‘çš„å…·ä½“ä¸€æ­¥ä¸€æ­¥åšæ³•ã€‚</p>\\n<ol>\\n<li>\\n<p>ssh -R 9999:localhost:9000 ubuntu@myserver<em>ip</em>addressï¼Œè¾“å…¥å¯†ç </p>\\n</li>\\n<li>\\n<p>serverä¸ŠæŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦ç›‘å¬äº†9999ç«¯å£ï¼Œnetstat -anltp | grep 9999</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">ubuntu@VM-39-45-ubuntu:~$ <span class=\\\"token function\\\">netstat</span> -anltp <span class=\\\"token operator\\\">|</span> <span class=\\\"token function\\\">grep</span> 9999\\n<span class=\\\"token punctuation\\\">(</span>Not all processes could be identified, non-owned process info\\nwill not be shown, you would have to be root to see it all.<span class=\\\"token punctuation\\\">)</span>\\ntcp        0      0 127.0.0.1:9999          0.0.0.0:*               LISTEN      -\\ntcp6       0      0 ::1:9999                :::*                    LISTEN      -</code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>åœ¨æœ¬åœ°9000ï¼ˆæˆ‘ç”¨çš„<a href=\\\"https://www.playframework.com/documentation/1.3.x/home\\\">play 1</a>ï¼Œå¯ä»¥äº†è§£ä¸‹å®ƒåˆ°åº•ä¸ºå•¥è¿™ä¹ˆå¥½ç”¨<a href=\\\"http://segmentfault.com/a/1190000000374033\\\">Play Framework â€”â€” Javaå¼€å‘è€…çš„æ¢¦æƒ³æ¡†æ¶</a>ï¼‰ä¸Šå¼€å¯webæœåŠ¡</p>\\n</li>\\n<li>\\n<p>åœ¨æµè§ˆå™¨é‡Œè¾“å…¥<a href=\\\"http://myserver_ip_address:9999%EF%BC%8C\\\">http://myserver<em>ip</em>address:9999ï¼Œ</a> å±…ç„¶æ˜¯æ²¡æœ‰å“åº”ï¼å¥‡æ€ªï¼ç›´æ¥åœ¨serverä¸Šç”¨curl <a href=\\\"http://localhost:9999\\\">http://localhost:9999</a> æ˜¯å¯ä»¥çš„ï¼ä»”ç»†çœ‹netstatè¾“å‡ºï¼Œå‘ç°ç›‘å¬çš„9999ç«¯å£æ˜¯æœ¬åœ°çš„ï¼ï¼ï¼ä¹Ÿå°±æ˜¯è¯´åªèƒ½åœ¨æœ¬åœ°è®¿é—®ï¼Œé‚£æœ‰xxç”¨å•Šï¼ï¼ï¼</p>\\n</li>\\n<li>\\n<p>çœ‹çœ‹ssh â€”helpï¼Œ åŸæ¥æ˜¯å¯ä»¥æŒ‡å®šbind_addressçš„ï¼Œ man sshçœ‹çœ‹</p>\\n<blockquote>\\n<p>By default, the listening socket on the server will be bound to the loopback interface only.  This may be overridden by specifying a bind<em>address. An empty bind</em>address, or the address â€˜*â€™, indicates that the remote socket should listen on all interfaces.  Specifying a remote bind<em>address will only succeed if the serverâ€™s GatewayPorts option is enabled (see sshd</em>config(5)).</p>\\n</blockquote>\\n</li>\\n</ol>\\n<p>  ç»§ç»­çœ‹çœ‹ man sshd_config</p>\\n<blockquote>\\n<p>GatewayPorts\\nSpecifies whether remote hosts are allowed to connect to ports forwarded for the client.  By default, sshd(8) binds remote port forwardings to the\\nloopback address.  This prevents other remote hosts from connecting to forwarded ports.  GatewayPorts can be used to specify that sshd should allow</p>\\n</blockquote>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">remote port forwardings to bind to non-loopback addresses, thus allowing other hosts to connect.  The argument may be â€œnoâ€ to force remote port\\nforwardings to be available to the local host only, â€œyesâ€ to force remote port forwardings to bind to the wildcard address, or â€œclientspecifiedâ€ to\\nallow the client to select the address to which the forwarding is bound.  The default is â€œnoâ€.</code></pre>\\n      </div>\\n<p> sudo vim /etc/ssh/sshd<em>configï¼Œæ·»åŠ GatewayPorts clientspecifiedï¼ŒGatewayPorts yesä¹Ÿå¯ä»¥ï¼Œé€€å‡ºï¼Œsudo service sshd restartï¼Œé‡å¯sshæœåŠ¡ã€‚é‡æ–°ssh -R :9999:localhost:9000 ubuntu@myserver</em>ip<em>addressï¼ˆä»”ç»†çœ‹ï¼Œå°±9999å‰å¤šäº†ä¸€ä¸ªå†’å·:ï¼‰ï¼Œè¾“å…¥å¯†ç ï¼Œnetstat -anltp | grep 9999ï¼Œæœç„¶\\n<code class=\\\"language-text\\\">tcp        0      0 0.0.0.0:9999            0.0.0.0:*               LISTEN      -\\n\\ttcp6       0      0 :::9999                 :::*                    LISTEN      -</code>\\næµè§ˆå™¨é‡Œè¾“å…¥<a href=\\\"http://myserver\\\">http://myserver</a></em>ip_address:9999ï¼Œ è¿™å›å¯ä»¥çœ‹åˆ°æœ¬åœ°æ‰“å‡ºæ—¥å¿—äº†ã€‚</p>\\n<ol start=\\\"6\\\">\\n<li>\\n<p>ç„¶åå‘ç°å¾®ä¿¡é‡Œé¢é…ç½®çš„urlåªèƒ½æ˜¯80ç«¯å£ã€‚ç®€å•ï¼Œç›´æ¥æ”¹æˆssh -R :80:localhost:9000 ubuntu@myserver<em>ip</em>addresså°±å¯ä»¥äº†ï¼Œå§ï¼å¥‡æ€ªï¼Œç›´æ¥è®¿é—®<a href=\\\"http://myserver_ip_address%EF%BC%8C\\\">http://myserver<em>ip</em>addressï¼Œ</a> æ‰“ä¸å¼€ç½‘é¡µï¼ç”¨netstat -anltp | grep 80ï¼Œå±…ç„¶ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼è¯´æ˜serveræ²¡æœ‰åœ¨80ç«¯å£ç›‘å¬å‘€ï¼å“¦ï¼Œå¯¹äº†ubuntuä½äº1024çš„ç«¯å£æ˜¯éœ€è¦ç”¨rootæƒé™çš„ã€‚</p>\\n</li>\\n<li>\\n<p>ubuntué‡Œrooté»˜è®¤æ˜¯å…³é—­çš„ã€‚sudo passwd rootï¼Œè®¾ç½®rootå¯†ç åï¼Œå¯ä»¥æ‰“å¼€ã€‚è¿˜éœ€è¦åœ¨sudo vim /etc/ssh/sshd_config\\tæ·»åŠ </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">#PermitRootLogin without-password\\nPermitRootLogin yes</code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>é‡å¯sshï¼Œå†é‡æ–°ç”¨rootè´¦å·è¿æ¥ï¼Œssh -R :80:localhost:9000 root@myserver<em>ip</em>addressï¼Œ ä¸€åˆ‡okï¼Œ<a href=\\\"http://myserver_ip_address%EF%BC%8C\\\">http://myserver<em>ip</em>addressï¼Œ</a> æœ¬åœ°ä»£ç æ‰“å‡ºæ—¥å¿—ï¼Œè¯´æ˜æµé‡å·²ç»å¯¼å…¥åˆ°æœ¬åœ°äº†ã€‚</p>\\n</li>\\n<li>\\n<p>æœ€åï¼Œå°±å¯ä»¥åœ¨<a href=\\\"http://mp.weixin.qq.com/debug\\\">å¾®ä¿¡å…¬ä¼—å¹³å°æ¥å£è°ƒè¯•å·¥å…·</a>é‡Œè°ƒè¯•äº†ï¼Œé…åˆ<a href=\\\"http://playframework.com/\\\">Play!</a>çš„hot reloadï¼Œéšæ—¶ä¿®æ”¹ä»£ç ï¼ŒåŠ logï¼Œç„¶åé©¬ä¸Šå°±å¯ä»¥çœ‹åˆ°æ•ˆæœï¼Œä¸ç”¨é‡æ–°ç¼–è¯‘ï¼Œä¸ç”¨ä¸Šä¼ serverï¼Œä¸ç”¨é‡å¯ã€‚ã€‚ã€‚ã€‚ç”Ÿæ´»çœŸæ˜¯å¹¸ç¦ç¾æ»¡å•Šã€‚ã€‚ã€‚ã€‚</p>\\n</li>\\n<li>\\n<p>å‡ ä¸ªé—®é¢˜è¯´æ˜ï¼š</p>\\n<ol>\\n<li>ç›´æ¥ç”¨sshè¿æ¥çš„è¯ï¼Œæ–­å¼€ä¹‹åç«¯å£æ˜ å°„å°±æ²¡æœ‰äº†ï¼Œå¯ä»¥ç”¨autosshï¼Œ åªæ˜¯æˆ‘å°±æ˜¯ä¸´æ—¶éœ€è¦è°ƒè¯•ç”¨çš„æ—¶å€™æ‰sshå»ºç«‹åå‘éš§é“ï¼Œæ‰€ä»¥æˆ‘ä¸ç”¨autosshã€‚</li>\\n<li>ç›´æ¥ç”¨rootç™»é™†sshï¼Œå¼€é€š80ç«¯å£ã€‚åº”è¯¥æ˜¯æœ‰å®‰å…¨éšæ‚£çš„ï¼Œ å§ï¼å¯¹å®‰å…¨ä¸æ˜¯å¾ˆäº†è§£ï¼Œä½†æ„Ÿè§‰ç›´æ¥ç”¨rootè‚¯å®šä¸æ˜¯æœ€ä½³å®è·µã€‚ç½‘ä¸Šæœ‰å„ç§æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ç”¨iptablesç«¯å£æ˜ å°„ï¼Œæˆ–è€…nginxåå‘ä»£ç†çš„ï¼Œ<a href=\\\"http://stackoverflow.com/questions/23281895/node-js-eacces-error-when-listening-on-http-80-port-permission-denied\\\">çœ‹è¿™é‡Œ</a>ï¼Œå‚çœ‹1çš„åŸå› ï¼Œæˆ‘æ²¡æœ‰é‡‡ç”¨ã€‚è¿˜æ˜¯ä¸€æ¬¡focusä¸€ä¸ªç‚¹å§ï¼Œä¸ç„¶å…‰ç¯å¢ƒå°±é…ç½®å‡ å¤©ï¼Œæœ‰ç‚¹å¤ªæ…¢äº†ã€‚</li>\\n</ol>\\n</li>\\n</ol>\\n<p>é€šè¿‡æœ¬æ–‡çš„é…ç½®ï¼Œå¯ä»¥åœ¨æœ¬åœ°æ–¹ä¾¿çš„å¼€å‘è°ƒè¯•å¾®ä¿¡å…¬å…±å·äº†ã€‚ä½†æ˜¯å¯¹äºå¾®ä¿¡æä¾›çš„<a href=\\\"http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html\\\">JS-SDK</a>ï¼Œåˆå­˜åœ¨å¦å¤–çš„é—®é¢˜ï¼Œè¿™ä¸ªæˆ‘ä¼š<a href=\\\"http://my.oschina.net/magicly007/blog/480704\\\">å¦å¤–å†™ä¸€ç¯‡blogæ¥è§£å†³</a>ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬ç¨‹åºå‘˜åº”è¯¥åšæŒ<a href=\\\"https://en.wikipedia.org/wiki/Single_responsibility_principle\\\">Single responsibility principle</a>å˜›ã€‚</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://www.mbnow.tk/2014/12/05/ngrok/\\\">http://www.mbnow.tk/2014/12/05/ngrok/</a></li>\\n<li><a href=\\\"http://my.oschina.net/jfinal/blog/336861\\\">http://my.oschina.net/jfinal/blog/336861</a></li>\\n<li><a href=\\\"http://www.mbnow.tk/2014/12/05/ngrok/\\\">http://www.mbnow.tk/2014/12/05/ngrok/</a></li>\\n<li><a href=\\\"http://liyaodong.com/2015/07/06/%E5%BE%AE%E4%BF%A1%E8%B0%83%E8%AF%95%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/\\\">http://liyaodong.com/2015/07/06/%E5%BE%AE%E4%BF%A1%E8%B0%83%E8%AF%95%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</a></li>\\n<li><a href=\\\"http://my.oschina.net/abcfy2/blog/177094\\\">http://my.oschina.net/abcfy2/blog/177094</a></li>\\n<li><a href=\\\"http://www.zhihu.com/question/25456655\\\">http://www.zhihu.com/question/25456655</a></li>\\n<li><a href=\\\"http://my.oschina.net/atanl/blog/391611\\\">http://my.oschina.net/atanl/blog/391611</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":5,\"excerpt\":\"å¾®ä¿¡å…¬å…±å·ç°åœ¨å¾ˆç«ï¼Œä¸€äº›ç®€å•çš„åº”ç”¨ï¼Œåšä¸€ä¸ªå…¬å…±å·æ¯”å¼€å‘ä¸€æ¬¾appæˆæœ¬è¦å°å¾ˆå¤šï¼Œè€Œä¸”åˆ©ç”¨æœ‹å‹åœˆçš„è½¬å‘ï¼Œç›¸æ¯”appå»app storeé‡Œä¸Šæ¶ç­‰ç€ç”¨æˆ·ä¸‹è½½ï¼Œè¦å®¹æ˜“å¾ˆå¤šã€‚ ä½†æ˜¯å¾®ä¿¡å…¬å…±å·çš„è°ƒè¯•æœ‰ç‚¹ä¸æ–¹ä¾¿ï¼Œå¿…é¡»åœ¨å¾®ä¿¡ ç®¡ç†åå° é…ç½®ä¸€ä¸ªå¾®ä¿¡èƒ½è®¿é—®åˆ°ï¼ˆå…¬ç½‘ï¼‰çš„urlâ€¦\",\"fields\":{\"slug\":\"/ssh-reverse-tunnel-wx-local/\"},\"frontmatter\":{\"title\":\"åˆ©ç”¨SSHåå‘é€šé“åœ¨æœ¬åœ°è°ƒè¯•å¾®ä¿¡å…¬å…±å·\",\"date\":\"2015-07-26\",\"category\":\"weixin\",\"tags\":[\"ssh\",\"weixin\",\"å¾®ä¿¡\"]}}},{\"node\":{\"html\":\"<p>å¼•ç”¨<a href=\\\"http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html\\\">é˜®è€å¸ˆ</a>çš„è¯ï¼Œ</p>\\n<blockquote>\\n<p>å–œæ¬¢å†™Blogçš„äººï¼Œä¼šç»å†ä¸‰ä¸ªé˜¶æ®µã€‚</p>\\n</blockquote>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">ç¬¬ä¸€é˜¶æ®µï¼Œåˆšæ¥è§¦Blogï¼Œè§‰å¾—å¾ˆæ–°é²œï¼Œè¯•ç€é€‰æ‹©ä¸€ä¸ªå…è´¹ç©ºé—´æ¥å†™ã€‚\\nç¬¬äºŒé˜¶æ®µï¼Œå‘ç°å…è´¹ç©ºé—´é™åˆ¶å¤ªå¤šï¼Œå°±è‡ªå·±è´­ä¹°åŸŸåå’Œç©ºé—´ï¼Œæ­å»ºç‹¬ç«‹åšå®¢ã€‚\\nç¬¬ä¸‰é˜¶æ®µï¼Œè§‰å¾—ç‹¬ç«‹åšå®¢çš„ç®¡ç†å¤ªéº»çƒ¦ï¼Œæœ€å¥½åœ¨ä¿ç•™æ§åˆ¶æƒçš„å‰æä¸‹ï¼Œè®©åˆ«äººæ¥ç®¡ï¼Œè‡ªå·±åªè´Ÿè´£å†™æ–‡ç« ã€‚</code></pre>\\n      </div>\\n<p>è‡ªå·±æ¯”è¾ƒæ‡’æƒ°ï¼Œä¹Ÿå°±å¶å°”åœ¨<a href=\\\"http://my.oschina.net/magicly007/blog\\\">OC</a>ä¸Šå†™ç‚¹é—²æ•£çš„ç¬”è®°ï¼Œæœ€è¿‘è§‰å¾—è¿˜æ˜¯åº”è¯¥è¦æŠŠè‡ªå·±çš„çŸ¥è¯†ç³»ç»Ÿåœ°æ¢³ç†ä¸€ä¸‹ï¼Œä¾¿å†³å®šå¼€ä¸€ä¸ªç‹¬ç«‹çš„åŸŸåï¼Œè‡ªå·±è®°å½•Blogã€‚</p>\\n<p>ä¹‹å‰å°±äº†è§£Github Pagesï¼Œä¹Ÿæ–­æ–­ç»­ç»­ç”¨MarkDownå†™è¿‡å‡ ç¯‡æ”¾ç€ï¼Œä½†æ˜¯æ²¡æœ‰ç”¨<a href=\\\"http://jekyllrb.com/\\\">jekyll</a>ï¼Œæˆ–è€…<a href=\\\"http://octopress.org/\\\">octpress</a>ç­‰ä¸²èµ·æ¥ï¼Œä¸Šä¸ªæœˆå†æ¬¡æƒ³é…ç½®å¥½jekyllï¼Œç»“æœåœ¨macä¸‹å§‹ç»ˆé…ç½®ä¸å¥½ï¼ˆæ€ªæˆ‘å’¯ï¼‰ã€‚ä»Šå¤©å†³å®šä¸€å®šè¦é…ç½®å¥½ï¼Œæœé›†äº†å¤§é‡èµ„æ–™ï¼ˆgoogle â€œjekyll åƒé»‘å®¢ä¸€æ ·â€ï¼‰ï¼Œç»“æœæ„å¤–åœ¨<a href=\\\"http://www.douban.com/group/topic/39939196/\\\">http://www.douban.com/group/topic/39939196/</a>çš„å›å¤ä¸­çœ‹åˆ°â€œç”¨pelicanå§ pythonçš„ è¿˜æœ‰hexoæ˜¯nodejsçš„ â€ã€‚å› ä¸ºæœ€è¿‘åˆšå¥½åœ¨çœ‹nodejsï¼Œè§‰å¾—å¾ˆæœ‰å…´è¶£ï¼Œäºæ˜¯æ”¹ä¸ºå°è¯•<a href=\\\"https://hexo.io/zh-cn/\\\">hexo</a>ã€‚</p>\\n<!-- more -->\\n<h1 id=\\\"ç®€ä»‹\\\"><a href=\\\"#%E7%AE%80%E4%BB%8B\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ç®€ä»‹</h1>\\n<p><a href=\\\"http://ibruce.info/2013/11/22/hexo-your-blog/\\\">http://ibruce.info/2013/11/22/hexo-your-blog/</a></p>\\n<blockquote>\\n<p>hexoå‡ºè‡ªå°æ¹¾å¤§å­¦ç”Ÿ<a href=\\\"https://twitter.com/tommy351\\\">tommy351</a>ä¹‹æ‰‹ï¼Œæ˜¯ä¸€ä¸ªåŸºäº<a href=\\\"https://nodejs.org/\\\">Node.js</a>çš„é™æ€åšå®¢ç¨‹åºï¼Œå…¶ç¼–è¯‘ä¸Šç™¾ç¯‡æ–‡å­—åªéœ€è¦å‡ ç§’ã€‚hexoç”Ÿæˆçš„é™æ€ç½‘é¡µå¯ä»¥ç›´æ¥æ”¾åˆ°GitHub Pagesï¼ŒBAEï¼ŒSAEç­‰å¹³å°ä¸Šã€‚å…ˆçœ‹çœ‹tommyæ˜¯å¦‚ä½•åæ§½Octopressçš„ â†’ï¼¿â†’ <a href=\\\"http://zespia.tw/blog/2012/10/11/hexo-debut/\\\">Hexoé¢¯çˆ½ç™»å ´</a>ã€‚</p>\\n</blockquote>\\n<h1 id=\\\"å®‰è£…\\\"><a href=\\\"#%E5%AE%89%E8%A3%85\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å®‰è£…</h1>\\n<p>é¦–å…ˆå®‰è£…Node.jsï¼Œç„¶åè¿è¡Œ</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\t<span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> -g hexo-cli\\n\\t<span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> hexo --save</code></pre>\\n      </div>\\n<h1 id=\\\"åˆå§‹åŒ–é…ç½®\\\"><a href=\\\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>åˆå§‹åŒ–é…ç½®</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo init\\n\\t<span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span></code></pre>\\n      </div>\\n<h1 id=\\\"å†™blog\\\"><a href=\\\"#%E5%86%99blog\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å†™blog</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo n</code></pre>\\n      </div>\\n<h1 id=\\\"ç”Ÿæˆ\\\"><a href=\\\"#%E7%94%9F%E6%88%90\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ç”Ÿæˆ</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo g</code></pre>\\n      </div>\\n<h1 id=\\\"æœ¬åœ°é¢„è§ˆ\\\"><a href=\\\"#%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æœ¬åœ°é¢„è§ˆ</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo s</code></pre>\\n      </div>\\n<h1 id=\\\"å‘å¸ƒ\\\"><a href=\\\"#%E5%8F%91%E5%B8%83\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å‘å¸ƒ</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo d</code></pre>\\n      </div>\\n<p>å®åœ¨è§‰å¾—æ²¡å¿…<a href=\\\"https://en.wikipedia.org/wiki/Reinventing_the_wheel\\\">é‡å¤é€ è½®å­</a>ï¼Œé‡å†™å·²ç»æœ‰å¾ˆè¯¦ç»†èµ„æ–™çš„ä¸œè¥¿ã€‚å¼ºçƒˆæ¨è<a href=\\\"http://ibruce.info/2013/11/22/hexo-your-blog/\\\">è¿™ç¯‡</a>ã€‚ æˆ‘è§‰å¾—åŸºæœ¬æ¶µç›–äº†æ–¹æ–¹é¢é¢ï¼Œå¦‚æœä»¥åæœ‰æ–°ä¸œè¥¿è¿™é‡Œé¢æ²¡æœ‰çš„ï¼Œæˆ‘å†å†™å§~</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://ibruce.info/2013/11/22/hexo-your-blog/\\\">http://ibruce.info/2013/11/22/hexo-your-blog/</a></li>\\n<li><a href=\\\"http://wsgzao.github.io/post/hexo-guide/\\\">http://wsgzao.github.io/post/hexo-guide/</a></li>\\n<li><a href=\\\"http://www.jianshu.com/p/05289a4bc8b2\\\">http://www.jianshu.com/p/05289a4bc8b2</a></li>\\n<li><a href=\\\"http://yangjian.me/workspace/building-blog-with-hexo/\\\">http://yangjian.me/workspace/building-blog-with-hexo/</a></li>\\n<li><a href=\\\"http://yangjian.me/workspace/building-blog-with-hexo/\\\">http://yangjian.me/workspace/building-blog-with-hexo/</a></li>\\n<li><a href=\\\"http://blog.csdn.net/jackystudio/article/details/16117585\\\">http://blog.csdn.net/jackystudio/article/details/16117585</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":2,\"excerpt\":\"å¼•ç”¨ é˜®è€å¸ˆ çš„è¯ï¼Œ å–œæ¬¢å†™Blogçš„äººï¼Œä¼šç»å†ä¸‰ä¸ªé˜¶æ®µã€‚ è‡ªå·±æ¯”è¾ƒæ‡’æƒ°ï¼Œä¹Ÿå°±å¶å°”åœ¨ OC ä¸Šå†™ç‚¹é—²æ•£çš„ç¬”è®°ï¼Œæœ€è¿‘è§‰å¾—è¿˜æ˜¯åº”è¯¥è¦æŠŠè‡ªå·±çš„çŸ¥è¯†ç³»ç»Ÿåœ°æ¢³ç†ä¸€ä¸‹ï¼Œä¾¿å†³å®šå¼€ä¸€ä¸ªç‹¬ç«‹çš„åŸŸåï¼Œè‡ªå·±è®°å½•Blogã€‚ ä¹‹å‰å°±äº†è§£Github Pagesï¼Œä¹Ÿæ–­æ–­ç»­ç»­ç”¨MarkDownâ€¦\",\"fields\":{\"slug\":\"/my-first-hexo-blog/\"},\"frontmatter\":{\"title\":\"æˆ‘çš„ç¬¬ä¸€ä¸ªhexo Blog\",\"date\":\"2015-07-26\",\"category\":\"default\",\"tags\":[\"hexo\",\"github\",\"githubPages\"]}}},{\"node\":{\"html\":\"<p>éœ€è¦åœ¨ä»£ç é‡Œé¢å‘é‚®ä»¶æ˜¯å¾ˆç»å¸¸çš„äº‹æƒ…ï¼ŒåŒ…æ‹¬æ‰¾å›å¯†ç ï¼Œé€šçŸ¥ç”¨æˆ·é¢†å¥–ï¼Œç›‘æ§æŠ¥è­¦ç­‰ã€‚</p>\\n<p>åœ¨Javaé‡Œé¢å®ç°æ¯”è¾ƒç®€å•ï¼ŒOracleè‡ªå·±æä¾›äº†<a href=\\\"http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-eeplat-419426.html#javamail-1.4.7-oth-JPR\\\">JavaMail</a>ï¼Œ ä¸è¿‡APIæ¯”è¾ƒåº•å±‚ï¼Œç”¨èµ·æ¥ä¸æ–¹ä¾¿ï¼Œå¯ä»¥è‡ªå·±å°è£…ä¸‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Apacheçš„å¼€æºé¡¹ç›®<a href=\\\"https://commons.apache.org/proper/commons-email/\\\">Commons Email</a>ã€‚ ä¸‹é¢çš„ä»£ç ï¼Œå¯ä»¥ä»¥å°é©¬å“¥çš„åä¹‰ç»™è‡ªå·±å‘é‚®ä»¶ï¼Œè¯¥åŠŸèƒ½ä»…ç”¨äºæµ‹è¯•ï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼Œäº§ç”Ÿçš„é—®é¢˜ï¼Œæœ¬äººæ¦‚ä¸è´Ÿè´£ã€‚ /å¾®ç¬‘</p>\\n<!-- more -->\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">import</span> org<span class=\\\"token punctuation\\\">.</span>apache<span class=\\\"token punctuation\\\">.</span>commons<span class=\\\"token punctuation\\\">.</span>mail<span class=\\\"token punctuation\\\">.</span>EmailAttachment<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> org<span class=\\\"token punctuation\\\">.</span>apache<span class=\\\"token punctuation\\\">.</span>commons<span class=\\\"token punctuation\\\">.</span>mail<span class=\\\"token punctuation\\\">.</span>EmailException<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> org<span class=\\\"token punctuation\\\">.</span>apache<span class=\\\"token punctuation\\\">.</span>commons<span class=\\\"token punctuation\\\">.</span>mail<span class=\\\"token punctuation\\\">.</span>MultiPartEmail<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>net<span class=\\\"token punctuation\\\">.</span>MalformedURLException<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>net<span class=\\\"token punctuation\\\">.</span>URL<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * Created by magicalli on 2015/7/6.\\n */</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">MultiPartEmailTest</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">main</span><span class=\\\"token punctuation\\\">(</span>String<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> args<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> EmailException<span class=\\\"token punctuation\\\">,</span> MalformedURLException <span class=\\\"token punctuation\\\">{</span>\\n        MultiPartEmail email <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">MultiPartEmail</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setHostName</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"smtp.tencent.com\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token comment\\\">//        email.setAuthentication(\\\"youremail@tencent.com\\\", \\\"***\\\");//é‚®ä»¶æœåŠ¡å™¨éªŒè¯ï¼šç”¨æˆ·å/å¯†ç </span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setCharset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"UTF-8\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setFrom</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"pony@qq.com\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"é©¬åŒ–è…¾\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addTo</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"magicalli@tencent.com\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setSubject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"åŠ æ²¹å¥‹æ–—ï¼\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setMsg</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"come on! åŠ æ²¹å¥‹æ–—å§ï¼Œæ—©æ™šæœ‰ä¸€å¤©ä½ ä¼šå‡ºä»»CEOï¼Œè¿å¨¶ç™½å¯Œç¾ï¼Œèµ°ä¸Šäººç”Ÿå·…å³°ï¼ http://www.qq.com\\\\n\\\\n\\\\n pony\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        EmailAttachment attachment <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">EmailAttachment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setPath</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"d:/lzl.jpg\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">// æœ¬åœ°æ–‡ä»¶</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDisposition</span><span class=\\\"token punctuation\\\">(</span>EmailAttachment<span class=\\\"token punctuation\\\">.</span>ATTACHMENT<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDescription</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"æ—å¿—ç²1\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setName</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"lzl_1\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">attach</span><span class=\\\"token punctuation\\\">(</span>attachment<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        EmailAttachment attachment2 <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">EmailAttachment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setURL</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">URL</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"http://mat1.qq.com/datalib_img/star/pic/lib/2007-01-15/2007011511104716122311.jpg\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è¿œç¨‹æ–‡ä»¶, å¦‚æœä¸æ˜¯qq.comåŸŸåä¸‹ï¼Œå†…ç½‘æ˜¯è®¿é—®ä¸äº†çš„å“ˆ</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDisposition</span><span class=\\\"token punctuation\\\">(</span>EmailAttachment<span class=\\\"token punctuation\\\">.</span>ATTACHMENT<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDescription</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"æ—å¿—ç²2\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setName</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"lzl_2\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">attach</span><span class=\\\"token punctuation\\\">(</span>attachment2<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p><a href=\\\"https://commons.apache.org/proper/commons-email/\\\">Commons Email</a>æ”¯æŒå¥½å‡ ç§æ ¼å¼ï¼ŒåŒ…æ‹¬ç®€å•æ–‡æœ¬ï¼Œhtmlï¼Œå¸¦é™„ä»¶ç­‰ã€‚éœ€è¦çš„å¯ä»¥è‡ªå·±æŸ¥çœ‹æ–‡æ¡£ã€‚</p>\\n<p>åŸºäºsmtpçš„åè®®é‚®ä»¶åè®®å¾ˆç®€å•ï¼Œå¤§å®¶ç”šè‡³å¯ä»¥ç›´æ¥ç”¨telnetæ¥å‘é€ï¼Œå¯ä»¥å‚è€ƒè¿™è¾¹æ–‡ç« <a href=\\\"http://blog.csdn.net/ghsau/article/details/8602076\\\">Java Mail(ä¸€)ï¼štelnetå®ç°å‘é€æ”¶å–é‚®ä»¶</a>. </p>\\n<p>ä¸€èˆ¬å…¬å¸å†…ç½‘æ²¡æœ‰éªŒè¯å‘é€æ–¹ï¼Œä½ å¯ä»¥å†’å……å…¬å¸ä»»ä½•ä¸€ä¸ªå‘˜å·¥å‘é€é‚®ä»¶ï¼ˆåŒ…æ‹¬ä½ ä»¬è€æ¿ï¼‰ï¼Œä¸€èˆ¬å¤–é¢çš„é‚®ä»¶æœåŠ¡å™¨ï¼Œæ¯”å¦‚qq, 126, 163ç­‰ï¼Œæ˜¯éœ€è¦éªŒè¯å¯†ç çš„ã€‚</p>\\n<p>é‡ç”³ä¸€éï¼Œåˆ«ç”¨è¿™ä¸ªä»£ç å¹²åäº‹ï¼Œåæœè‡ªè´Ÿï¼Œ ä¸æœ¬äººæ— å…³ï¼</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://blog.csdn.net/ghsau/article/details/8602076\\\">http://blog.csdn.net/ghsau/article/details/8602076</a></li>\\n<li><a href=\\\"http://blog.csdn.net/ghsau/article/details/17839983\\\">http://blog.csdn.net/ghsau/article/details/17839983</a></li>\\n<li><a href=\\\"http://haolloyin.blog.51cto.com/1177454/354320\\\">http://haolloyin.blog.51cto.com/1177454/354320</a></li>\\n<li><a href=\\\"http://www.runoob.com/java/java-sending-email.html\\\">http://www.runoob.com/java/java-sending-email.html</a></li>\\n<li><a href=\\\"https://commons.apache.org/proper/commons-email/\\\">https://commons.apache.org/proper/commons-email/</a></li>\\n<li><a href=\\\"http://blog.csdn.net/qiaqia609/article/details/11580589\\\">http://blog.csdn.net/qiaqia609/article/details/11580589</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":2,\"excerpt\":\"éœ€è¦åœ¨ä»£ç é‡Œé¢å‘é‚®ä»¶æ˜¯å¾ˆç»å¸¸çš„äº‹æƒ…ï¼ŒåŒ…æ‹¬æ‰¾å›å¯†ç ï¼Œé€šçŸ¥ç”¨æˆ·é¢†å¥–ï¼Œç›‘æ§æŠ¥è­¦ç­‰ã€‚ åœ¨Javaé‡Œé¢å®ç°æ¯”è¾ƒç®€å•ï¼ŒOracleè‡ªå·±æä¾›äº† JavaMail ï¼Œ ä¸è¿‡APIæ¯”è¾ƒåº•å±‚ï¼Œç”¨èµ·æ¥ä¸æ–¹ä¾¿ï¼Œå¯ä»¥è‡ªå·±å°è£…ä¸‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Apacheçš„å¼€æºé¡¹ç›® Commons Emailâ€¦\",\"fields\":{\"slug\":\"/java-email/\"},\"frontmatter\":{\"title\":\"Javaå‘é€é‚®ä»¶\",\"date\":\"2015-07-13\",\"category\":\"Java\",\"tags\":[\"Java\",\"Email\",\"JavaMail\",\"Apache Commons\"]}}},{\"node\":{\"html\":\"<p>ç»å¸¸é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨å†…å­˜é‡Œç¼“å­˜ä¸€æ‰¹æ•°æ®æ¥æé«˜æ•ˆç‡ï¼ˆé¿å…æ¯æ¬¡éƒ½è¯»å–DBï¼‰ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œè¿™äº›å¯¹è±¡åˆ°åº•ä¼šå ç”¨å¤šå¤§å†…å­˜å‘¢ï¼Œè¿™ç›´æ¥å†³å®šäº†å¯ä»¥ç¼“å­˜å¤šå°‘æ¡è®°å½•ï¼Œä»¥åŠä¸Šçº¿ä¹‹åæ˜¯å¦ä¼šå†…å­˜ä¸å¤Ÿç­‰é—®é¢˜ã€‚</p>\\n<p>æ¥çœ‹å‡ ç§è§£å†³æ–¹æ³•ã€‚</p>\\n<!-- more -->\\n<h1 id=\\\"æµ‹è¯•\\\"><a href=\\\"#%E6%B5%8B%E8%AF%95\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æµ‹è¯•</h1>\\n<p>å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ï¼æ¯”å¦‚ä½ è¦æƒ³cache10wæ¡è®°å½•ï¼Œé‚£ä½ å°±æŠŠ10wæ¡è®°å½•åŠ è½½åˆ°å†…å­˜ï¼Œç„¶åçœ‹çœ‹åˆ°åº•ç”¨äº†å¤šå°‘å†…å­˜ã€‚è‡³äºæ€ä¹ˆçœ‹å†…å­˜èŠ±äº†å¤šå°‘ï¼Œä½ å¯ä»¥</p>\\n<ol>\\n<li>ä»»åŠ¡ç®¡ç†å™¨</li>\\n<li>top</li>\\n<li>Java Runtimeç±»</li>\\n<li>blablaã€‚ã€‚ã€‚ã€‚</li>\\n</ol>\\n<p>æˆ‘ä»¬æ¥çœ‹çœ‹ç›´æ¥ä»Javaç¨‹åºé‡Œèƒ½è·å–åˆ°çš„Runtimeã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>util<span class=\\\"token punctuation\\\">.</span>*<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * Created by magicalli on 2015/2/3.\\n */</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">TestMemory</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">A</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">int</span> a<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">main</span><span class=\\\"token punctuation\\\">(</span>String<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> args<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"--- Memory Usage ---:\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        Runtime rt <span class=\\\"token operator\\\">=</span> Runtime<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getRuntime</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token comment\\\">//æ‰“å°æ€»å†…å­˜å¤§å° //æ‰“å°ç©ºé—²å†…å­˜å¤§å° //æ‰“å°å·²ç”¨å†…å­˜å¤§å° å•ä½(å­—èŠ‚)</span>\\n        <span class=\\\"token keyword\\\">long</span> usedMemory <span class=\\\"token operator\\\">=</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">-</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Total Memory= \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Free Memory = \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Usedã€€Memory=\\\"</span> <span class=\\\"token operator\\\">+</span> usedMemory<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token comment\\\">// æŠŠä½ è¦æµ‹è¯•çš„å ç”¨å†…å­˜çš„ä»£ç æ”¾åœ¨è¿™é‡Œ------start--------------</span>\\n        <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">int</span> N <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">100000</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> arr <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">int</span><span class=\\\"token punctuation\\\">[</span>N<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        Integer<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> arr2 <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Integer</span><span class=\\\"token punctuation\\\">[</span>N<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        A<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> arrA <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">A</span><span class=\\\"token punctuation\\\">[</span>N<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> i <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;</span> N<span class=\\\"token punctuation\\\">;</span> i<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            arr<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> i<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token comment\\\">//            arr2[i] = i;</span>\\n<span class=\\\"token comment\\\">//            arrA[i] = new A();</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token comment\\\">//        List&lt;Integer> list = new ArrayList&lt;Integer>();</span>\\n        Map<span class=\\\"token generics function\\\"><span class=\\\"token punctuation\\\">&lt;</span>Integer<span class=\\\"token punctuation\\\">,</span> String<span class=\\\"token punctuation\\\">></span></span> map <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">HashMap</span><span class=\\\"token generics function\\\"><span class=\\\"token punctuation\\\">&lt;</span>Integer<span class=\\\"token punctuation\\\">,</span> String<span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token comment\\\">//        for (int i = 0; i &lt; N; i++) {</span>\\n<span class=\\\"token comment\\\">//            list.add(i);</span>\\n<span class=\\\"token comment\\\">//            map.put(i, UUID.randomUUID().toString());</span>\\n<span class=\\\"token comment\\\">//        }</span>\\n<span class=\\\"token comment\\\">//        System.out.println(map.size());</span>\\n        <span class=\\\"token comment\\\">// æŠŠä½ è¦æµ‹è¯•çš„å ç”¨å†…å­˜çš„ä»£ç æ”¾åœ¨è¿™é‡Œ------end--------------</span>\\n\\n        <span class=\\\"token keyword\\\">long</span> usedMemory2 <span class=\\\"token operator\\\">=</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">-</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Total Memory= \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Free Memory = \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Usedã€€Memory=\\\"</span> <span class=\\\"token operator\\\">+</span> usedMemory2<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">long</span> objMemory <span class=\\\"token operator\\\">=</span> usedMemory2 <span class=\\\"token operator\\\">-</span> usedMemory<span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"object use memory: \\\"</span> <span class=\\\"token operator\\\">+</span> objMemory <span class=\\\"token operator\\\">/</span> <span class=\\\"token number\\\">1024</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\"k\\\"</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" each is: \\\"</span> <span class=\\\"token operator\\\">+</span> objMemory <span class=\\\"token operator\\\">/</span> N<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ä¸Šé¢æ–¹æ³•çš„æœ€å¤§å¥½å¤„å°±æ˜¯å¯ä»¥ç›´æ¥è·å¾—å®é™…å ç”¨å†…å­˜å¤§å°ï¼Œæ˜¯æ¯”è¾ƒç®€å•æœ‰æ•ˆçš„æ–¹æ³•ã€‚ä¸å¥½çš„åœ°æ–¹å°±æ˜¯å¦‚æœæ•°æ®é‡æ¯”è¾ƒå°ï¼Œå¯èƒ½åå·®æ¯”è¾ƒå¤§ï¼Œè€Œä¸”ä½ ä¹Ÿä¸èƒ½è§£é‡Šä¸ºä»€ä¹ˆInteger[]æ¯”int[]å ç”¨å†…å­˜å¤§å¾ˆå¤šï¼Œå…³é”®æ˜¯ä¸“å®¶è¯´ï¼šè¿™ç§å†…å­˜å ç”¨åº”è¯¥æ˜¯å¿ƒé‡Œç®—å‡ºæ¥çš„ï¼Œä½ è¿˜è¦å»runä¸€ä¸‹ç¨‹åºï¼Œæ˜æ˜¾å°±lowäº†ï¼Œè¿˜æƒ³æ™‹çº§ï¼Ÿå†ç»ƒç»ƒå§ï¼æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆææŒ‡ä¸€ç®—ï¼</p>\\n<h1 id=\\\"è®¡ç®—\\\"><a href=\\\"#%E8%AE%A1%E7%AE%97\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>è®¡ç®—</h1>\\n<p>è¿™ä¸ªéœ€è¦äº†è§£JVMé‡Œçš„å†…å­˜åˆ†å¸ƒï¼ŒçŸ¥é“æ¯ä¸ªå¯¹è±¡éƒ½æœ‰object headerï¼Œblabalã€‚è¿™é‡Œæ¨èä¸€ç¯‡å¥½æ–‡<a href=\\\"http://www.cnblogs.com/magialmoon/p/3757767.html\\\">ä¸€ä¸ªJavaå¯¹è±¡åˆ°åº•å ç”¨å¤šå¤§å†…å­˜ï¼Ÿ</a>ï¼Œæˆ‘å°±ä¸é‡å¤äº†ã€‚</p>\\n<p>è¿˜çœ‹åˆ°å¦ä¸€ç§è®¡ç®—æ–¹å¼ï¼Œç”¨çš„Unsafeï¼Œä¸è¿‡æ„Ÿè§‰æ²¡æœ‰å‰é¢ç”¨Instrumentationçš„å¥½ã€‚å‚è€ƒè¿™é‡Œ<a href=\\\"http://blog.csdn.net/bobpauline/article/details/20699233\\\">Javaè®¡ç®—ä¸€ä¸ªå¯¹è±¡å ç”¨å†…å­˜çš„å¤§å°</a></p>\\n<h1 id=\\\"çº¿ä¸ŠæŸ¥çœ‹\\\"><a href=\\\"#%E7%BA%BF%E4%B8%8A%E6%9F%A5%E7%9C%8B\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>çº¿ä¸ŠæŸ¥çœ‹</h1>\\n<p>å¦‚æœæ˜¯è¦æŸ¥çœ‹çº¿ä¸Šç¨‹åºå“ªä¸ªå¯¹è±¡å ç”¨äº†å¤§é‡å†…å­˜ï¼ˆæ¯”å¦‚åˆ†æå†…å­˜æ³„éœ²ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨jmapã€‚</p>\\n<h1 id=\\\"ç›¸å…³çŸ¥è¯†\\\"><a href=\\\"#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ç›¸å…³çŸ¥è¯†</h1>\\n<p>ä½ å¯èƒ½éœ€è¦äº†è§£jpsï¼Œjinfoï¼Œæ‰“åŒ…jarï¼Œmanifestï¼ŒæŸ¥çœ‹jvmè¿è¡Œå‚æ•°ç­‰ã€‚</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://www.importnew.com/14948.html\\\">http://www.importnew.com/14948.html</a></li>\\n<li><a href=\\\"http://www.cnblogs.com/magialmoon/p/3757767.html\\\">http://www.cnblogs.com/magialmoon/p/3757767.html</a></li>\\n<li><a href=\\\"http://www.oschina.net/question/1_4486\\\">http://www.oschina.net/question/1_4486</a></li>\\n<li><a href=\\\"http://blog.csdn.net/bobpauline/article/details/20699233\\\">http://blog.csdn.net/bobpauline/article/details/20699233</a></li>\\n<li><a href=\\\"http://happyqing.iteye.com/blog/2013639\\\">http://happyqing.iteye.com/blog/2013639</a></li>\\n<li><a href=\\\"http://sunqi.iteye.com/blog/1917802\\\">http://sunqi.iteye.com/blog/1917802</a></li>\\n<li><a href=\\\"http://www.blogjava.net/stone2083/archive/2013/06/08/400410.html\\\">http://www.blogjava.net/stone2083/archive/2013/06/08/400410.html</a></li>\\n<li><a href=\\\"http://yueyemaitian.iteye.com/blog/2033046\\\">http://yueyemaitian.iteye.com/blog/2033046</a></li>\\n<li><a href=\\\"http://www.ibm.com/developerworks/cn/java/j-lo-jse61/index.html\\\">http://www.ibm.com/developerworks/cn/java/j-lo-jse61/index.html</a></li>\\n<li><a href=\\\"http://www.ibm.com/developerworks/cn/java/j-lo-instrumentation/\\\">http://www.ibm.com/developerworks/cn/java/j-lo-instrumentation/</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":2,\"excerpt\":\"ç»å¸¸é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨å†…å­˜é‡Œç¼“å­˜ä¸€æ‰¹æ•°æ®æ¥æé«˜æ•ˆç‡ï¼ˆé¿å…æ¯æ¬¡éƒ½è¯»å–DBï¼‰ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œè¿™äº›å¯¹è±¡åˆ°åº•ä¼šå ç”¨å¤šå¤§å†…å­˜å‘¢ï¼Œè¿™ç›´æ¥å†³å®šäº†å¯ä»¥ç¼“å­˜å¤šå°‘æ¡è®°å½•ï¼Œä»¥åŠä¸Šçº¿ä¹‹åæ˜¯å¦ä¼šå†…å­˜ä¸å¤Ÿç­‰é—®é¢˜ã€‚ æ¥çœ‹å‡ ç§è§£å†³æ–¹æ³•ã€‚ æµ‹è¯• å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ï¼æ¯”å¦‚ä½ è¦æƒ³cache10wâ€¦\",\"fields\":{\"slug\":\"/how-big-is-a-java-object/\"},\"frontmatter\":{\"title\":\"ä¸€ä¸ªJavaå¯¹è±¡åˆ°åº•æœ‰å¤šå¤§\",\"date\":\"2015-06-13\",\"category\":\"Java\",\"tags\":[\"Java\",\"JVM\",\"Javaåå°„\"]}}},{\"node\":{\"html\":\"<p>java5ä¹‹åçš„java.util.concurrentåŒ…æ˜¯ä¸–ç•Œçº§å¹¶å‘å¤§å¸ˆDoug Leaçš„ä½œå“ï¼Œé‡Œé¢ä¸»è¦å®ç°äº†</p>\\n<ol>\\n<li>atomicåŒ…é‡ŒInteger/Longå¯¹åº”çš„åŸå­ç±»ï¼Œä¸»è¦åŸºäºCASï¼›</li>\\n<li>ä¸€äº›åŒæ­¥å­ï¼ŒåŒ…æ‹¬Lockï¼ŒCountDownLatchï¼ŒSemaphoreï¼ŒFutureTaskç­‰ï¼Œè¿™äº›éƒ½æ˜¯åŸºäºAbstractQueuedSynchronizerç±»ï¼›</li>\\n<li>å…³äºçº¿ç¨‹æ‰§è¡Œçš„Executorsç±»ç­‰ï¼›</li>\\n<li>ä¸€äº›å¹¶å‘çš„é›†åˆç±»ï¼Œæ¯”å¦‚ConcurrentHashMapï¼ŒConcurrentLinkedQueueï¼ŒCopyOnWriteArrayListç­‰ã€‚</li>\\n</ol>\\n<p>ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä»‹ç»AbstractQueuedSynchronizerè¿™ä¸ªå¯ä»¥è¯´æ˜¯æœ€æ ¸å¿ƒçš„ç±»ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚æ•´ä¸ªconcurrentåŒ…é‡Œï¼ŒåŸºæœ¬éƒ½ç›´æ¥æˆ–é—´æ¥åœ°ç”¨åˆ°äº†è¿™ä¸ªç±»ã€‚Doug Leaçš„è¿™ç¯‡<a href=\\\"http://gee.cs.oswego.edu/dl/papers/aqs.pdf\\\">è®ºæ–‡</a>é‡Œé¢è®²AQSçš„å®ç°ã€‚</p>\\n<!-- more -->\\n<h1 id=\\\"aqs\\\"><a href=\\\"#aqs\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>AQS</h1>\\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€é—´å±‹é‡Œæœ‰ä¸€ä¸ªå¤§å®¶éƒ½æƒ³è¦å¾—åˆ°çš„ä¼šè®©ä½ å¾ˆçˆ½çš„ä¸œè¥¿ï¼ˆsomething which makes you so happy, e.g. W.Cï¼‰ã€‚å½“æœ‰äººè¿›å»æŠŠé—¨å…³èµ·æ¥åœ¨ç‹¬å äº«ç”¨çš„æ—¶å€™ï¼Œå…¶ä»–äººå°±åªèƒ½åœ¨å¤–é¢æ’é˜Ÿç­‰å¾…ï¼Œæ—¢ç„¶åœ¨ç­‰å¾…ï¼Œä½ å°±ä¸èƒ½è€æ˜¯å»æ•²é—¨è¯´å“ï¼Œå¥½äº†æ²¡æœ‰å•Šã€‚è€æ˜¯è¿™æ ·çš„è¯é‡Œé¢çš„äººå°±å¾ˆä¸çˆ½äº†ï¼Œè€Œä¸”ä½ å¯ä»¥åˆ©ç”¨è¿™ç‚¹ç­‰å¾…æ—¶é—´å¹²ç‚¹åˆ«çš„ï¼Œæ¯”å¦‚çœ‹çœ‹å°è¯´è§†é¢‘èƒŒèƒŒå•è¯æˆ–è€…å°±å¹²è„†æ¤…å­ä¸Šç¡è§‰ï¼Œå½“å‰é¢ç‹¬å çš„äººçˆ½å®Œä¹‹åï¼Œå°±ä¼šå‡ºæ¥è¯´ï¼Œå•Šï¼Œå¥½çˆ½ï¼Œåˆ°ä½ ä»¬äº†ã€‚ç„¶åå¤§å®¶å¯èƒ½æŒ‰ç…§æ’é˜Ÿé¡ºåºè·å–æˆ–è€…å¤§å®¶ç–¯æŠ¢è¿™ä¸ªçŠ¶æ€ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªäººè‡ªå·±è¿›å»ç‹¬å ï¼Œæœ‰å¯èƒ½å‡ ä¸ªäººè¯´ï¼Œå“æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·æ¥ã€‚ç„¶åä»–ä»¬è¿›å»çˆ½ï¼Œçˆ½å®Œä¹‹åå†å‡ºæ¥é€šçŸ¥ä¸‹ä¸€ä¸ªã€‚</p>\\n<p>æˆ‘ä»¬æ¥æŠŠä¸Šé¢è¿™æ®µè¯ç¿»è¯‘æˆAQSé‡Œé¢çš„æœ¯è¯­ã€‚æœ‰ä¸€ä¸ªçŠ¶æ€stateï¼Œä¼šæœ‰å¤šä¸ªThreadå°è¯•è·å–ï¼Œå½“ä¸€ä¸ªThreadç‹¬å ï¼ˆEXCLUSIVEï¼Œæ¯”å¦‚Lockï¼‰ä¹‹åï¼Œå…¶ä»–åé¢åˆ°æ¥çš„Threadå°±ä¼šè¢«æ”¾åˆ°ä¸€ä¸ªQueueçš„é˜Ÿå°¾ï¼ˆtailï¼‰ï¼Œç„¶åç¡çœ ï¼ˆparkï¼‰ï¼Œä¸€ç›´ç­‰åˆ°å‰é¢çš„Threadå”¤é†’ï¼ˆunparkï¼‰å®ƒï¼Œå½“ç„¶è¿™é‡Œæœ‰å¯èƒ½è¢«å‡å”¤é†’ï¼ˆå°±å¥½æ¯”ä½ å®šäº†é—¹é’Ÿ8ç‚¹èµ·åºŠï¼Œç»“æœ7ç‚¹å°±è‡ªç„¶é†’æˆ–è€…è¢«å¤–é¢è½¦åµé†’ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªThreadä¼šåˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯åˆ°è‡ªå·±äº†ï¼Œæ²¡æœ‰çš„è¯å°±ç»§ç»­parkï¼ˆåœ¨ä¸€ä¸ªæ­»å¾ªç¯é‡Œï¼‰ï¼›å½“æ‹¥æœ‰stateçš„Threadé‡Šæ”¾ï¼ˆreleaseï¼‰ä¹‹åï¼Œå®ƒä¼šå”¤é†’Queueä¸­çš„ä¸‹ä¸€ä¸ªThreadï¼ˆunparkSuccessorï¼‰ã€‚ç„¶åä¸‹ä¸€ä¸ªThreadè·å–ï¼ˆacquireï¼‰åˆ°stateï¼Œå®Œæˆè‡ªå·±çš„ä»»åŠ¡ï¼Œç„¶åç»§ç»­unparkSuccessorã€‚å‰é¢ä¸»è¦è¯´çš„æ˜¯EXCLUSIVEæ¨¡å¼ï¼ŒAQSè¿˜æ”¯æŒå…±äº«ï¼ˆSHAREDï¼‰æ¨¡å¼ï¼ŒåŒºåˆ«åœ¨äºå°è¯•è·å–ï¼ˆtryAcquireSharedï¼‰çš„æ—¶å€™å³ä½¿ä¹‹å‰å·²ç»æœ‰Threadè·å–äº†stateï¼Œä½†æ˜¯å¯èƒ½ä»ç„¶èƒ½è·å–ï¼ˆæ¯”å¦‚ReadLockï¼‰ã€‚åŒæ ·é‡Šæ”¾ï¼ˆdoReleaseSharedï¼‰çš„æ—¶å€™é™¤äº†é€šçŸ¥Queueé‡Œé¢ç¬¬ä¸€ä¸ªï¼ˆheadï¼‰ï¼Œè¿˜ä¼šç»§ç»­é€šçŸ¥åç»­çš„èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼Œåªè¦å®ƒä»¬æ˜¯SHAREDã€‚</p>\\n<p>AQSå°±æ˜¯å®ç°äº†ï¼š</p>\\n<ol>\\n<li>è‡ªåŠ¨ç®¡ç†è¿™ä¸ªåŒæ­¥çŠ¶æ€stateï¼ˆintç±»å‹ï¼‰ï¼Œæ›´æ–°çš„æ—¶å€™éœ€è¦ç”¨CASä¿è¯åŸå­æ€§</li>\\n<li>é˜»å¡å’Œå”¤é†’çº¿ç¨‹park/unpark</li>\\n<li>é˜Ÿåˆ—ç®¡ç†ï¼Œä¸€ä¸ªåŒå‘é“¾è¡¨å®ç°queue</li>\\n</ol>\\n<p>AQSæ˜¯ä¸€ä¸ªabstract classï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿AQSï¼Œå®šä¹‰stateçš„å«ä¹‰ï¼Œä»¥åŠtryAcquireï¼ŒtryReleaseï¼Œä»¥åŠå¯¹åº”çš„shareæ¨¡å¼ä¸‹tryAcquireSharedï¼ŒtryReleaseSharedè¿™å‡ ä¸ªæ–¹æ³•ï¼Œå®šä¹‰å‡ºè‡ªå·±æƒ³è¦çš„åŒæ­¥å­ï¼ˆSynchronizersï¼‰ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ˜¯å®šä¹‰ä¸€ä¸ªå†…éƒ¨ç±»Sync extends AQSï¼Œå®ç°å‰é¢è¯´çš„å‡ ä¸ªæ–¹æ³•ï¼Œç„¶åå†åŒ…ä¸€å±‚ï¼Œæš´éœ²å‡ºç›¸åº”çš„æ–¹æ³•ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ä½ å¯ä»¥åœ¨åŒ…è£…å™¨ç±»é‡Œé¢å–æ›´ç›´è§‚çš„åå­—ï¼Œå¦‚ReentrantLocké‡Œçš„lockï¼Œunlockå’ŒCountDownLatché‡Œçš„countDownï¼Œawaitï¼Œè€Œä¸æ˜¯å¤ªé€šç”¨çš„acquireå’Œreleaseç­‰ã€‚è€Œä¸”AQSé‡Œé¢ä¸€äº›æ–¹æ³•æ˜¯ä¸ºäº†ç›‘æ§å’Œè°ƒè¯•ä½¿ç”¨ï¼Œç›´æ¥æš´éœ²å‡ºæ¥ä¹Ÿä¸å¥½ã€‚</p>\\n<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹J.U.Cé‡Œé¢ä¸¤ä¸ªå¸¸ç”¨çš„Synchronizersã€‚</p>\\n<h1 id=\\\"reentrantlock\\\"><a href=\\\"#reentrantlock\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ReentrantLock</h1>\\n<h2 id=\\\"ä½¿ç”¨\\\"><a href=\\\"#%E4%BD%BF%E7%94%A8\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ä½¿ç”¨</h2>\\n<p>ReentrantLockçš„è¯­ä¹‰è·Ÿsynchronizedå…³é”®å­—åŸºæœ¬ä¸€æ ·ï¼Œè€Œä¸”æˆ‘ä¹‹å‰çœ‹<a href=\\\"http://book.douban.com/subject/6522893/\\\">ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹</a>é‡Œé¢çš„è¯„æµ‹è¯´JDK6ä¹‹åï¼Œä¸¤è€…çš„æ•ˆç‡åŸºæœ¬ä¸€è‡´äº†ï¼ˆJDK5ä¹‹å‰ReentrantLockè¦æ¯”synchronizedå¿«å¾ˆå¤šï¼‰ã€‚Javadocé‡Œé¢è¯´åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">X</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">final</span> ReentrantLock lock <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">ReentrantLock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token comment\\\">// ...</span>\\n  <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">m</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    lock<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// block until condition holds</span>\\n    <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token comment\\\">// ... method body</span>\\n    <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n      lock<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">unlock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<h2 id=\\\"æºç \\\"><a href=\\\"#%E6%BA%90%E7%A0%81\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æºç </h2>\\n<p>ReentrantLockç”¨stateè¡¨ç¤ºæ˜¯å¦è¢«é”ï¼Œ0è¡¨ç¤ºæ²¡æœ‰çº¿ç¨‹è·å–åˆ°é”ï¼Œ>=1è¡¨ç¤ºæŸä¸ªçº¿ç¨‹è·å–äº†Næ¬¡é”ï¼ˆå› ä¸ºæ˜¯é‡å…¥çš„ï¼Œåªè¦ä¿è¯lockå’Œunlockæˆå¯¹å‡ºç°å°±æ²¡æœ‰é—®é¢˜ï¼‰ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token comment\\\">/** Synchronizer providing all implementation mechanics */</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">final</span> Sync sync<span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">abstract</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Sync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">AbstractQueuedSynchronizer</span> <span class=\\\"token punctuation\\\">{</span></code></pre>\\n      </div>\\n<p>å®šä¹‰äº†ä¸€ä¸ªå†…éƒ¨ç±»ï¼ŒåŸºæœ¬ä»»åŠ¡éƒ½ä»£ç†ç»™syncå®Œæˆã€‚è€ŒSyncåˆæ˜¯ä¸€ä¸ªabstract classï¼Œè¿™é‡Œä¸»è¦æ˜¯å› ä¸ºå®ç°äº†ä¸¤ç§æŠ¢å é”çš„æœºåˆ¶ï¼Œå…¬å¹³é”å’Œéå…¬å¹³é”ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">FairSync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Sync</span>\\n\\t\\n\\t<span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">NonfairSync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Sync</span></code></pre>\\n      </div>\\n<p>æ‰€è°“å…¬å¹³ä¸å…¬å¹³ç®€å•æ¥è¯´å°±æ˜¯æœ¬æ–‡å¼€å¤´è¯´çš„ï¼Œå½“èµ„æºé‡Šæ”¾çš„æ—¶å€™ï¼Œå¤§å®¶æ˜¯æŒ‰ç…§æ’é˜Ÿé¡ºåºå…ˆåˆ°å…ˆå¾—ï¼Œè¿˜æ˜¯æœ‰äººæ’é˜Ÿå¤§å®¶ç–¯æŠ¢ã€‚</p>\\n<p>æä¾›äº†ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">ReentrantLock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">NonfairSync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é»˜è®¤éå…¬å¹³é”ï¼ŒAQSè®ºæ–‡è¯´éå…¬å¹³é”æ•ˆç‡é«˜äº›ï¼Œç†ç”±å…¶å®å¾ˆç®€å•ï¼Œå…¬å¹³é”é€šçŸ¥é˜Ÿåˆ—ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¦æŠŠå®ƒå”¤é†’ï¼Œè€Œå”¤é†’æ˜¯éœ€è¦æ—¶é—´çš„ï¼Œåœ¨é”é‡Šæ”¾åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è¢«å”¤é†’è¿™æ®µæ—¶é—´å…¶å®é”æ˜¯å¯ä»¥ç”¨ä½†æ˜¯æ²¡æœ‰è¢«ç”¨çš„ï¼ˆavailable but not usedï¼‰ï¼›è€Œéå…¬å¹³é”ï¼Œé‡Šæ”¾äº†ä¹‹åç«‹é©¬å°±å¯ä»¥è¢«åˆ«äººç”¨ï¼Œæ‰€ä»¥æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯æœ‰å¯èƒ½å¯¼è‡´é¥¥é¥¿é”ï¼Œè¿™ä¸ªå°±è¦å…·ä½“çœ‹ä¸šåŠ¡éœ€æ±‚äº†ã€‚</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">ReentrantLock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">boolean</span> fair<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync <span class=\\\"token operator\\\">=</span> fair <span class=\\\"token operator\\\">?</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">FairSync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">NonfairSync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æŒ‡å®šå…¬å¹³ä¸å¦</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>åŠ é”çš„å®ç°</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ç®€å•ä»£ç†ç»™äº†syncï¼Œåœ¨FairSyncé‡Œä¸º</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\t\\t<span class=\\\"token function\\\">acquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\t<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>acquireçš„å®ç°åœ¨AQSé‡Œé¢ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">acquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n            <span class=\\\"token function\\\">acquireQueued</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node<span class=\\\"token punctuation\\\">.</span>EXCLUSIVE<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token function\\\">selfInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>tryAcquireæ˜¯è¦åœ¨å­ç±»é‡Œè‡ªå·±å®ç°çš„ï¼Œåœ¨FairSyncå¦‚ä¸‹;</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t <span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">final</span> Thread current <span class=\\\"token operator\\\">=</span> Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//0è¡¨ç¤ºé”æ²¡æœ‰è¢«çº¿ç¨‹ç”¨ï¼Œ1è¡¨ç¤ºå·²ç»æœ‰çº¿ç¨‹å ç”¨</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">hasQueuedPredecessors</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token comment\\\">//åˆ¤æ–­è‡ªå·±æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå®ç°å…¬å¹³</span>\\n                    <span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> acquires<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//CASæ›´æ–°çŠ¶æ€</span>\\n                    <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>current<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è®¾ç½®å½“å‰çº¿ç¨‹æ‹¥æœ‰çŠ¶æ€</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">else</span> <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>current <span class=\\\"token operator\\\">==</span> <span class=\\\"token function\\\">getExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//1è¡¨ç¤ºå·²ç»æœ‰çº¿ç¨‹å ç”¨ï¼Œå†åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦è¢«å½“å‰çº¿ç¨‹å ç”¨ï¼Œæ¥å®ç°é‡å…¥ï¼ˆReentrantï¼‰ç‰¹æ€§</span>\\n                <span class=\\\"token keyword\\\">int</span> nextc <span class=\\\"token operator\\\">=</span> c <span class=\\\"token operator\\\">+</span> acquires<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nextc <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Error</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Maximum lock count exceeded\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span>nextc<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æ›´æ–°çŠ¶æ€</span>\\n                <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¦‚æœè·å–å¤±è´¥ï¼ŒaddWaiter(Node.EXCLUSIVE)å°†å½“å‰çº¿ç¨‹åŠ å…¥é˜Ÿå°¾</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">private</span> Node <span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node mode<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        Node node <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Node</span><span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> mode<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//ç”¨å½“å‰çº¿ç¨‹æ„é€ Nodeï¼Œç‹¬å æ¨¡å¼</span>\\n        <span class=\\\"token comment\\\">// Try the fast path of enq; backup to full enq on failure</span>\\n        Node pred <span class=\\\"token operator\\\">=</span> tail<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>pred <span class=\\\"token operator\\\">!=</span> null<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            node<span class=\\\"token punctuation\\\">.</span>prev <span class=\\\"token operator\\\">=</span> pred<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetTail</span><span class=\\\"token punctuation\\\">(</span>pred<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å¿«é€Ÿåˆ¤æ–­ï¼ŒCASæ›´æ–°tailèŠ‚ç‚¹</span>\\n                pred<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">return</span> node<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token function\\\">enq</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¦‚æœå¤±è´¥ï¼Œè¿›å…¥enqæ–¹æ³•</span>\\n        <span class=\\\"token keyword\\\">return</span> node<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    \\n\\t <span class=\\\"token keyword\\\">private</span> Node <span class=\\\"token function\\\">enq</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">final</span> Node node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            Node t <span class=\\\"token operator\\\">=</span> tail<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>t <span class=\\\"token operator\\\">==</span> null<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">// Must initialize</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetHead</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Node</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//å¦‚æœè¿˜æ²¡æœ‰headï¼ŒCASåˆå§‹åŒ–ä¸€ä¸ªhead</span>\\n                    tail <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//è¿™æ®µä»£ç è·ŸaddWaiteré‡Œä¸€æ ·ï¼ŒCASæ›´æ–°tailèŠ‚ç‚¹</span>\\n                node<span class=\\\"token punctuation\\\">.</span>prev <span class=\\\"token operator\\\">=</span> t<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetTail</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    t<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">return</span> t<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ç°åœ¨æˆ‘ä»¬å·²ç»å°†è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥é˜Ÿå°¾äº†ï¼Œç°åœ¨è¦å°†å®ƒæŒ‚èµ·acquireQueued(addWaiter(Node.EXCLUSIVE), arg))ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">acquireQueued</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">final</span> Node node<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">boolean</span> failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">boolean</span> interrupted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//åœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ï¼Œé¿å…å‡å”¤é†’</span>\\n                <span class=\\\"token keyword\\\">final</span> Node p <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">predecessor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è·å–å½“å‰èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯headè¯´æ˜è‡ªå·±æ˜¯ç¬¬ä¸€ä¸ªå¯ä»¥è·å–èµ„æºçš„çº¿ç¨‹ï¼Œå®ç°å…¬å¹³</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>p <span class=\\\"token operator\\\">==</span> head <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//æ˜¯ç¬¬ä¸€ä¸ªå¯ä»¥è·å–èµ„æºçš„çº¿ç¨‹å¹¶ä¸”å°è¯•è·å–æˆåŠŸ</span>\\n                    <span class=\\\"token function\\\">setHead</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    p<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// help GC</span>\\n                    failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">return</span> interrupted<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">shouldParkAfterFailedAcquire</span><span class=\\\"token punctuation\\\">(</span>p<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                    <span class=\\\"token function\\\">parkAndCheckInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//æ²¡æœ‰è·å–åˆ°èµ„æºï¼Œç¡çœ parkå»</span>\\n                    interrupted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>failed<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">cancelAcquire</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">parkAndCheckInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        LockSupport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">park</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ä¸Šé¢å®Œæˆäº†è·å–é”çš„è¿‡ç¨‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯å°è¯•è·å–ï¼Œå¤±è´¥å°±åŠ å…¥é˜Ÿå°¾ï¼ŒæŒ‚èµ·ï¼Œç­‰å¾…è¢«å”¤é†’ã€‚</p>\\n<p>ä¸‹é¢æ¥çœ‹çœ‹é‡Šæ”¾é”</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">unlock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">release</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//ä»£ç†ç»™syncï¼Œè°ƒç”¨AQSçš„release</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">//ä¸‹é¢ä»£ç åœ¨AQSä¸­</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">release</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">tryRelease</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å°è¯•é‡Šæ”¾èµ„æºï¼Œéœ€è¦åœ¨å­ç±»é‡Œå®ç°</span>\\n            Node h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">!=</span> null <span class=\\\"token operator\\\">&amp;&amp;</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">!=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">unparkSuccessor</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é€šçŸ¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">unparkSuccessor</span><span class=\\\"token punctuation\\\">(</span>Node node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token comment\\\">/*\\n         * If status is negative (i.e., possibly needing signal) try\\n         * to clear in anticipation of signalling.  It is OK if this\\n         * fails or if status is changed by waiting thread.\\n         */</span>\\n        <span class=\\\"token keyword\\\">int</span> ws <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span>waitStatus<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>ws <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token function\\\">compareAndSetWaitStatus</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">,</span> ws<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token comment\\\">/*\\n         * Thread to unpark is held in successor, which is normally\\n         * just the next node.  But if cancelled or apparently null,\\n         * traverse backwards from tail to find the actual\\n         * non-cancelled successor.\\n         */</span>\\n         <span class=\\\"token comment\\\">// ä¸»è¦åœ¨è¿™é‡Œæ‰¾åˆ°ä¸‹ä¸€ä¸ªéœ€è¦é€šçŸ¥çš„èŠ‚ç‚¹ï¼Œå¦‚æœnode.nextå°±æ˜¯éœ€è¦é€šçŸ¥çš„èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥é€šçŸ¥ï¼›å¦åˆ™ï¼Œå¯èƒ½node.next == nullï¼ˆåŸå› æ˜¯åŒå‘é“¾è¡¨è®¾ç½®b.pre = aå’Œa.next = bçš„æ—¶å€™ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œåªèƒ½ä¿è¯b.pre = aæˆåŠŸï¼Œè¿™æ—¶å€™å¦ä¸€æ¡çº¿ç¨‹å¯èƒ½çœ‹åˆ°a.next == nullï¼‰æˆ–è€…s.waitStatus > 0ï¼ˆåŸå› æ˜¯çº¿ç¨‹ç­‰ä¸åŠè¢«å–æ¶ˆäº†static final int CANCELLED = 1;ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ä»é˜Ÿå°¾tailå¼€å§‹æ‰¾ï¼Œæ‰¾åˆ°ç¦»é˜Ÿå¤´headæœ€è¿‘çš„ä¸€ä¸ªéœ€è¦é€šçŸ¥çš„èŠ‚ç‚¹Nodeã€‚</span>\\n        Node s <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span>next<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>s <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> s<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">></span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            s <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span>Node t <span class=\\\"token operator\\\">=</span> tail<span class=\\\"token punctuation\\\">;</span> t <span class=\\\"token operator\\\">!=</span> null <span class=\\\"token operator\\\">&amp;&amp;</span> t <span class=\\\"token operator\\\">!=</span> node<span class=\\\"token punctuation\\\">;</span> t <span class=\\\"token operator\\\">=</span> t<span class=\\\"token punctuation\\\">.</span>prev<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">&lt;=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                    s <span class=\\\"token operator\\\">=</span> t<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>s <span class=\\\"token operator\\\">!=</span> null<span class=\\\"token punctuation\\\">)</span>\\n            LockSupport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">unpark</span><span class=\\\"token punctuation\\\">(</span>s<span class=\\\"token punctuation\\\">.</span>thread<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å”¤é†’çº¿ç¨‹</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>çœ‹çœ‹éœ€è¦åœ¨å­ç±»é‡Œå®ç°çš„tryReleaseï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t<span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryRelease</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> releases<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">-</span> releases<span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é‡Šæ”¾é”ï¼Œstateå‡å»ç›¸åº”çš„å€¼</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token function\\\">getExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">IllegalMonitorStateException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é¿å…Açº¿ç¨‹é”äº†ä¹‹åï¼ŒBçº¿ç¨‹æ•…æ„æ£ä¹±é‡Šæ”¾é”</span>\\n            <span class=\\\"token keyword\\\">boolean</span> free <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å½“å‰çº¿ç¨‹å·²ç»å®Œå…¨é‡Šæ”¾äº†é”</span>\\n                free <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>null<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é‡Šæ”¾é”çš„æ‹¥æœ‰è€…</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span>c<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è®¾ç½®çŠ¶æ€ï¼Œè¿™ä¸ªæ–¹é¢æ²¡æœ‰åŒæ­¥ï¼Œæ²¡æœ‰CASï¼Œæœ‰åŒå­¦é—®è¿‡å²‚ä¸æ˜¯æœ‰çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿå…¶å®åˆ°è¿™é‡Œï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å¹¶å‘é”™è¯¯ï¼Œä»”ç»†æƒ³æƒ³ï¼Œæ˜¯å§ï¼Ÿæ˜¯å§ï¼Ÿ</span>\\n            <span class=\\\"token keyword\\\">return</span> free<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬éƒ½å·²ç»å®Œæˆï¼Œå¯¹äº†ï¼Œè¿˜æ²¡æœ‰è¯´éå…¬å¹³é”NonfairSyncæ˜¯æ€ä¹ˆæŠ¢å é”çš„ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//å…ˆæŠ¢ä¸€æŠŠï¼ˆæ’é˜Ÿï¼‰ï¼Œä¸‡ä¸€æˆåŠŸäº†å°±ä¸æ’é˜Ÿï¼Œä¸å…¬å¹³æ€§å°±ä½“ç°åœ¨è¿™é‡Œï¼</span>\\n                <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">else</span>\\n                <span class=\\\"token function\\\">acquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>è·ŸFairSync.lock()å¯¹æ¯”ï¼Œå¯ä»¥çœ‹å‡ºï¼Œåªæ˜¯åœ¨acquire(1)ä¹‹å‰ï¼Œå…ˆæŠ¢ä¸€æŠŠï¼ŒæŠ¢ä¸åˆ°æ‰ä¹–ä¹–çš„å»æ’é˜Ÿã€‚</p>\\n<p>æˆ‘ä»¬å†çœ‹çœ‹NonfairSync.tryAcquire()æ€ä¹ˆå®ç°çš„</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t<span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token function\\\">nonfairTryAcquire</span><span class=\\\"token punctuation\\\">(</span>acquires<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è°ƒç”¨çˆ¶ç±»æ–¹æ³•nonfairTryAcquire</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">nonfairTryAcquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">final</span> Thread current <span class=\\\"token operator\\\">=</span> Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> acquires<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//è·ŸFairSync.tryAcquireåªæœ‰è¿™é‡Œä¸€è¡Œæœ‰å·®å¼‚ï¼Œå³å°‘äº†!hasQueuedPredecessors()ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åˆ¤æ–­å‰é¢æœ‰æ²¡æœ‰äººï¼Œä»»ä½•æ—¶å€™åªè¦å®ƒé†’æ¥ï¼Œéƒ½ä¼šå»æŠ¢ï¼Œæ‰€ä»¥ä¸å…¬å¹³ï¼============åˆšåˆçœ‹äº†ä¸€éï¼Œå‘ç°å…¶å®final boolean acquireQueued(final Node node, int arg)æ–¹æ³•é‡Œå·²ç»æœ‰node.predecessor() == headçš„åˆ¤æ–­ï¼Œæ„Ÿè§‰è¿™ä¸ªä¸å…¬å¹³çš„tryAcquireè²Œä¼¼æ²¡æœ‰æ„ä¹‰ï¼Œå„ä½çœ‹å®˜æ€ä¹ˆçœ‹å‘¢ï¼Œè¯·ç•™è¨€å“ˆï¼Œè°¢è°¢~</span>\\n                    <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>current<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">else</span> <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>current <span class=\\\"token operator\\\">==</span> <span class=\\\"token function\\\">getExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">int</span> nextc <span class=\\\"token operator\\\">=</span> c <span class=\\\"token operator\\\">+</span> acquires<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nextc <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// overflow</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Error</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Maximum lock count exceeded\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span>nextc<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<h1 id=\\\"countdownlatch\\\"><a href=\\\"#countdownlatch\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>CountDownLatch</h1>\\n<p>æˆ‘ä»¬ä¹‹å‰è¯´äº†ï¼ŒAQSæ”¯æŒç‹¬å EXCLUSIVEå’Œå…±äº«SHAREDä¸¤ç§æ¨¡å¼ï¼Œè€Œåˆšåˆšçš„ReentrantLockçš„å°±æ˜¯ç‹¬å æ¨¡å¼ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªä½¿ç”¨å…±äº«æ¨¡å¼çš„ç±»ã€‚</p>\\n<h2 id=\\\"ä½¿ç”¨-1\\\"><a href=\\\"#%E4%BD%BF%E7%94%A8-1\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ä½¿ç”¨</h2>\\n<p>CountDownLatchå°±å¥½æ¯”ä¸€é“é—¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç­‰æ‰€æœ‰èµ„æºéƒ½åˆ°é½äº†ï¼Œæ‰å¼€é—¨ï¼Œè®©è¿™äº›çº¿ç¨‹åŒæ—¶é€šè¿‡ã€‚æ¯”å¦‚å¦‚ä¸‹æ˜¯CountDownLatchä¸€ä¸ªé€šç”¨ç”¨æ³•ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">package</span> concurrentStudy<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>util<span class=\\\"token punctuation\\\">.</span>concurrent<span class=\\\"token punctuation\\\">.</span>CountDownLatch<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * Created by magicalli on 2014/12/13.\\n */</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">IndexPlusPlusTest01</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">int</span> NThreads <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">10</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">// çº¿ç¨‹æ•°</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">int</span> M <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">100000</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¾ªç¯æ¬¡æ•°ï¼Œå¤ªå°çš„è¯ï¼ˆæ¯”å¦‚10ï¼‰å¯èƒ½çœ‹ä¸å‡ºæ¥æ•ˆæœ</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">volatile</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">int</span> n <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//åŠ volatileçš„ç›®çš„æ˜¯ä¸ºäº†è¯æ˜volatileæ²¡æœ‰â€œåŸå­æ€§â€ï¼</span>\\n\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">main</span><span class=\\\"token punctuation\\\">(</span>String<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> args<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">final</span> CountDownLatch startGate <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">CountDownLatch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">final</span> CountDownLatch endGate <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">CountDownLatch</span><span class=\\\"token punctuation\\\">(</span>NThreads<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> i <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;</span> NThreads<span class=\\\"token punctuation\\\">;</span> i<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Thread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Runnable</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token annotation punctuation\\\">@Override</span>\\n                <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">run</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n                        startGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æ‰€æœ‰çº¿ç¨‹startä¹‹åç­‰å¾…â€œé—¨â€œæ‰“å¼€ï¼Œä¿è¯åŒæ—¶çœŸæ­£å¼€å§‹è¿è¡Œ</span>\\n                    <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">catch</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">InterruptedException</span> e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        e<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">printStackTrace</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n\\n                    <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> j <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> j <span class=\\\"token operator\\\">&lt;</span> M<span class=\\\"token punctuation\\\">;</span> j<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        n <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n\\n                    endGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">countDown</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">start</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n\\n        startGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">countDown</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æ‰“å¼€â€œé—¨â€ï¼Œè®©æ‰€æœ‰çº¿ç¨‹åŒæ—¶runèµ·æ¥</span>\\n        <span class=\\\"token keyword\\\">long</span> t1 <span class=\\\"token operator\\\">=</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentTimeMillis</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        endGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//ç­‰æ‰€æœ‰çº¿ç¨‹éƒ½ç»“æŸä¹‹åæ‰æ‰“å°nï¼Œå¦åˆ™æ€»æ˜¯ä¼šæ‰“å‡ºé”™è¯¯çš„nï¼›æˆ‘è§è¿‡è¿™é‡Œç”¨Thread.sleep()ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºï¼Œä½ æ€ä¹ˆçŸ¥é“è¯¥ç­‰å¤šä¹…æ‰èƒ½ä¿è¯æ‰€æœ‰çº¿ç¨‹ç»“æŸä»¥åŠåˆšå¥½ç»“æŸå‘¢ï¼Ÿï¼</span>\\n        <span class=\\\"token keyword\\\">long</span> t2 <span class=\\\"token operator\\\">=</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentTimeMillis</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"cost time: \\\"</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token punctuation\\\">(</span>t2 <span class=\\\"token operator\\\">-</span> t1<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"n: \\\"</span> <span class=\\\"token operator\\\">+</span> n<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¯¹äº†ï¼Œä¸Šé¢ä»£ç æ˜¯æ‹¿æ¥éªŒè¯volatileä¸å…·å¤‡åŸå­æ€§çš„ï¼Œæ˜¯é”™è¯¯çš„ä»£ç å“¦ã€‚å¦‚æœæƒ³å¹¶å‘å®‰å…¨ï¼Œå¤§å®¶å¯ä»¥æƒ³æƒ³å¯ä»¥ç”¨å“ªäº›æ–¹å¼å®ç°ã€‚</p>\\n<h2 id=\\\"æºç -1\\\"><a href=\\\"#%E6%BA%90%E7%A0%81-1\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æºç </h2>\\n<p>CountDownLatchåŒæ ·ä¹Ÿæ˜¯å®šä¹‰äº†ä¸€ä¸ªç»§æ‰¿è‡ªAQSçš„å†…éƒ¨ç±»Syncï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Sync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">AbstractQueuedSynchronizer</span></code></pre>\\n      </div>\\n<p>æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">CountDownLatch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> count<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>count <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">IllegalArgumentException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"count &lt; 0\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>sync <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Sync</span><span class=\\\"token punctuation\\\">(</span>count<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>countè¡¨ç¤ºæœ‰å¤šå°‘ä¸ªä»»åŠ¡è¿˜åœ¨è¿è¡Œï¼Œæ¯ä¸ªThreadå®Œæˆäº†ä»»åŠ¡æˆ–è€…å‡†å¤‡å¥½å¼€å§‹ä¹‹å‰ï¼Œå°±ä¼šè°ƒç”¨countDownæ–¹æ³•å°†count-1ï¼Œå½“count==0æ—¶å€™ï¼Œawaitå°±ä¸å†é˜»å¡ï¼Œæ‰€æœ‰åœ¨ä¸Šé¢é˜»å¡çš„Threadéƒ½å¯ä»¥é¡ºåˆ©é€šè¿‡ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">acquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ç›´æ¥è°ƒç”¨AQSçš„acquireSharedInterruptiblyæ–¹æ³•ï¼Œä»æ–¹æ³•åå¯ä»¥çœ‹å‡ºï¼Œæ”¯æŒä¸­æ–­å“åº”</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">acquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å“åº”ä¸­æ–­</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token function\\\">doAcquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>tryAcquireSharedåœ¨å­ç±»ä¸­å®ç°ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">        <span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">int</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">?</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token operator\\\">:</span> <span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¦‚æœstateä¸º0ï¼Œè¯´æ˜æ‰€æœ‰Threadå®Œæˆä»»åŠ¡ï¼Œå¯ä»¥ä¸é˜»å¡äº†</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¦‚æœæ²¡æœ‰è·å–åˆ°ï¼Œå°†ThreadåŠ å…¥é˜Ÿå°¾ï¼ŒæŒ‚èµ·ã€‚ä¸‹é¢è¿™ä¸ªæ–¹æ³•è·Ÿç‹¬å æ¨¡å¼ä¸‹acquireQueued(addWaiter(Node.EXCLUSIVE), arg))è¿™ä¸ªæ–¹æ³•ä»£ç æ˜¯åŸºæœ¬ä¸€è‡´çš„ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">doAcquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">final</span> Node node <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node<span class=\\\"token punctuation\\\">.</span>SHARED<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å…±äº«æ¨¡å¼</span>\\n        <span class=\\\"token keyword\\\">boolean</span> failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">final</span> Node p <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">predecessor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>p <span class=\\\"token operator\\\">==</span> head<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">int</span> r <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>r <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        <span class=\\\"token function\\\">setHeadAndPropagate</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">,</span> r<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è·ŸEXCLUSIVEçš„ä¸€å¤§åŒºåˆ«</span>\\n                        p<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// help GC</span>\\n                        failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token keyword\\\">return</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">shouldParkAfterFailedAcquire</span><span class=\\\"token punctuation\\\">(</span>p<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                    <span class=\\\"token function\\\">parkAndCheckInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å“åº”ä¸­æ–­ï¼Œè¿™é‡Œç›´æ¥æŠ›å¼‚å¸¸</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>failed<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">cancelAcquire</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">setHeadAndPropagate</span><span class=\\\"token punctuation\\\">(</span>Node node<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">int</span> propagate<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        Node h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// Record old head for check below</span>\\n        <span class=\\\"token function\\\">setHead</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token comment\\\">/*\\n         * Try to signal next queued node if:\\n         *   Propagation was indicated by caller,\\n         *     or was recorded (as h.waitStatus either before\\n         *     or after setHead) by a previous operation\\n         *     (note: this uses sign-check of waitStatus because\\n         *      PROPAGATE status may transition to SIGNAL.)\\n         * and\\n         *   The next node is waiting in shared mode,\\n         *     or we don't know, because it appears null\\n         *\\n         * The conservatism in both of these checks may cause\\n         * unnecessary wake-ups, but only when there are multiple\\n         * racing acquires/releases, so most need signals now or soon\\n         * anyway.\\n         */</span>\\n         <span class=\\\"token comment\\\">// å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯æ„¿æ„å…±äº«ï¼Œå¹¶ä¸”ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿæ˜¯æ„¿æ„å…±äº«çš„ï¼Œé‚£ä¹ˆå°±è¿›å…¥doReleaseSharedï¼Œå”¤é†’ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸‹é¢ä¼šè¯¦è§£</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>propagate <span class=\\\"token operator\\\">></span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">||</span> h <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">||</span>\\n            <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            Node s <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span>next<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>s <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> s<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">isShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">doReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å‰é¢å®Œæˆäº†ç­‰å¾…CountDownLatchçš„countå˜æˆ0çš„è¿‡ç¨‹ï¼Œä¸‹é¢çœ‹çœ‹countDown</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">countDown</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">releaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è°ƒç”¨AQSçš„</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token comment\\\">// AQSä¸­</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">releaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">tryReleaseShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å°è¯•é‡Šæ”¾ï¼Œéœ€è¦åœ¨å­ç±»ä¸­å®ç°</span>\\n            <span class=\\\"token function\\\">doReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//çœŸæ­£é‡Šæ”¾</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t\\t<span class=\\\"token comment\\\">// Syncå­ç±»ä¸­å®ç°</span>\\n\\t    <span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> releases<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token comment\\\">// Decrement count; signal when transition to zero</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">int</span> nextc <span class=\\\"token operator\\\">=</span> c<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span>c<span class=\\\"token punctuation\\\">,</span> nextc<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">// åœ¨æ­»å¾ªç¯ä¸­CASå°†count-1</span>\\n                    <span class=\\\"token keyword\\\">return</span> nextc <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        \\n    <span class=\\\"token comment\\\">// AQSä¸­</span>\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">doReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token comment\\\">/*\\n         * Ensure that a release propagates, even if there are other\\n         * in-progress acquires/releases.  This proceeds in the usual\\n         * way of trying to unparkSuccessor of head if it needs\\n         * signal. But if it does not, status is set to PROPAGATE to\\n         * ensure that upon release, propagation continues.\\n         * Additionally, we must loop in case a new node is added\\n         * while we are doing this. Also, unlike other uses of\\n         * unparkSuccessor, we need to know if CAS to reset status\\n         * fails, if so rechecking.\\n         */</span>\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            Node h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">!=</span> null <span class=\\\"token operator\\\">&amp;&amp;</span> h <span class=\\\"token operator\\\">!=</span> tail<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">int</span> ws <span class=\\\"token operator\\\">=</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>ws <span class=\\\"token operator\\\">==</span> Node<span class=\\\"token punctuation\\\">.</span>SIGNAL<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">compareAndSetWaitStatus</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">,</span> Node<span class=\\\"token punctuation\\\">.</span>SIGNAL<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                        <span class=\\\"token keyword\\\">continue</span><span class=\\\"token punctuation\\\">;</span>            <span class=\\\"token comment\\\">// loop to recheck cases</span>\\n                    <span class=\\\"token function\\\">unparkSuccessor</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//éå†queueï¼Œé€šçŸ¥æ‰€æœ‰SHAREDçš„èŠ‚ç‚¹ï¼Œå› ä¸ºæ˜¯å…±äº«æ¨¡å¼ï¼Œè¿™äº›Nodeéƒ½åº”è¯¥è¢«å”¤é†’ï¼Œç›´åˆ°é‡åˆ°æŸä¸ªEXCLUSIVEçš„Node</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token keyword\\\">else</span> <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>ws <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                         <span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">compareAndSetWaitStatus</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> Node<span class=\\\"token punctuation\\\">.</span>PROPAGATE<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">continue</span><span class=\\\"token punctuation\\\">;</span>                <span class=\\\"token comment\\\">// loop on failed CAS</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">==</span> head<span class=\\\"token punctuation\\\">)</span>                   <span class=\\\"token comment\\\">// loop if head changed</span>\\n                <span class=\\\"token keyword\\\">break</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>unparkSuccessorè·Ÿä¹‹å‰ç‹¬å æ¨¡å¼é‡Œé¢çš„æ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œå³è°ƒç”¨unparkå”¤é†’Threadã€‚</p>\\n<p>æˆ‘ä»¬çŸ¥é“ä¸ºäº†é¿å…è·å–ä¸åˆ°é”é•¿æ—¶é—´ç­‰å¾…ï¼Œä¸€èˆ¬é˜»å¡çš„æ–¹æ³•éƒ½ä¼šæ”¯æŒå¸¦è¶…æ—¶æ—¶é—´çš„æ–¹æ³•ï¼Œæ¯”å¦‚CountDownLatché‡Œå°±æœ‰</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">long</span> timeout<span class=\\\"token punctuation\\\">,</span> TimeUnit unit<span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span> sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">tryAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> unit<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toNanos</span><span class=\\\"token punctuation\\\">(</span>timeout<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>è°ƒç”¨AQSé‡Œé¢çš„tryAcquireSharedNanosæ–¹æ³•</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">long</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">||</span>\\n            <span class=\\\"token function\\\">doAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">,</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">doAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">long</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nanosTimeout <span class=\\\"token operator\\\">&lt;=</span> <span class=\\\"token number\\\">0</span>L<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">long</span> deadline <span class=\\\"token operator\\\">=</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">nanoTime</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> nanosTimeout<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">final</span> Node node <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node<span class=\\\"token punctuation\\\">.</span>SHARED<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">boolean</span> failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">final</span> Node p <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">predecessor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>p <span class=\\\"token operator\\\">==</span> head<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">int</span> r <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>r <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        <span class=\\\"token function\\\">setHeadAndPropagate</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">,</span> r<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                        p<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// help GC</span>\\n                        failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                nanosTimeout <span class=\\\"token operator\\\">=</span> deadline <span class=\\\"token operator\\\">-</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">nanoTime</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nanosTimeout <span class=\\\"token operator\\\">&lt;=</span> <span class=\\\"token number\\\">0</span>L<span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¦‚æœå·²ç»æ²¡æ—¶é—´äº†ï¼Œç›´æ¥return false</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">shouldParkAfterFailedAcquire</span><span class=\\\"token punctuation\\\">(</span>p<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                    nanosTimeout <span class=\\\"token operator\\\">></span> spinForTimeoutThreshold<span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//å¤§äºæŸä¸ªé˜ˆå€¼ï¼Œæ‰parkï¼Œå¦åˆ™è¿›å…¥è‡ªæ—‹</span>\\n                    LockSupport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">parkNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">,</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è°ƒç”¨å¸¦è¶…æ—¶çš„parkæ–¹æ³•</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>failed<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">cancelAcquire</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·Ÿä¸å¸¦è¶…æ—¶çš„doAcquireSharedInterruptiblyæ–¹æ³•ç›¸æ¯”ï¼ŒåŒºåˆ«ä¸»è¦åœ¨äºæ¯æ¬¡forå¾ªç¯æœŸé—´ï¼Œæ£€æŸ¥æ—¶é—´æ˜¯å¦è¿‡æœŸå’Œè°ƒç”¨å¸¦è¶…æ—¶çš„parkã€‚nanosTimeout > spinForTimeoutThresholdè¿™ä¸ªåˆ¤æ–­ä¸»è¦æ˜¯å› ä¸ºpark/unparkæœ¬èº«ä¹Ÿéœ€è¦èŠ±æ—¶é—´ï¼Œä¸ºäº†æ›´å‡†ç¡®åœ°å®Œæˆè¶…æ—¶çš„æœºåˆ¶ï¼Œåœ¨è¶…æ—¶æ—¶é—´é©¬ä¸Šå°±è¦åˆ°äº†çš„æ—¶å€™ï¼Œå°±è¿›å…¥è‡ªæ—‹ï¼Œä¸å†parkäº†ï¼Œè¿™åº”è¯¥æ˜¯Doug Leaæµ‹è¯•äº†park/unparkæ—¶é—´æ¯”1000çº³ç§’è¦é•¿å§ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token comment\\\">/**\\n     * The number of nanoseconds for which it is faster to spin\\n     * rather than to use timed park. A rough estimate suffices\\n     * to improve responsiveness with very short timeouts.\\n     */</span>\\n    <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">long</span> spinForTimeoutThreshold <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1000</span>L<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h1 id=\\\"æ€»ç»“\\\"><a href=\\\"#%E6%80%BB%E7%BB%93\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æ€»ç»“</h1>\\n<p>J.U.Cé‡ŒAQSæ˜¯ä¸€ä¸ªç›¸å½“æ ¸å¿ƒçš„ç±»ï¼Œå¯ä»¥è¯´æ²¡æœ‰å®ƒå°±æ²¡æœ‰J.U.CåŒ…ã€‚æ¨èå¤§å®¶çœ‹çœ‹<a href=\\\"http://gee.cs.oswego.edu/dl/papers/aqs.pdf\\\">AQS</a>è¿™ç¯‡è®ºæ–‡ï¼ˆç½‘ä¸Šæœ‰ä¸€äº›ç¿»è¯‘ï¼Œæ¨èå¤§å®¶è¿˜æ˜¯çœ‹åŸæ–‡å§ï¼‰ã€‚ä¸»è¦æ˜¯ç”¨ä¸€ä¸ªstateè¡¨ç¤ºçŠ¶æ€ï¼Œå­ç±»å¯ä»¥æ ¹æ®éœ€è¦æ¥å®šä¹‰stateçš„å«ä¹‰ï¼Œä»¥åŠè·å–é‡Šæ”¾èµ„æºæ—¶å…·ä½“å¦‚ä½•æ“ä½œstateï¼Œå½“ç„¶éœ€è¦é€šè¿‡CASå®ç°åŸå­æ›´æ”¹ã€‚å½“è·å–ä¸åˆ°stateçš„æ—¶å€™ï¼Œçº¿ç¨‹åŠ å…¥é˜Ÿåˆ—ï¼ŒæŒ‚èµ·ã€‚é‡Šæ”¾ä¹‹åï¼Œå”¤é†’é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ã€‚AQSæ”¯æŒä¸¤ç§æ¨¡å¼ï¼Œç‹¬å EXCLUSIVEå’Œå…±äº«SHAREDã€‚J.U.Cé‡Œæœ¬èº«ä¹Ÿæœ‰å¾ˆå¤šç›´æ¥ç»§æ‰¿AQSå®ç°çš„ç±»ï¼ŒåŒ…æ‹¬Lockï¼ŒCountDownLatchï¼ŒSemaphoreï¼ŒFutureTaskç­‰ï¼Œå¦‚æœè¿™äº›è¿˜ä¸èƒ½æ»¡è¶³ä½ çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ç»§æ‰¿AQSæ¥å®ç°éœ€è¦ã€‚</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://gee.cs.oswego.edu/dl/papers/aqs.pdf\\\">http://gee.cs.oswego.edu/dl/papers/aqs.pdf</a></li>\\n<li><a href=\\\"http://ifeve.com/introduce-abstractqueuedsynchronizer/\\\">http://ifeve.com/introduce-abstractqueuedsynchronizer/</a></li>\\n<li><a href=\\\"http://ifeve.com/jdk1-8-abstractqueuedsynchronizer/\\\">http://ifeve.com/jdk1-8-abstractqueuedsynchronizer/</a></li>\\n<li><a href=\\\"http://ifeve.com/jdk1-8-abstractqueuedsynchronizer-part2/\\\">http://ifeve.com/jdk1-8-abstractqueuedsynchronizer-part2/</a></li>\\n<li><a href=\\\"http://book.douban.com/subject/6522893/\\\">http://book.douban.com/subject/6522893/</a></li>\\n<li><a href=\\\"http://my.oschina.net/magicly007/blog/364102\\\">http://my.oschina.net/magicly007/blog/364102</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":9,\"excerpt\":\"java5ä¹‹åçš„java.util.concurrentåŒ…æ˜¯ä¸–ç•Œçº§å¹¶å‘å¤§å¸ˆDoug Leaçš„ä½œå“ï¼Œé‡Œé¢ä¸»è¦å®ç°äº† atomicåŒ…é‡ŒInteger/Longå¯¹åº”çš„åŸå­ç±»ï¼Œä¸»è¦åŸºäºCASï¼› ä¸€äº›åŒæ­¥å­ï¼ŒåŒ…æ‹¬Lockï¼ŒCountDownLatchï¼ŒSemaphoreâ€¦\",\"fields\":{\"slug\":\"/java-concurrrency-3-juc-source-code-read/\"},\"frontmatter\":{\"title\":\"Java Concurrencyï¼ˆä¸‰ï¼‰â€”â€”J.U.C AQSæºç è§£è¯»\",\"date\":\"2015-01-13\",\"category\":\"Java\",\"tags\":[\"Java\",\"concurrency\",\"jdk\",\"æºç é˜…è¯»\"]}}}]}},\"pathContext\":{\"current\":5,\"skip\":40,\"total\":6}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---page-5-f514c60eb5c029cd6f8d.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Magicly's Blog\"}},\"allMarkdownRemark\":{\"edges\":[{\"node\":{\"html\":\"<p>æœºå™¨å­¦ä¹ å·²ç»å½±å“äº†æˆ‘ä»¬ç”Ÿæ´»ä¸­çš„æ¯ä¸€ä¸ªåœ°æ–¹ï¼Œ äº†è§£ä¸€äº›æœºå™¨å­¦ä¹ çŸ¥è¯†ï¼Œ ä¾¿äºæé«˜ç«äº‰åŠ›ï¼Œ é¿å…è¢«æœºå™¨æ›¿ä»£ã€‚\\nä¸‹é¢æ˜¯æˆ‘å‚è€ƒå’¨è¯¢äº†å¾ˆå¤šå¤§ç‰›ä¹‹åæœé›†æ•´ç†çš„ä¸€äº›å­¦ä¹ èµ„æ–™ï¼Œ åŸºæœ¬éƒ½æ˜¯è¯¥é¢†åŸŸä¸–ç•Œæœ€é¡¶å°–çš„é«˜æ‰‹äº²è‡ªæˆè¯¾ï¼Œä»¥åŠä¸€äº›æœ€æµè¡Œçš„å·¥å…·åº“ï¼Œ å€¼å¾—å­¦ä¹ ã€‚</p>\\n<!-- more -->\\n<ul>\\n<li>å°æ¹¾å¤§å­¦æå®æ¯…è€å¸ˆçš„æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ è¯¾ç¨‹ï¼Œ<a href=\\\"http://speech.ee.ntu.edu.tw/~tlkagk/courses.html%EF%BC%8C\\\">http://speech.ee.ntu.edu.tw/~tlkagk/courses.htmlï¼Œ</a> bilibiliä¸Šæœ‰è§†é¢‘ï¼š<a href=\\\"https://www.bilibili.com/video/av10590361/\\\">https://www.bilibili.com/video/av10590361/</a> , <a href=\\\"https://www.bilibili.com/video/av9770302/\\\">https://www.bilibili.com/video/av9770302/</a> ã€‚ å¦å¤–æœ‰ä¸ªå¾ˆå¥½çš„pdfå¯ä»¥å¿«é€Ÿäº†è§£æœºå™¨å­¦ä¹ å†…å®¹ï¼š<a href=\\\"https://www.slideshare.net/tw_dsconf/ss-62245351\\\">https://www.slideshare.net/tw_dsconf/ss-62245351</a> </li>\\n<li>Fast.aiè¯¾ç¨‹ï¼Œ<a href=\\\"http://course.fast.ai/\\\">http://course.fast.ai/</a> ï¼Œ ä¸­æ–‡ç‰ˆ<a href=\\\"http://geek.ai100.com.cn/tag/fast-ai\\\">http://geek.ai100.com.cn/tag/fast-ai</a> ï¼Œå·²å®Œæˆï¼Œè¿™ä¸ªæ˜¯æˆ‘ç›®å‰è§‰å¾—æœ€å¥½çš„è¯¾ç¨‹ã€‚</li>\\n<li>Andrew NG <a href=\\\"https://www.coursera.org/learn/machine-learning\\\">https://www.coursera.org/learn/machine-learning</a> ï¼ˆå·²å®Œæˆï¼‰</li>\\n<li>Andrew NG Unsupervised Feature Learning and Deep Learning <a href=\\\"http://deeplearning.stanford.edu/tutorial/\\\">http://deeplearning.stanford.edu/tutorial/</a> ï¼ˆå­¦ä¹ ingï¼‰</li>\\n<li><a href=\\\"http://neuralnetworksanddeeplearning.com/\\\">http://neuralnetworksanddeeplearning.com/</a> ï¼ˆå·²å®Œæˆï¼‰</li>\\n<li>Andrew NG, standfordçš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ä¹‹ä¸€ï¼Œ <a href=\\\"http://cs229.stanford.edu/\\\">http://cs229.stanford.edu/</a></li>\\n<li>Neural Networks for Machine Learning <a href=\\\"https://www.coursera.org/learn/neural-networks\\\">https://www.coursera.org/learn/neural-networks</a> by Geoffrey Hinton, Professor(æ·±åº¦å­¦ä¹ åˆ›å§‹äºº) ï¼ˆå­¦ä¹ ä¸­ï¼‰ï¼Œæœ‰ç‚¹åæ‚”ï¼Œ è¿™ä¸ªè¯¾ç¨‹å¹¶ä¸æ˜¯é€‚åˆåˆå­¦è€…ã€‚å‚è€ƒ<a href=\\\"https://www.quora.com/Is-it-wise-to-learn-deep-learning-from-Hintons-course-on-Coursera\\\">è¿™é‡Œ</a></li>\\n<li>æé£é£è¯¾ç¨‹<a href=\\\"http://cs231n.github.io/\\\">http://cs231n.github.io/</a></li>\\n<li>æ–¯å¦ç¦è‡ªç„¶è¯­è¨€å¤„ç† <a href=\\\"http://web.stanford.edu/class/cs224n/\\\">http://web.stanford.edu/class/cs224n/</a></li>\\n<li>Tensorflow for Deep Learning Research <a href=\\\"http://web.stanford.edu/class/cs20si/\\\">http://web.stanford.edu/class/cs20si/</a></li>\\n<li>ä¼¯å…‹åˆ©äººå·¥æ™ºèƒ½è¯¾ç¨‹ <a href=\\\"http://www-inst.eecs.berkeley.edu/~cs188/archives.html\\\">http://www-inst.eecs.berkeley.edu/~cs188/archives.html</a></li>\\n<li><a href=\\\"http://www.deeplearningbook.org/\\\">http://www.deeplearningbook.org/</a>, by Ian Goodfellow and Yoshua Bengioï¼ˆæ·±åº¦å­¦ä¹ å››å¤§é‡‘åˆšä¹‹ä¸€ï¼‰ and Aaron Courville</li>\\n<li>udacityæ·±åº¦å­¦ä¹ è¯¾ç¨‹tensorflow <a href=\\\"https://classroom.udacity.com/courses/ud730/\\\">https://classroom.udacity.com/courses/ud730/</a> ï¼ˆå·²å®Œæˆï¼‰</li>\\n<li><a href=\\\"https://keras.io\\\">https://keras.io</a></li>\\n<li><a href=\\\"https://scikit-learn.org\\\">https://scikit-learn.org</a></li>\\n<li><a href=\\\"https://www.tensorflow.org\\\">https://www.tensorflow.org</a></li>\\n<li><a href=\\\"http://deeplearning.net/\\\">http://deeplearning.net/</a></li>\\n<li><a href=\\\"https://www.kaggle.com\\\">https://www.kaggle.com</a></li>\\n</ul>\",\"timeToRead\":2,\"excerpt\":\"â€¦\",\"fields\":{\"slug\":\"/ml-content/\"},\"frontmatter\":{\"title\":\"æœºå™¨å­¦ä¹ è®¡åˆ’\",\"date\":\"2017-02-12\",\"category\":\"ML\",\"tags\":[\"AI\",\"ML\",\"machine learning\",\"deep learning\",\"æ·±åº¦å­¦ä¹ \"]}}},{\"node\":{\"html\":\"<h1 id=\\\"ä»€ä¹ˆæ˜¯è´å¡å°”æ›²çº¿\\\"><a href=\\\"#%E4%BB%80%E4%B9%88%E6%98%AF%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ä»€ä¹ˆæ˜¯è´å¡å°”æ›²çº¿</h1>\\n<p>æœ€è¿‘åšä¸€ä¸ªåŠ¨ç”»æ•ˆæœæ—¶éœ€è¦å°†ç‰©ä½“åšæ›²çº¿ç§»åŠ¨ï¼Œ æœ¬æ¥è®°å¾—css3é‡Œçš„åŠ¨ç”»æ˜¯å¯ä»¥æŒ‡å®šbeizer curveçš„ï¼Œ ç»“æœç”¨çš„æ—¶å€™å‘ç°css3çš„beizer curveåªç”¨æ¥åšeasing timing functionã€‚ç®€å•æ¥è¯´å°±æ˜¯æ‹¿æ¥æ§åˆ¶åŠ¨ç”»â€œéçº¿æ€§â€ç§»åŠ¨ï¼Œæ¯”å¦‚è¶Šæ¥è¶Šå¿«ï¼ˆease-inï¼‰ï¼Œ è¶Šæ¥è¶Šæ…¢ï¼ˆease-outï¼‰ï¼Œå…ˆæ…¢åå¿«å†æ…¢ï¼ˆease-in-outï¼‰ç­‰ï¼Œ è®©åŠ¨ç”»æ•ˆæœæ›´â€œçµåŠ¨â€ï¼Œ é¿å…çº¿æ€§ï¼ˆlinearï¼‰çš„æ­»æ¿ã€‚</p>\\n<p>å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªé¡µé¢ï¼Œ æœ‰ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ã€‚</p>\\n<!-- more -->\\n<ul>\\n<li><a href=\\\"http://cubic-bezier.com/\\\">http://cubic-bezier.com/</a></li>\\n<li><a href=\\\"http://easings.net/zh-cn\\\">http://easings.net/zh-cn</a></li>\\n</ul>\\n<p>beizer curveåœ¨css3ä¸­çš„ä½¿ç”¨ï¼Œ å¯ä»¥è‡ªå·±googleä¸€ä¸‹ï¼Œ æˆ–è€…çœ‹ä¸‹ï¼š</p>\\n<ul>\\n<li><a href=\\\"http://www.w3school.com.cn/css3/css3_transition.asp\\\">http://www.w3school.com.cn/css3/css3_transition.asp</a></li>\\n<li><a href=\\\"http://www.ruanyifeng.com/blog/2014/02/css_transition_and_animation.html\\\">http://www.ruanyifeng.com/blog/2014/02/css<em>transition</em>and_animation.html</a></li>\\n</ul>\\n<p>å¼•ç”¨wikiä¸Šçš„ä»‹ç»ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">    åœ¨æ•°å­¦çš„æ•°å€¼åˆ†æé¢†åŸŸä¸­ï¼Œè´å¡å°”æ›²çº¿ï¼ˆè‹±è¯­ï¼šBÃ©zier curveï¼‰æ˜¯è®¡ç®—æœºå›¾å½¢å­¦ä¸­ç›¸å½“é‡è¦çš„å‚æ•°æ›²çº¿ã€‚æ›´é«˜ç»´åº¦çš„å¹¿æ³›åŒ–è´å¡å°”æ›²çº¿å°±ç§°ä½œè´å¡å°”æ›²é¢ï¼Œå…¶ä¸­è´å¡å°”ä¸‰è§’æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®ä¾‹ã€‚\\n    è´å¡å°”æ›²çº¿äº1962å¹´ï¼Œç”±æ³•å›½å·¥ç¨‹å¸ˆçš®åŸƒå°”Â·è´å¡å°”ï¼ˆPierre BÃ©zierï¼‰æ‰€å¹¿æ³›å‘è¡¨ï¼Œä»–è¿ç”¨è´å¡å°”æ›²çº¿æ¥ä¸ºæ±½è½¦çš„ä¸»ä½“è¿›è¡Œè®¾è®¡ã€‚è´å¡å°”æ›²çº¿æœ€åˆç”±Paul de Casteljauäº1959å¹´è¿ç”¨de Casteljauç®—æ³•å¼€å‘ï¼Œä»¥ç¨³å®šæ•°å€¼çš„æ–¹æ³•æ±‚å‡ºè´å¡å°”æ›²çº¿ã€‚</code></pre>\\n      </div>\\n<p>æœ‰æ•°å­¦åŠŸåº•æˆ–è€…æœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒä¸‹é¢å‡ ç¯‡æ–‡ç« ï¼Œ æˆ‘å°±ä¸èµ˜è¿°äº†ï¼ˆæœ€è®¨åŒé‚£ç§ä»€ä¹ˆéƒ½è¦copyè¿‡æ¥ï¼Œå¼„å¾—å¥½åƒè·Ÿæ˜¯è‡ªå·±å†™çš„æ ·ï¼Œ åˆ«äººå·²ç»å†™å¾—å¾ˆæ¸…æ¥šäº†ï¼Œ å¹²å˜›å†é‡å¤åŠ³åŠ¨ä¸€éå‘¢ï¼Œ åˆæ²¡æœ‰è‡ªå·±çš„æ–°çš„è§è§£ï¼Œèµ äººé“¾æ¥ï¼Œ æ‰‹ç•™ä½™é¦™ã€‚ ğŸ˜å“ˆï¼‰ã€‚</p>\\n<ul>\\n<li><a href=\\\"https://en.wikipedia.org/wiki/B%C3%A9zier_curve\\\">https://en.wikipedia.org/wiki/B%C3%A9zier_curve</a></li>\\n<li><a href=\\\"https://zh.wikipedia.org/wiki/%E8%B2%9D%E8%8C%B2%E6%9B%B2%E7%B7%9A\\\">https://zh.wikipedia.org/wiki/%E8%B2%9D%E8%8C%B2%E6%9B%B2%E7%B7%9A</a></li>\\n<li><a href=\\\"http://www.html-js.com/article/1628\\\">http://www.html-js.com/article/1628</a></li>\\n<li><a href=\\\"http://www.cnblogs.com/hnfxs/p/3148483.html\\\">http://www.cnblogs.com/hnfxs/p/3148483.html</a></li>\\n<li></li>\\n</ul>\\n<h1 id=\\\"åœ¨çº¿å·¥å…·\\\"><a href=\\\"#%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>åœ¨çº¿å·¥å…·</h1>\\n<p>ä¸‹é¢æ˜¯å‡ ä¸ªæ¯”è¾ƒæœ‰ç”¨çš„å·¥å…·ï¼Œ æ–¹ä¾¿å¤§å®¶ã€‚</p>\\n<ul>\\n<li><a href=\\\"http://blogs.sitepointstatic.com/examples/tech/canvas-curves/quadratic-curve.html\\\">http://blogs.sitepointstatic.com/examples/tech/canvas-curves/quadratic-curve.html</a></li>\\n<li><a href=\\\"http://myst729.github.io/bezier-curve/\\\">http://myst729.github.io/bezier-curve/</a></li>\\n<li><a href=\\\"http://xuanfengge.com/easeing/ceaser/\\\">http://xuanfengge.com/easeing/ceaser/</a></li>\\n<li><a href=\\\"http://yisibl.github.io/cubic-bezier/#.17,.67,.83,.67\\\">http://yisibl.github.io/cubic-bezier/#.17,.67,.83,.67</a></li>\\n<li><a href=\\\"http://cubic-bezier.com/#.17,.67,.83,.67\\\">http://cubic-bezier.com/#.17,.67,.83,.67</a></li>\\n</ul>\\n<h1 id=\\\"å®ç°\\\"><a href=\\\"#%E5%AE%9E%E7%8E%B0\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å®ç°</h1>\\n<p>å‰é¢èµ„æ–™éƒ½æ˜¯æŠŠbezier curveæ‹¿æ¥å½“timing functionçš„ï¼Œ è€Œæˆ‘çš„éœ€æ±‚æ˜¯è¦è®©ç‰©ä½“ï¼ˆæŸä¸ªdomèŠ‚ç‚¹ï¼‰æ²¿ç€æŸæ¡beizer curveç§»åŠ¨ï¼Œäºæ˜¯ç»§ç»­googleï¼Œ æ‰¾åˆ°äº†å‡ ä¸ªã€‚</p>\\n<ul>\\n<li>Androidå®ç°: <a href=\\\"https://github.com/Yasic/QQBubbleView\\\">https://github.com/Yasic/QQBubbleView</a></li>\\n</ul>\\n<p>Androidçš„æˆ‘ç”¨ä¸åˆ°ï¼Œ æ”¾è¿™é‡Œä¸»è¦æ˜¯é‡Œé¢çš„gifå›¾å¾ˆç›´è§‚ï¼Œå“ˆå“ˆã€‚</p>\\n<ul>\\n<li>CSSå®ç°ï¼š<a href=\\\"http://jinlong.github.io/2016/01/14/moving-along-a-curved-path-in-css-with-layered-animation/%EF%BC%8C\\\">http://jinlong.github.io/2016/01/14/moving-along-a-curved-path-in-css-with-layered-animation/ï¼Œ</a> åŸæ–‡ï¼š<a href=\\\"http://tobiasahlin.com/blog/curved-path-animations-in-css/\\\">http://tobiasahlin.com/blog/curved-path-animations-in-css/</a></li>\\n</ul>\\n<p>CSSçš„å®ç°çœŸæ˜¯ç›¸å½“trickyï¼Œ æˆ‘è§£é‡Šä¸€ä¸‹ã€‚CSSé‡Œé¢çš„animation translateæ˜¯ç›´æ¥æŒ‰ç…§ç›´çº¿ç§»åŠ¨åˆ°ç›®çš„åœ°çš„ï¼Œ è¿™æ˜¯å› ä¸ºæ²¿Xè½´å’ŒYè½´éƒ½æ˜¯åŒ€é€Ÿè¿åŠ¨ï¼ˆlinearï¼‰ï¼Œæ‰€ä»¥åˆæˆä¹‹åçš„é€Ÿåº¦å¿…ç„¶æ˜¯æ–œè§’45Â°ç§»åŠ¨è¿‡å»çš„ã€‚æˆ‘ä»¬å¯ä»¥æŠŠXè½´çœ‹æˆæ—¶é—´è½´ï¼Œ è¿™æ—¶å¦‚æœYè½´çš„ç§»åŠ¨å‡½æ•°æ˜¯æŸä¸ªbeizer curveï¼Œé‚£åˆæˆä¹‹åçš„ç§»åŠ¨æ›²çº¿å°±æ˜¯beizer curveäº†ã€‚å…·ä½“å®ç°çš„æ—¶å€™è¿˜ç”¨åˆ°äº†:afterä¼ªå…ƒç´ äº†ã€‚</p>\\n<p>å¤æ‚ä¸€ç‚¹çš„æˆ‘è§‰å¾—è¿˜æ˜¯éœ€è¦ç”¨jså»æ§åˆ¶ï¼Œ äºæ˜¯è‡ªç„¶æƒ³åˆ°äº†ç”¨jsä»£ç å»æŒ‰ç…§beizer curveå…¬å¼å®ç°ã€‚</p>\\n<ul>\\n<li>JSå®ç°ï¼š <a href=\\\"http://blog.csdn.net/cuixiping/article/details/6872095\\\">http://blog.csdn.net/cuixiping/article/details/6872095</a></li>\\n</ul>\\n<p>è¿™ä¸ªç”¨çš„å…¬å¼ä¸ç›´è§‚ï¼Œåº”è¯¥æ˜¯è¿›è¡Œäº†å˜æ¢ä¹‹åçš„ï¼Œ æˆ‘ç›´æ¥ç…§ç€å…¬å¼å†™äº†ä¸€ä¸ªã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"gatsby-highlight-code-line\\\"><span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">PointOnCubicBezier2</span><span class=\\\"token punctuation\\\">(</span>cp<span class=\\\"token punctuation\\\">,</span> t<span class=\\\"token punctuation\\\">)</span>  <span class=\\\"token punctuation\\\">{</span>\\n</span><span class=\\\"gatsby-highlight-code-line\\\">   <span class=\\\"token comment\\\">// B(t) = P0 * (1-t)^3 + 3 * P1 * t * (1-t)^2 + 3 * P2 * t^2 * (1-t) + P3 * t^3</span>\\n</span>        <span class=\\\"token keyword\\\">const</span> one_t <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1.0</span> <span class=\\\"token operator\\\">-</span> t<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P0</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P1</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P2</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> <span class=\\\"token constant\\\">P3</span> <span class=\\\"token operator\\\">=</span> cp<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> x <span class=\\\"token operator\\\">=</span>  <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">P0</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P1</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> t <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P2</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">*</span> one_t <span class=\\\"token operator\\\">+</span> <span class=\\\"token constant\\\">P3</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> y <span class=\\\"token operator\\\">=</span>  <span class=\\\"token punctuation\\\">(</span><span class=\\\"token constant\\\">P0</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P1</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> t <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>one_t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">3</span> <span class=\\\"token operator\\\">*</span> <span class=\\\"token constant\\\">P2</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">*</span> one_t <span class=\\\"token operator\\\">+</span> <span class=\\\"token constant\\\">P3</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">*</span> Math<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pow</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">const</span> pointF <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Point2D</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> pointF<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¯¹æ¯”äº†ä¸€ä¸‹ä¸¤ä¸ªå‡½æ•°çš„è¾“å‡ºå€¼ï¼Œ å®Œå…¨æ˜¯ä¸€æ ·çš„ï¼Œ åº”è¯¥å°±æ˜¯æ•°å­¦å˜æ¢è€Œå·²ï¼Œ æˆ‘æ‡’å¾—å»åšæ¨å€’äº†ã€‚</p>\\n<p>åæ¥æ‰¾åˆ°ä¸€ä¸ªä¸‰é˜¶beizer curveçš„å®ç°ï¼Œçœ‹è¿™é‡Œ\\n<a href=\\\"https://github.com/gre/bezier-easing%EF%BC%8C\\\">https://github.com/gre/bezier-easingï¼Œ</a> è¿™ä¸ªå®ç°å¯èƒ½æœ‰ç‚¹NBï¼Œä»¥è‡³äº<a href=\\\"https://facebook.github.io/react-native/\\\">React Native</a>ã€<a href=\\\"http://velocityjs.org/\\\">Velocity</a>ç­‰é¡¹ç›®éƒ½ä½¿ç”¨äº†ï¼Œå±Œå±Œçš„ã€‚</p>\\n<p>ç”¨<a href=\\\"https://github.com/bestiejs/benchmark.js\\\">benchmark</a>è·‘ä¸€ä¸‹åˆ†ï¼š<a href=\\\"https://jsperf.com/beizer-curve5\\\">çœ‹è¿™é‡Œ</a>ï¼Œ chromeä¸‹æˆ‘å†™çš„æ–¹æ³•å±…ç„¶æ…¢äº†94%ï¼çœ‹æ ·å­ä»£ç å¯è¯»æ€§æ˜¯è¦ä»˜å‡ºä»£ä»·çš„å“ˆã€‚æˆ‘è¿˜æ˜¯è€è€å®å®ç”¨<a href=\\\"https://github.com/gre/bezier-easing%E5%90%A7%E3%80%82\\\">https://github.com/gre/bezier-easingå§ã€‚</a></p>\\n<p>åˆšåˆšåˆæœåˆ°ä¸€ç¯‡æ–‡ç« ï¼Œ è®²è§£åœ°æ›´ç»†è‡´æ·±å…¥ï¼Œ å®³å¾—æˆ‘ä¸æƒ³ç»§ç»­å†™äº†ã€‚ ç›´æ¥çœ‹è¿™é‡Œå§ã€‚<a href=\\\"http://www.jianshu.com/p/55c721887568\\\">http://www.jianshu.com/p/55c721887568</a></p>\\n<h1 id=\\\"å¦‚ä½•å°†å¤šä¸ªç‚¹ç”¨è´å¡å°”æ›²çº¿è¿èµ·æ¥\\\"><a href=\\\"#%E5%A6%82%E4%BD%95%E5%B0%86%E5%A4%9A%E4%B8%AA%E7%82%B9%E7%94%A8%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF%E8%BF%9E%E8%B5%B7%E6%9D%A5\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å¦‚ä½•å°†å¤šä¸ªç‚¹ç”¨è´å¡å°”æ›²çº¿è¿èµ·æ¥</h1>\\n<ul>\\n<li><a href=\\\"http://www.zheng-hang.com/?id=43\\\">http://www.zheng-hang.com/?id=43</a></li>\\n<li><a href=\\\"http://www.cnblogs.com/hnfxs/p/3148743.html\\\">http://www.cnblogs.com/hnfxs/p/3148743.html</a></li>\\n</ul>\",\"timeToRead\":4,\"excerpt\":\"ä»€ä¹ˆæ˜¯è´å¡å°”æ›²çº¿ æœ€è¿‘åšä¸€ä¸ªåŠ¨ç”»æ•ˆæœæ—¶éœ€è¦å°†ç‰©ä½“åšæ›²çº¿ç§»åŠ¨ï¼Œ æœ¬æ¥è®°å¾—css3é‡Œçš„åŠ¨ç”»æ˜¯å¯ä»¥æŒ‡å®šbeizer curveçš„ï¼Œ ç»“æœç”¨çš„æ—¶å€™å‘ç°css3çš„beizer curveåªç”¨æ¥åšeasing timing functionâ€¦\",\"fields\":{\"slug\":\"/bezier-curve/\"},\"frontmatter\":{\"title\":\"bezier-curve\",\"date\":\"2016-11-29\",\"category\":\"FE\",\"tags\":[\"js\",\"css\",\"animation\",\"beizer curve\"]}}},{\"node\":{\"html\":\"<p>ç”¨äº†ä¸€å¹´å¤šçš„<a href=\\\"https://facebook.github.io/react/\\\">React</a>ï¼ŒçœŸæ˜¯çˆ½çš„ä¸è¦ä¸è¦çš„ï¼Œ è°ç”¨è°çŸ¥é“ï¼Œ ä¸€èˆ¬äººæˆ‘ä¸å‘Šè¯‰ä»–ï¼</p>\\n<p>æœ€è¿‘ç”¨çš„è¿‡ç¨‹ä¸­å‘ç°consoleé‡Œé¢æ€»æ˜¯å‡ºç°è¿™æ ·çš„è­¦å‘Š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">react.js:20478 Warning: setState(...): Can only update a mounted or mounting component. This usually means you called setState() on an unmounted component. This is a no-op. Please check the code for the Small component.</code></pre>\\n      </div>\\n<p>è™½ä¸å½±å“ä½¿ç”¨ï¼Œ ä½†æ˜¯å¯¹äºä¸€ä¸ªæœ‰ä»£ç æ´ç™–çš„æœ‰è¿½æ±‚çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œ æ€ä¹ˆå—å¾—äº†å‘¢ï¼</p>\\n<p>reactçš„erroræˆ–è€…warningä¿¡æ¯è¿˜æ˜¯å†™å¾—æ¯”è¾ƒå¥½çš„ï¼Œ ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºåŸå› æ˜¯æˆ‘ä»¬åœ¨ä¸€ä¸ªunmountedçš„componentä¸Šè°ƒç”¨setStateæ–¹æ³•ã€‚åˆ†æä¸šåŠ¡ä»£ç ï¼Œ å‘ç°æ˜¯æŸä¸ªå¼¹çª—componentéœ€è¦ä»serveråŠ è½½æ•°æ®ï¼Œ æœ‰æ—¶å€™ç½‘ç»œæ…¢ï¼Œ è¿˜æ²¡æœ‰åŠ è½½å‡ºæ¥ç”¨æˆ·å°±æŠŠå¼¹çª—å…³äº†ï¼Œ æ‰€ä»¥å¯¹åº”çš„componentå˜æˆäº†unmountedï¼Œ ç­‰åˆ°fetchè¯·æ±‚æˆåŠŸä¹‹åï¼Œ å†è°ƒç”¨setStateå°±warningäº†ã€‚</p>\\n<p>ä¸ºäº†æ–¹ä¾¿åˆ†æé—®é¢˜ï¼Œ æˆ‘æŠŠé—®é¢˜ç®€åŒ–äº†ï¼Œ åŒæ—¶ä¸ºäº†ç”¨æˆ·ç›´æ¥èƒ½åœ¨æµè§ˆå™¨æ‰“å¼€çœ‹åˆ°æ•ˆæœï¼Œ è€Œä¸ç”¨nodejsã€npmã€babelã€webpackã€reactç­‰ä¸€å †ä¸œè¥¿installåŠå¤©ï¼Œ æˆ‘ç›´æ¥å¼•ç”¨äº†react cdnä¸Šçš„æ–‡ä»¶ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token doctype\\\">&lt;!DOCTYPE html></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>meta</span> <span class=\\\"token attr-name\\\">charset</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>UTF-8<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>title</span><span class=\\\"token punctuation\\\">></span></span>Hello World<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>title</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react@latest/dist/react.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react-dom@latest/dist/react-dom.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/babel-standalone@6.15.0/babel.min.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text/babel<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\">\\n\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Big</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function-variable function\\\">closeSmall</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'closeSmall'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Big Component <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h2 onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>closeSmall<span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">></span>close small <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h2<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>small <span class=\\\"token operator\\\">?</span> <span class=\\\"token operator\\\">&lt;</span>Small <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Small</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'init data'</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">componentDidMount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'componentDidMount'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token function\\\">setTimeout</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fetch data from server succeed...'</span><span class=\\\"token punctuation\\\">)</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`this._isMounted: </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">`</span></span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'data from server'</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Small Component <span class=\\\"token operator\\\">...</span>  <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n      ReactDOM<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>Big <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n        document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    </span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>ä»£ç é‡Œé¢ç”¨setTimeoutæ¨¡æ‹Ÿäº†ä»serverè·å–æ•°æ®ï¼Œ å¤§å®¶å¦‚æœåœ¨5så†…ç‚¹å‡»close smallï¼Œ å°±å¯ä»¥é‡ç°è¿™ä¸ªé—®é¢˜ã€‚</p>\\n<p>é—®é¢˜çš„è§£å†³æ–¹æ³•å¾ˆè‡ªç„¶åœ°æƒ³åˆ°ï¼Œå¦‚æœå¯ä»¥åœ¨setStateä¹‹å‰æ£€æŸ¥ä¸€ä¸‹this componentæ˜¯å¦è¿˜æ˜¯mountedçŠ¶æ€å°±å¯ä»¥äº†ã€‚æŸ¥reactçš„æ–‡æ¡£ï¼Œå‘ç°åŸæ¥ä¹‹å‰ç¡®å®æ˜¯æœ‰isMounted()è¿™ä¸ªæ–¹æ³•çš„ï¼Œ ä¸è¿‡å·²ç»ä¸æ¨èä½¿ç”¨äº†ï¼Œ å› ä¸º<a href=\\\"https://facebook.github.io/react/blog/2015/12/16/ismounted-antipattern.html\\\">isMounted is an Antipattern</a>ã€‚</p>\\n<p>ç¬¬ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯è‡ªå·±æ¨¡æ‹Ÿå®ç°isMountedè¿™ä¸ªæ–¹æ³•ï¼Œ è™½ç„¶å·²ç»è¢«è´´ä¸ŠAntipatternçš„æ ‡ç­¾ï¼Œ ä½†æ˜¯æœ‰äº›æ—¶å€™ç”¨è¿™ç§æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token doctype\\\">&lt;!DOCTYPE html></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>meta</span> <span class=\\\"token attr-name\\\">charset</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>UTF-8<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>title</span><span class=\\\"token punctuation\\\">></span></span>Hello World<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>title</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react@latest/dist/react.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react-dom@latest/dist/react-dom.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/babel-standalone@6.15.0/babel.min.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text/babel<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\">\\n\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Big</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function-variable function\\\">closeSmall</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'closeSmall'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Big Component <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h2 onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>closeSmall<span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">></span>close small <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h2<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>small <span class=\\\"token operator\\\">?</span> <span class=\\\"token operator\\\">&lt;</span>Small <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Small</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'init data'</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">componentDidMount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'componentDidMount'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token function\\\">setTimeout</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fetch data from server succeed...'</span><span class=\\\"token punctuation\\\">)</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`this._isMounted: </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">`</span></span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n          <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'data from server'</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">componentWillUnmount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>_isMounted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Small Component <span class=\\\"token operator\\\">...</span>  <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n        data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n      ReactDOM<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>Big <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n        document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    </span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>å¯¹äºcallbackç°åœ¨å·²ç»æœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œ ä¼Ÿå¤§çš„<a href=\\\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\\\">Promise</a>ï¼å¦‚æœè¿™ä¸ªpromiseèƒ½åœ¨componentWillUnmount()çš„æ—¶å€™cancelæ‰å°±å®Œç¾äº†ã€‚å¯æƒœgoogleä¹‹åå‘ç°å®˜æ–¹Promiseå®ç°ç›®å‰å¹¶ä¸æ”¯æŒcancelï¼<a href=\\\"http://stackoverflow.com/questions/29478751/how-to-cancel-an-emcascript6-vanilla-javascript-promise-chain\\\">çœ‹è¿™é‡Œ</a>ï¼Œ è¿˜æœ‰<a href=\\\"http://stackoverflow.com/questions/30233302/promise-is-it-possible-to-force-cancel-a-promise\\\">è¿™é‡Œ</a>ï¼Œæ‰€ä»¥é™¤éä½ ä½¿ç”¨ç¬¬ä¸‰æ–¹Promiseåº“ï¼Œ æ¯”å¦‚æ®è¯´æ€§èƒ½æ¯”åŸç”Ÿè¿˜å¥½çš„<a href=\\\"http://bluebirdjs.com/docs/api/cancellation.html\\\">Bluebird</a>ã€‚</p>\\n<p>å½“ç„¶æœ‰äº›æ—¶å€™æ²¡å¿…è¦æè¿™ä¹ˆå¤æ‚ï¼Œ facebookçš„<a href=\\\"https://facebook.github.io/react/blog/2015/12/16/ismounted-antipattern.html\\\">æ–‡æ¡£</a>ç»™äº†ä¸€ä¸ªç®€æ˜“çš„cancelableçš„Promiseã€‚æœ€å¥½ä»£ç å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\"><span class=\\\"token doctype\\\">&lt;!DOCTYPE html></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>html</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>meta</span> <span class=\\\"token attr-name\\\">charset</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>UTF-8<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>title</span><span class=\\\"token punctuation\\\">></span></span>Hello World<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>title</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react@latest/dist/react.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/react-dom@latest/dist/react-dom.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>https://unpkg.com/babel-standalone@6.15.0/babel.min.js<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\"></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>head</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>script</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text/babel<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token script language-javascript\\\">\\n\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Big</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n      small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function-variable function\\\">closeSmall</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'closeSmall'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> small<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Component <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token operator\\\">&lt;</span>h2 onClick<span class=\\\"token operator\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>closeSmall<span class=\\\"token punctuation\\\">}</span><span class=\\\"token operator\\\">></span>close small <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h2<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>small <span class=\\\"token operator\\\">?</span> <span class=\\\"token operator\\\">&lt;</span>Small <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Small</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">React<span class=\\\"token punctuation\\\">.</span>Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">constructor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">super</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n      data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'init data'</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">componentDidMount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'componentDidMount'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>cancelablePromise <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">makeCancelable</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Promise</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>resolve<span class=\\\"token punctuation\\\">,</span> reject<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token function\\\">setTimeout</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'fetch data from server succeed...'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'data from server'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>cancelablePromise\\n      <span class=\\\"token punctuation\\\">.</span>promise\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span>data <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n        console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'resolved: '</span><span class=\\\"token punctuation\\\">,</span> data<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> data <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span>reason <span class=\\\"token operator\\\">=></span> console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>reason<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">' isCanceled'</span><span class=\\\"token punctuation\\\">,</span> reason<span class=\\\"token punctuation\\\">.</span>isCanceled<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">componentWillUnmount</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>cancelablePromise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">cancel</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">// Cancel the promise</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token operator\\\">&lt;</span>div<span class=\\\"token operator\\\">></span>\\n      <span class=\\\"token operator\\\">&lt;</span>h1<span class=\\\"token operator\\\">></span>hello <span class=\\\"token keyword\\\">from</span> Small Component <span class=\\\"token operator\\\">...</span>  <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>h1<span class=\\\"token operator\\\">></span>\\n      data<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>state<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">const</span> <span class=\\\"token function-variable function\\\">makeCancelable</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">(</span>promise<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">let</span> hasCanceled_ <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">const</span> wrappedPromise <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Promise</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>resolve<span class=\\\"token punctuation\\\">,</span> reject<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>val<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span>\\n      hasCanceled_ <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">reject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> isCanceled<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span>val<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span>\\n      hasCanceled_ <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">reject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> isCanceled<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">:</span> <span class=\\\"token function\\\">reject</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">{</span>\\n    promise<span class=\\\"token punctuation\\\">:</span> wrappedPromise<span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token function\\\">cancel</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      hasCanceled_ <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n      ReactDOM<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token operator\\\">&lt;</span>Big <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n        document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'root'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    </span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>script</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>body</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>html</span><span class=\\\"token punctuation\\\">></span></span></code></pre>\\n      </div>\\n<p>well, itâ€™s ok now!</p>\",\"timeToRead\":4,\"excerpt\":\"ç”¨äº†ä¸€å¹´å¤šçš„ React ï¼ŒçœŸæ˜¯çˆ½çš„ä¸è¦ä¸è¦çš„ï¼Œ è°ç”¨è°çŸ¥é“ï¼Œ ä¸€èˆ¬äººæˆ‘ä¸å‘Šè¯‰ä»–ï¼ æœ€è¿‘ç”¨çš„è¿‡ç¨‹ä¸­å‘ç°consoleé‡Œé¢æ€»æ˜¯å‡ºç°è¿™æ ·çš„è­¦å‘Š è™½ä¸å½±å“ä½¿ç”¨ï¼Œ ä½†æ˜¯å¯¹äºä¸€ä¸ªæœ‰ä»£ç æ´ç™–çš„æœ‰è¿½æ±‚çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œ æ€ä¹ˆå—å¾—äº†å‘¢ï¼ reactçš„erroræˆ–è€…warningâ€¦\",\"fields\":{\"slug\":\"/react-ismounted-is-an-antipattern/\"},\"frontmatter\":{\"title\":\"reactç³»åˆ—ä¹‹isMounted is an Antipattern\",\"date\":\"2016-11-19\",\"category\":\"FE\",\"tags\":[\"react\"]}}},{\"node\":{\"html\":\"<p><a href=\\\"http://blog.coderzh.com/2015/09/13/use-webhook-automated-deploy-hugo/?hmsr=toutiao.io&#x26;utm_medium=toutiao.io&#x26;utm_source=toutiao.io\\\">http://blog.coderzh.com/2015/09/13/use-webhook-automated-deploy-hugo/?hmsr=toutiao.io&#x26;utm<em>medium=toutiao.io&#x26;utm</em>source=toutiao.io</a></p>\\n<p>â€¦</p>\",\"timeToRead\":1,\"excerpt\":\"http://blog.coderzh.com/2015/09/13/use-webhook-automated-deploy-hugo/?hmsr=toutiao.io&utm medium=toutiao.io&utm source=toutiao.io â€¦\",\"fields\":{\"slug\":\"/auto-deploy-githubPages-by-webhook-md/\"},\"frontmatter\":{\"title\":\"åˆ©ç”¨webhookå®ç°github pagesçš„è‡ªåŠ¨éƒ¨ç½²\",\"date\":\"2015-09-16\",\"category\":\"default\",\"tags\":[\"github\",\"webhook\",\"ssh\"]}}},{\"node\":{\"html\":\"<p>javascript es6 arrow function.</p>\\n<!-- more -->\\n<p>å¼€å§‹å­¦ä¹ ES6.\\n<a href=\\\"https://hacks.mozilla.org/category/es6-in-depth/\\\">https://hacks.mozilla.org/category/es6-in-depth/</a></p>\",\"timeToRead\":1,\"excerpt\":\"javascript es6 arrow function. å¼€å§‹å­¦ä¹ ES6.\\n https://hacks.mozilla.org/category/es6-in-depth/\",\"fields\":{\"slug\":\"/js-arrow-functions-md/\"},\"frontmatter\":{\"title\":\"javascriptç®­å¤´å‡½æ•°\",\"date\":\"2015-09-07\",\"category\":\"JS\",\"tags\":[\"js\",\"javascript\",\"es6\"]}}},{\"node\":{\"html\":\"<p>å¾®ä¿¡å…¬å…±å·ç°åœ¨å¾ˆç«ï¼Œä¸€äº›ç®€å•çš„åº”ç”¨ï¼Œåšä¸€ä¸ªå…¬å…±å·æ¯”å¼€å‘ä¸€æ¬¾appæˆæœ¬è¦å°å¾ˆå¤šï¼Œè€Œä¸”åˆ©ç”¨æœ‹å‹åœˆçš„è½¬å‘ï¼Œç›¸æ¯”appå»app storeé‡Œä¸Šæ¶ç­‰ç€ç”¨æˆ·ä¸‹è½½ï¼Œè¦å®¹æ˜“å¾ˆå¤šã€‚</p>\\n<p>ä½†æ˜¯å¾®ä¿¡å…¬å…±å·çš„è°ƒè¯•æœ‰ç‚¹ä¸æ–¹ä¾¿ï¼Œå¿…é¡»åœ¨å¾®ä¿¡<a href=\\\"https://mp.weixin.qq.com/\\\">ç®¡ç†åå°</a>é…ç½®ä¸€ä¸ªå¾®ä¿¡èƒ½è®¿é—®åˆ°ï¼ˆå…¬ç½‘ï¼‰çš„urlï¼Œç„¶ååœ¨å…¬å…±å·é‡Œè¾“å…¥å†…å®¹ï¼Œå¾®ä¿¡ä»¥xmlæ ¼å¼è½¬å‘ç»™è¿™ä¸ªurlï¼Œurlå›å¤ä¹‹åå¾®ä¿¡å†å°†responseå›å¤ç»™ä½¿ç”¨å…¬å…±å·çš„å¾®ä¿¡ç”¨æˆ·ã€‚å½“ç„¶å¾®ä¿¡ä¹Ÿæä¾›äº†<a href=\\\"http://mp.weixin.qq.com/debug\\\">è°ƒè¯•å·¥å…·</a>ï¼Œ å¯ä»¥ç›´æ¥æ„é€ æ•°æ®ï¼Œæ–¹ä¾¿è°ƒè¯•å„ä¸ªæ¥å£ã€‚ ä½†æ˜¯ä¾ç„¶éœ€è¦ä¸€ä¸ªå…¬ç½‘çš„urlä½œä¸ºæ¥å£ã€‚äºæ˜¯æœ€åŸå§‹çš„å¼€å‘æ–¹å¼å°±æ˜¯ï¼Œä¿®æ”¹ä»£ç ï¼Œä¸Šä¼ åˆ°serverï¼Œï¼ˆå¦‚æœæ˜¯æœ‰äº›é™æ€è¯­è¨€è¿˜éœ€è¦é‡å¯æœåŠ¡å™¨ï¼‰ï¼Œç„¶åçœ‹æ˜¯å¦æ­£å¸¸workï¼Œå¦‚æœä¸è¡Œçš„è¯ï¼Œåœ¨å¯èƒ½é”™è¯¯çš„åœ°æ–¹æ‰“å‡ºlogï¼Œç„¶ååˆæ˜¯ä¿®æ”¹ä»£ç ï¼Œä¸Šä¼ serverï¼Œé‡å¯ã€‚ã€‚ã€‚ã€‚ã€‚å°±è¿™æ ·ï¼Œæ¯æ¬¡æ”¹ä¸€ç‚¹ç‚¹ï¼Œä½ éƒ½å¯ä»¥æ³¡æ¯å’–å•¡äº†ï¼Œè€æ¿å°±ä¼šè§‰å¾—ä½ å¾ˆé—²ã€‚å‚çœ‹<a href=\\\"http://www.oschina.net/news/15579/reasons-why-people-who-work-with-computers-seem-to\\\">ä¸ºä»€ä¹ˆæè®¡ç®—æœºå·¥ä½œçš„äººæ€»æ˜¯çœ‹ä¸Šå»å¾ˆæ¸…é—²</a>ã€‚</p>\\n<!-- more -->\\n<p>æœ‰æ²¡æœ‰åŠæ³•å¯ä»¥ç›´æ¥åœ¨æœ¬åœ°è°ƒè¯•å‘¢ï¼Œç®€å•è¯´ï¼Œå°±æ˜¯å¾®ä¿¡æŠŠæ•°æ®ä¼ åˆ°æˆ‘æœ¬åœ°çš„ç”µè„‘ä¸Šï¼Œæˆ‘æ¯æ¬¡æ”¹å®Œä»£ç ï¼Œä¸ç”¨é‡æ–°ä¸Šä¼ serverï¼Œç›´æ¥åœ¨æœ¬åœ°åŠ logç­‰ã€‚ç»è¿‡ç ”ç©¶ï¼Œæ‰¾åˆ°å‡ ä¸ªæ–¹æ³•ï¼Œè®°å½•ä¸‹æ¥ï¼Œä¸å¤§å®¶åˆ†äº«ï¼Œç»å¯¹èƒ½èŠ‚çº¦å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šæ—¶é—´ï¼Œç„¶åå°±å¯ä»¥å»é™ªå¦¹çº¸äº†ï¼Œ å¦‚æœä½ æœ‰çš„è¯ï¼Œæ²¡æœ‰çš„è¯<a href=\\\"http://www.zhihu.com/question/20385321\\\">here</a>ã€‚</p>\\n<p>ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä½ æœ¬åœ°ç”µè„‘æœ‰å…¬ç½‘ipã€‚æ¯”å¦‚å®¶é‡Œå®½å¸¦ï¼Œæ²¡ç”¨è·¯ç”±ï¼Œç›´æ¥æŠŠç½‘çº¿æ’ä¸Šï¼Œåº”è¯¥å°±æ˜¯å…¬ç½‘IPï¼Œå§ã€‚ å¦‚æœå®¶é‡Œæœ‰å¤šäººä½¿ç”¨ï¼Œä½ å¯ä»¥å†è·¯ç”±å™¨é‡Œé…ç½®NATåœ°å€è½¬æ¢ã€‚è‡ªè¡Œ<a href=\\\"https://www.google.com.hk/webhp?sourceid=chrome-instant&#x26;ion=1&#x26;espv=2&#x26;ie=UTF-8#q=NAT%20%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2\\\">Google</a>å§ã€‚</p>\\n<p>ç¬¬äºŒç§ï¼Œä¹Ÿæ˜¯æˆ‘æœåˆ°çš„æœ€å¤šçš„ï¼Œç”¨ngrokè¿™ä¸ªç¥å™¨ï¼ç½‘ä¸Šä¸€å †èµ„æ–™ï¼Œæ¯”å¦‚<a href=\\\"http://www.mbnow.tk/2014/12/05/ngrok/\\\">è¿™ä¸ª</a>ï¼Œæˆ‘Googleåˆ°çš„æœ€å¤šçš„ä¹Ÿæ˜¯è¿™ä¸ªï¼Œè€Œä¸”çœ‹ä¸Šå»ä¹Ÿåº”è¯¥å¾ˆç®€å•ã€‚ <a href=\\\"http://www.oray.com/\\\">èŠ±ç”Ÿå£³</a>æˆ‘10å¹´å‰ç”¨è¿‡ï¼ˆxï¼Œä¸å°å¿ƒæš´éœ²å¹´é¾„äº†ï¼‰ï¼Œåº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚ç½‘ä¸Šè¯´ï¼Œç¼ºç‚¹æ˜¯</p>\\n<blockquote>\\n<p>ä¸è¿‡ ngrok é€Ÿåº¦è¾ƒæ…¢ï¼Œå¾®ä¿¡æœåŠ¡å™¨å¯¹å®æ—¶æ€§è¦æ±‚è¾ƒé«˜ï¼Œæ¯æ¬¡é€šä¿¡è¶…è¿‡ 5 ç§’ä¾¿è¶…æ—¶ï¼Œæ‰€ä»¥æ­¤æ³•ä¹Ÿä¸å»ºè®®ä½¿ç”¨ã€‚</p>\\n</blockquote>\\n<p>æˆ‘è§‰å¾—ç”¨èŠ±ç”Ÿå£³çš„è¯å¯èƒ½å¥½ç‚¹ï¼Œå› ä¸ºæ˜¯å›½å†…çš„ï¼ˆæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å»è¯•è¯•å“ˆï¼‰ã€‚æ²¡æœ‰ç”¨ngrokè¯•ä¸€ä¸‹ï¼Œå› ä¸ºâ€œæ— æ³•æ˜¾ç¤ºæ­¤ç½‘é¡µâ€ï¼ç½‘ä¸Šå°±æ˜¯â€œéª—å­â€å¤šï¼Œæ˜æ˜æ²¡æœ‰çš„ç½‘ç«™ï¼Œå¤§å®¶éƒ½æç»˜çš„ç»˜å£°ç»˜è‰²ã€‚</p>\\n<p>ç¬¬ä¸‰ç§ï¼Œç”¨sshå»ºç«‹åå‘é€šé“ã€‚å¯¹äº†ï¼Œä½¿ç”¨æ­¤ç§æ–¹æ³•ï¼Œä½ è¿˜æ˜¯éœ€è¦ä¸€ä¸ªå…¬ç½‘IPçš„ã€‚ ä½œä¸ºä¸€åä¸“ä¸šå·¥ç¨‹å¸ˆï¼Œæ‹¥æœ‰å…¬ç½‘ ip åœ°å€çš„ VPS æœåŠ¡å™¨åŸºæœ¬æˆäº†æ ‡é…ï¼Œ<a href=\\\"http://www.qcloud.com/redirect.php?redirect=1002&#x26;cps_key=0a3641075e434bf76a016a44d2918e4a\\\">è…¾è®¯äº‘VPS</a> æœ€ä¾¿å®œçš„ä¸€æ¬¾æ¯å¹´ä¹Ÿå°±å‡ ç™¾å—é’±ï¼Œå¹³æ—¶æŒ‚æŒ‚è‡ªå·±å–œæ¬¢çš„æœåŠ¡ï¼Œåšä¸ªç«™é•¿ï¼Œè·‘è·‘è‡ªå·±çš„å¼€æºé¡¹ç›®ç”šçˆ½ã€‚</p>\\n<ol>\\n<li>ç”³è¯·<a href=\\\"http://www.qcloud.com/redirect.php?redirect=1001&#x26;cps_key=0a3641075e434bf76a016a44d2918e4a\\\">è…¾è®¯äº‘</a></li>\\n<li>æœ¬åœ°å®‰è£…sshï¼Œå¦‚æœæ˜¯linuxæˆ–macï¼Œéƒ½æ˜¯è‡ªå¸¦çš„ã€‚å¦‚æœæ˜¯windowsçš„è¯ï¼Œå¯ä»¥å®‰è£…<a href=\\\"https://www.cygwin.com/\\\">Cygwin</a>ï¼Œå¦‚æœä½ å«Œå¼ƒå®ƒå¤ªé‡äº†ï¼Œå®‰è£…äº†<a href=\\\"https://git-scm.com/download/gui/win\\\">Git</a>ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å¦‚æœä½ ä¹Ÿä¸æƒ³è£…æˆ–è€…ä¸ä¼šè£…Gitï¼Œé¢ï¼Œ(âŠ™oâŠ™)â€¦ï¼Œå¥½å§ï¼Œé‚£ä½ è¿˜æ˜¯ä¸è¦å†™ç¨‹åºäº†ã€‚</li>\\n<li>\\n<p>å»ºç«‹sshåå‘é€šé“ã€‚\\nè¿™ä¸€æ­¥é‡Œæœ‰å¾ˆå¤šå‘ï¼Œæˆ‘èŠ±äº†å·®ä¸å¤šä¸€å¤©æ‰å®Œå…¨æå®šã€‚ä½ ä»¬å¯ä»¥å…ˆå‚è€ƒè¿™å‡ ç¯‡æ–‡ç« ï¼Œäº†è§£ä¸‹åŸç†å•¥çš„ã€‚</p>\\n<ul>\\n<li><a href=\\\"http://blog.zjutoe.net/?p=95\\\">http://blog.zjutoe.net/?p=95</a></li>\\n<li><a href=\\\"http://my.oschina.net/abcfy2/blog/177094\\\">http://my.oschina.net/abcfy2/blog/177094</a></li>\\n<li><a href=\\\"http://www.zzbaike.com/wiki/PuTTY/Putty%E5%BB%BA%E7%AB%8B%E9%9A%A7%E9%81%93%E7%9A%84%E6%96%B9%E6%B3%95\\\">http://www.zzbaike.com/wiki/PuTTY/Putty%E5%BB%BA%E7%AB%8B%E9%9A%A7%E9%81%93%E7%9A%84%E6%96%B9%E6%B3%95</a></li>\\n<li><a href=\\\"http://www.freeoa.net/osuport/netmanage/linux-ssh-tunneling-proxy_1892.html\\\">http://www.freeoa.net/osuport/netmanage/linux-ssh-tunneling-proxy_1892.html</a></li>\\n<li><a href=\\\"https://qdan.me/list/VOSXmsI4tv7fIciF\\\">https://qdan.me/list/VOSXmsI4tv7fIciF</a></li>\\n</ul>\\n</li>\\n</ol>\\n<p>å¥½å§ï¼Œæ¥çœ‹æˆ‘çš„å…·ä½“ä¸€æ­¥ä¸€æ­¥åšæ³•ã€‚</p>\\n<ol>\\n<li>\\n<p>ssh -R 9999:localhost:9000 ubuntu@myserver<em>ip</em>addressï¼Œè¾“å…¥å¯†ç </p>\\n</li>\\n<li>\\n<p>serverä¸ŠæŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦ç›‘å¬äº†9999ç«¯å£ï¼Œnetstat -anltp | grep 9999</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">ubuntu@VM-39-45-ubuntu:~$ <span class=\\\"token function\\\">netstat</span> -anltp <span class=\\\"token operator\\\">|</span> <span class=\\\"token function\\\">grep</span> 9999\\n<span class=\\\"token punctuation\\\">(</span>Not all processes could be identified, non-owned process info\\nwill not be shown, you would have to be root to see it all.<span class=\\\"token punctuation\\\">)</span>\\ntcp        0      0 127.0.0.1:9999          0.0.0.0:*               LISTEN      -\\ntcp6       0      0 ::1:9999                :::*                    LISTEN      -</code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>åœ¨æœ¬åœ°9000ï¼ˆæˆ‘ç”¨çš„<a href=\\\"https://www.playframework.com/documentation/1.3.x/home\\\">play 1</a>ï¼Œå¯ä»¥äº†è§£ä¸‹å®ƒåˆ°åº•ä¸ºå•¥è¿™ä¹ˆå¥½ç”¨<a href=\\\"http://segmentfault.com/a/1190000000374033\\\">Play Framework â€”â€” Javaå¼€å‘è€…çš„æ¢¦æƒ³æ¡†æ¶</a>ï¼‰ä¸Šå¼€å¯webæœåŠ¡</p>\\n</li>\\n<li>\\n<p>åœ¨æµè§ˆå™¨é‡Œè¾“å…¥<a href=\\\"http://myserver_ip_address:9999%EF%BC%8C\\\">http://myserver<em>ip</em>address:9999ï¼Œ</a> å±…ç„¶æ˜¯æ²¡æœ‰å“åº”ï¼å¥‡æ€ªï¼ç›´æ¥åœ¨serverä¸Šç”¨curl <a href=\\\"http://localhost:9999\\\">http://localhost:9999</a> æ˜¯å¯ä»¥çš„ï¼ä»”ç»†çœ‹netstatè¾“å‡ºï¼Œå‘ç°ç›‘å¬çš„9999ç«¯å£æ˜¯æœ¬åœ°çš„ï¼ï¼ï¼ä¹Ÿå°±æ˜¯è¯´åªèƒ½åœ¨æœ¬åœ°è®¿é—®ï¼Œé‚£æœ‰xxç”¨å•Šï¼ï¼ï¼</p>\\n</li>\\n<li>\\n<p>çœ‹çœ‹ssh â€”helpï¼Œ åŸæ¥æ˜¯å¯ä»¥æŒ‡å®šbind_addressçš„ï¼Œ man sshçœ‹çœ‹</p>\\n<blockquote>\\n<p>By default, the listening socket on the server will be bound to the loopback interface only.  This may be overridden by specifying a bind<em>address. An empty bind</em>address, or the address â€˜*â€™, indicates that the remote socket should listen on all interfaces.  Specifying a remote bind<em>address will only succeed if the serverâ€™s GatewayPorts option is enabled (see sshd</em>config(5)).</p>\\n</blockquote>\\n</li>\\n</ol>\\n<p>  ç»§ç»­çœ‹çœ‹ man sshd_config</p>\\n<blockquote>\\n<p>GatewayPorts\\nSpecifies whether remote hosts are allowed to connect to ports forwarded for the client.  By default, sshd(8) binds remote port forwardings to the\\nloopback address.  This prevents other remote hosts from connecting to forwarded ports.  GatewayPorts can be used to specify that sshd should allow</p>\\n</blockquote>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">remote port forwardings to bind to non-loopback addresses, thus allowing other hosts to connect.  The argument may be â€œnoâ€ to force remote port\\nforwardings to be available to the local host only, â€œyesâ€ to force remote port forwardings to bind to the wildcard address, or â€œclientspecifiedâ€ to\\nallow the client to select the address to which the forwarding is bound.  The default is â€œnoâ€.</code></pre>\\n      </div>\\n<p> sudo vim /etc/ssh/sshd<em>configï¼Œæ·»åŠ GatewayPorts clientspecifiedï¼ŒGatewayPorts yesä¹Ÿå¯ä»¥ï¼Œé€€å‡ºï¼Œsudo service sshd restartï¼Œé‡å¯sshæœåŠ¡ã€‚é‡æ–°ssh -R :9999:localhost:9000 ubuntu@myserver</em>ip<em>addressï¼ˆä»”ç»†çœ‹ï¼Œå°±9999å‰å¤šäº†ä¸€ä¸ªå†’å·:ï¼‰ï¼Œè¾“å…¥å¯†ç ï¼Œnetstat -anltp | grep 9999ï¼Œæœç„¶\\n<code class=\\\"language-text\\\">tcp        0      0 0.0.0.0:9999            0.0.0.0:*               LISTEN      -\\n\\ttcp6       0      0 :::9999                 :::*                    LISTEN      -</code>\\næµè§ˆå™¨é‡Œè¾“å…¥<a href=\\\"http://myserver\\\">http://myserver</a></em>ip_address:9999ï¼Œ è¿™å›å¯ä»¥çœ‹åˆ°æœ¬åœ°æ‰“å‡ºæ—¥å¿—äº†ã€‚</p>\\n<ol start=\\\"6\\\">\\n<li>\\n<p>ç„¶åå‘ç°å¾®ä¿¡é‡Œé¢é…ç½®çš„urlåªèƒ½æ˜¯80ç«¯å£ã€‚ç®€å•ï¼Œç›´æ¥æ”¹æˆssh -R :80:localhost:9000 ubuntu@myserver<em>ip</em>addresså°±å¯ä»¥äº†ï¼Œå§ï¼å¥‡æ€ªï¼Œç›´æ¥è®¿é—®<a href=\\\"http://myserver_ip_address%EF%BC%8C\\\">http://myserver<em>ip</em>addressï¼Œ</a> æ‰“ä¸å¼€ç½‘é¡µï¼ç”¨netstat -anltp | grep 80ï¼Œå±…ç„¶ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼è¯´æ˜serveræ²¡æœ‰åœ¨80ç«¯å£ç›‘å¬å‘€ï¼å“¦ï¼Œå¯¹äº†ubuntuä½äº1024çš„ç«¯å£æ˜¯éœ€è¦ç”¨rootæƒé™çš„ã€‚</p>\\n</li>\\n<li>\\n<p>ubuntué‡Œrooté»˜è®¤æ˜¯å…³é—­çš„ã€‚sudo passwd rootï¼Œè®¾ç½®rootå¯†ç åï¼Œå¯ä»¥æ‰“å¼€ã€‚è¿˜éœ€è¦åœ¨sudo vim /etc/ssh/sshd_config\\tæ·»åŠ </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">#PermitRootLogin without-password\\nPermitRootLogin yes</code></pre>\\n      </div>\\n</li>\\n<li>\\n<p>é‡å¯sshï¼Œå†é‡æ–°ç”¨rootè´¦å·è¿æ¥ï¼Œssh -R :80:localhost:9000 root@myserver<em>ip</em>addressï¼Œ ä¸€åˆ‡okï¼Œ<a href=\\\"http://myserver_ip_address%EF%BC%8C\\\">http://myserver<em>ip</em>addressï¼Œ</a> æœ¬åœ°ä»£ç æ‰“å‡ºæ—¥å¿—ï¼Œè¯´æ˜æµé‡å·²ç»å¯¼å…¥åˆ°æœ¬åœ°äº†ã€‚</p>\\n</li>\\n<li>\\n<p>æœ€åï¼Œå°±å¯ä»¥åœ¨<a href=\\\"http://mp.weixin.qq.com/debug\\\">å¾®ä¿¡å…¬ä¼—å¹³å°æ¥å£è°ƒè¯•å·¥å…·</a>é‡Œè°ƒè¯•äº†ï¼Œé…åˆ<a href=\\\"http://playframework.com/\\\">Play!</a>çš„hot reloadï¼Œéšæ—¶ä¿®æ”¹ä»£ç ï¼ŒåŠ logï¼Œç„¶åé©¬ä¸Šå°±å¯ä»¥çœ‹åˆ°æ•ˆæœï¼Œä¸ç”¨é‡æ–°ç¼–è¯‘ï¼Œä¸ç”¨ä¸Šä¼ serverï¼Œä¸ç”¨é‡å¯ã€‚ã€‚ã€‚ã€‚ç”Ÿæ´»çœŸæ˜¯å¹¸ç¦ç¾æ»¡å•Šã€‚ã€‚ã€‚ã€‚</p>\\n</li>\\n<li>\\n<p>å‡ ä¸ªé—®é¢˜è¯´æ˜ï¼š</p>\\n<ol>\\n<li>ç›´æ¥ç”¨sshè¿æ¥çš„è¯ï¼Œæ–­å¼€ä¹‹åç«¯å£æ˜ å°„å°±æ²¡æœ‰äº†ï¼Œå¯ä»¥ç”¨autosshï¼Œ åªæ˜¯æˆ‘å°±æ˜¯ä¸´æ—¶éœ€è¦è°ƒè¯•ç”¨çš„æ—¶å€™æ‰sshå»ºç«‹åå‘éš§é“ï¼Œæ‰€ä»¥æˆ‘ä¸ç”¨autosshã€‚</li>\\n<li>ç›´æ¥ç”¨rootç™»é™†sshï¼Œå¼€é€š80ç«¯å£ã€‚åº”è¯¥æ˜¯æœ‰å®‰å…¨éšæ‚£çš„ï¼Œ å§ï¼å¯¹å®‰å…¨ä¸æ˜¯å¾ˆäº†è§£ï¼Œä½†æ„Ÿè§‰ç›´æ¥ç”¨rootè‚¯å®šä¸æ˜¯æœ€ä½³å®è·µã€‚ç½‘ä¸Šæœ‰å„ç§æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ç”¨iptablesç«¯å£æ˜ å°„ï¼Œæˆ–è€…nginxåå‘ä»£ç†çš„ï¼Œ<a href=\\\"http://stackoverflow.com/questions/23281895/node-js-eacces-error-when-listening-on-http-80-port-permission-denied\\\">çœ‹è¿™é‡Œ</a>ï¼Œå‚çœ‹1çš„åŸå› ï¼Œæˆ‘æ²¡æœ‰é‡‡ç”¨ã€‚è¿˜æ˜¯ä¸€æ¬¡focusä¸€ä¸ªç‚¹å§ï¼Œä¸ç„¶å…‰ç¯å¢ƒå°±é…ç½®å‡ å¤©ï¼Œæœ‰ç‚¹å¤ªæ…¢äº†ã€‚</li>\\n</ol>\\n</li>\\n</ol>\\n<p>é€šè¿‡æœ¬æ–‡çš„é…ç½®ï¼Œå¯ä»¥åœ¨æœ¬åœ°æ–¹ä¾¿çš„å¼€å‘è°ƒè¯•å¾®ä¿¡å…¬å…±å·äº†ã€‚ä½†æ˜¯å¯¹äºå¾®ä¿¡æä¾›çš„<a href=\\\"http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html\\\">JS-SDK</a>ï¼Œåˆå­˜åœ¨å¦å¤–çš„é—®é¢˜ï¼Œè¿™ä¸ªæˆ‘ä¼š<a href=\\\"http://my.oschina.net/magicly007/blog/480704\\\">å¦å¤–å†™ä¸€ç¯‡blogæ¥è§£å†³</a>ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬ç¨‹åºå‘˜åº”è¯¥åšæŒ<a href=\\\"https://en.wikipedia.org/wiki/Single_responsibility_principle\\\">Single responsibility principle</a>å˜›ã€‚</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://www.mbnow.tk/2014/12/05/ngrok/\\\">http://www.mbnow.tk/2014/12/05/ngrok/</a></li>\\n<li><a href=\\\"http://my.oschina.net/jfinal/blog/336861\\\">http://my.oschina.net/jfinal/blog/336861</a></li>\\n<li><a href=\\\"http://www.mbnow.tk/2014/12/05/ngrok/\\\">http://www.mbnow.tk/2014/12/05/ngrok/</a></li>\\n<li><a href=\\\"http://liyaodong.com/2015/07/06/%E5%BE%AE%E4%BF%A1%E8%B0%83%E8%AF%95%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/\\\">http://liyaodong.com/2015/07/06/%E5%BE%AE%E4%BF%A1%E8%B0%83%E8%AF%95%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</a></li>\\n<li><a href=\\\"http://my.oschina.net/abcfy2/blog/177094\\\">http://my.oschina.net/abcfy2/blog/177094</a></li>\\n<li><a href=\\\"http://www.zhihu.com/question/25456655\\\">http://www.zhihu.com/question/25456655</a></li>\\n<li><a href=\\\"http://my.oschina.net/atanl/blog/391611\\\">http://my.oschina.net/atanl/blog/391611</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":5,\"excerpt\":\"å¾®ä¿¡å…¬å…±å·ç°åœ¨å¾ˆç«ï¼Œä¸€äº›ç®€å•çš„åº”ç”¨ï¼Œåšä¸€ä¸ªå…¬å…±å·æ¯”å¼€å‘ä¸€æ¬¾appæˆæœ¬è¦å°å¾ˆå¤šï¼Œè€Œä¸”åˆ©ç”¨æœ‹å‹åœˆçš„è½¬å‘ï¼Œç›¸æ¯”appå»app storeé‡Œä¸Šæ¶ç­‰ç€ç”¨æˆ·ä¸‹è½½ï¼Œè¦å®¹æ˜“å¾ˆå¤šã€‚ ä½†æ˜¯å¾®ä¿¡å…¬å…±å·çš„è°ƒè¯•æœ‰ç‚¹ä¸æ–¹ä¾¿ï¼Œå¿…é¡»åœ¨å¾®ä¿¡ ç®¡ç†åå° é…ç½®ä¸€ä¸ªå¾®ä¿¡èƒ½è®¿é—®åˆ°ï¼ˆå…¬ç½‘ï¼‰çš„urlâ€¦\",\"fields\":{\"slug\":\"/ssh-reverse-tunnel-wx-local/\"},\"frontmatter\":{\"title\":\"åˆ©ç”¨SSHåå‘é€šé“åœ¨æœ¬åœ°è°ƒè¯•å¾®ä¿¡å…¬å…±å·\",\"date\":\"2015-07-26\",\"category\":\"weixin\",\"tags\":[\"ssh\",\"weixin\",\"å¾®ä¿¡\"]}}},{\"node\":{\"html\":\"<p>å¼•ç”¨<a href=\\\"http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html\\\">é˜®è€å¸ˆ</a>çš„è¯ï¼Œ</p>\\n<blockquote>\\n<p>å–œæ¬¢å†™Blogçš„äººï¼Œä¼šç»å†ä¸‰ä¸ªé˜¶æ®µã€‚</p>\\n</blockquote>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">ç¬¬ä¸€é˜¶æ®µï¼Œåˆšæ¥è§¦Blogï¼Œè§‰å¾—å¾ˆæ–°é²œï¼Œè¯•ç€é€‰æ‹©ä¸€ä¸ªå…è´¹ç©ºé—´æ¥å†™ã€‚\\nç¬¬äºŒé˜¶æ®µï¼Œå‘ç°å…è´¹ç©ºé—´é™åˆ¶å¤ªå¤šï¼Œå°±è‡ªå·±è´­ä¹°åŸŸåå’Œç©ºé—´ï¼Œæ­å»ºç‹¬ç«‹åšå®¢ã€‚\\nç¬¬ä¸‰é˜¶æ®µï¼Œè§‰å¾—ç‹¬ç«‹åšå®¢çš„ç®¡ç†å¤ªéº»çƒ¦ï¼Œæœ€å¥½åœ¨ä¿ç•™æ§åˆ¶æƒçš„å‰æä¸‹ï¼Œè®©åˆ«äººæ¥ç®¡ï¼Œè‡ªå·±åªè´Ÿè´£å†™æ–‡ç« ã€‚</code></pre>\\n      </div>\\n<p>è‡ªå·±æ¯”è¾ƒæ‡’æƒ°ï¼Œä¹Ÿå°±å¶å°”åœ¨<a href=\\\"http://my.oschina.net/magicly007/blog\\\">OC</a>ä¸Šå†™ç‚¹é—²æ•£çš„ç¬”è®°ï¼Œæœ€è¿‘è§‰å¾—è¿˜æ˜¯åº”è¯¥è¦æŠŠè‡ªå·±çš„çŸ¥è¯†ç³»ç»Ÿåœ°æ¢³ç†ä¸€ä¸‹ï¼Œä¾¿å†³å®šå¼€ä¸€ä¸ªç‹¬ç«‹çš„åŸŸåï¼Œè‡ªå·±è®°å½•Blogã€‚</p>\\n<p>ä¹‹å‰å°±äº†è§£Github Pagesï¼Œä¹Ÿæ–­æ–­ç»­ç»­ç”¨MarkDownå†™è¿‡å‡ ç¯‡æ”¾ç€ï¼Œä½†æ˜¯æ²¡æœ‰ç”¨<a href=\\\"http://jekyllrb.com/\\\">jekyll</a>ï¼Œæˆ–è€…<a href=\\\"http://octopress.org/\\\">octpress</a>ç­‰ä¸²èµ·æ¥ï¼Œä¸Šä¸ªæœˆå†æ¬¡æƒ³é…ç½®å¥½jekyllï¼Œç»“æœåœ¨macä¸‹å§‹ç»ˆé…ç½®ä¸å¥½ï¼ˆæ€ªæˆ‘å’¯ï¼‰ã€‚ä»Šå¤©å†³å®šä¸€å®šè¦é…ç½®å¥½ï¼Œæœé›†äº†å¤§é‡èµ„æ–™ï¼ˆgoogle â€œjekyll åƒé»‘å®¢ä¸€æ ·â€ï¼‰ï¼Œç»“æœæ„å¤–åœ¨<a href=\\\"http://www.douban.com/group/topic/39939196/\\\">http://www.douban.com/group/topic/39939196/</a>çš„å›å¤ä¸­çœ‹åˆ°â€œç”¨pelicanå§ pythonçš„ è¿˜æœ‰hexoæ˜¯nodejsçš„ â€ã€‚å› ä¸ºæœ€è¿‘åˆšå¥½åœ¨çœ‹nodejsï¼Œè§‰å¾—å¾ˆæœ‰å…´è¶£ï¼Œäºæ˜¯æ”¹ä¸ºå°è¯•<a href=\\\"https://hexo.io/zh-cn/\\\">hexo</a>ã€‚</p>\\n<!-- more -->\\n<h1 id=\\\"ç®€ä»‹\\\"><a href=\\\"#%E7%AE%80%E4%BB%8B\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ç®€ä»‹</h1>\\n<p><a href=\\\"http://ibruce.info/2013/11/22/hexo-your-blog/\\\">http://ibruce.info/2013/11/22/hexo-your-blog/</a></p>\\n<blockquote>\\n<p>hexoå‡ºè‡ªå°æ¹¾å¤§å­¦ç”Ÿ<a href=\\\"https://twitter.com/tommy351\\\">tommy351</a>ä¹‹æ‰‹ï¼Œæ˜¯ä¸€ä¸ªåŸºäº<a href=\\\"https://nodejs.org/\\\">Node.js</a>çš„é™æ€åšå®¢ç¨‹åºï¼Œå…¶ç¼–è¯‘ä¸Šç™¾ç¯‡æ–‡å­—åªéœ€è¦å‡ ç§’ã€‚hexoç”Ÿæˆçš„é™æ€ç½‘é¡µå¯ä»¥ç›´æ¥æ”¾åˆ°GitHub Pagesï¼ŒBAEï¼ŒSAEç­‰å¹³å°ä¸Šã€‚å…ˆçœ‹çœ‹tommyæ˜¯å¦‚ä½•åæ§½Octopressçš„ â†’ï¼¿â†’ <a href=\\\"http://zespia.tw/blog/2012/10/11/hexo-debut/\\\">Hexoé¢¯çˆ½ç™»å ´</a>ã€‚</p>\\n</blockquote>\\n<h1 id=\\\"å®‰è£…\\\"><a href=\\\"#%E5%AE%89%E8%A3%85\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å®‰è£…</h1>\\n<p>é¦–å…ˆå®‰è£…Node.jsï¼Œç„¶åè¿è¡Œ</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\t<span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> -g hexo-cli\\n\\t<span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> hexo --save</code></pre>\\n      </div>\\n<h1 id=\\\"åˆå§‹åŒ–é…ç½®\\\"><a href=\\\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>åˆå§‹åŒ–é…ç½®</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo init\\n\\t<span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span></code></pre>\\n      </div>\\n<h1 id=\\\"å†™blog\\\"><a href=\\\"#%E5%86%99blog\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å†™blog</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo n</code></pre>\\n      </div>\\n<h1 id=\\\"ç”Ÿæˆ\\\"><a href=\\\"#%E7%94%9F%E6%88%90\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ç”Ÿæˆ</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo g</code></pre>\\n      </div>\\n<h1 id=\\\"æœ¬åœ°é¢„è§ˆ\\\"><a href=\\\"#%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æœ¬åœ°é¢„è§ˆ</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo s</code></pre>\\n      </div>\\n<h1 id=\\\"å‘å¸ƒ\\\"><a href=\\\"#%E5%8F%91%E5%B8%83\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>å‘å¸ƒ</h1>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-shell\\\"><code class=\\\"language-shell\\\">\\thexo d</code></pre>\\n      </div>\\n<p>å®åœ¨è§‰å¾—æ²¡å¿…<a href=\\\"https://en.wikipedia.org/wiki/Reinventing_the_wheel\\\">é‡å¤é€ è½®å­</a>ï¼Œé‡å†™å·²ç»æœ‰å¾ˆè¯¦ç»†èµ„æ–™çš„ä¸œè¥¿ã€‚å¼ºçƒˆæ¨è<a href=\\\"http://ibruce.info/2013/11/22/hexo-your-blog/\\\">è¿™ç¯‡</a>ã€‚ æˆ‘è§‰å¾—åŸºæœ¬æ¶µç›–äº†æ–¹æ–¹é¢é¢ï¼Œå¦‚æœä»¥åæœ‰æ–°ä¸œè¥¿è¿™é‡Œé¢æ²¡æœ‰çš„ï¼Œæˆ‘å†å†™å§~</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://ibruce.info/2013/11/22/hexo-your-blog/\\\">http://ibruce.info/2013/11/22/hexo-your-blog/</a></li>\\n<li><a href=\\\"http://wsgzao.github.io/post/hexo-guide/\\\">http://wsgzao.github.io/post/hexo-guide/</a></li>\\n<li><a href=\\\"http://www.jianshu.com/p/05289a4bc8b2\\\">http://www.jianshu.com/p/05289a4bc8b2</a></li>\\n<li><a href=\\\"http://yangjian.me/workspace/building-blog-with-hexo/\\\">http://yangjian.me/workspace/building-blog-with-hexo/</a></li>\\n<li><a href=\\\"http://yangjian.me/workspace/building-blog-with-hexo/\\\">http://yangjian.me/workspace/building-blog-with-hexo/</a></li>\\n<li><a href=\\\"http://blog.csdn.net/jackystudio/article/details/16117585\\\">http://blog.csdn.net/jackystudio/article/details/16117585</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":2,\"excerpt\":\"å¼•ç”¨ é˜®è€å¸ˆ çš„è¯ï¼Œ å–œæ¬¢å†™Blogçš„äººï¼Œä¼šç»å†ä¸‰ä¸ªé˜¶æ®µã€‚ è‡ªå·±æ¯”è¾ƒæ‡’æƒ°ï¼Œä¹Ÿå°±å¶å°”åœ¨ OC ä¸Šå†™ç‚¹é—²æ•£çš„ç¬”è®°ï¼Œæœ€è¿‘è§‰å¾—è¿˜æ˜¯åº”è¯¥è¦æŠŠè‡ªå·±çš„çŸ¥è¯†ç³»ç»Ÿåœ°æ¢³ç†ä¸€ä¸‹ï¼Œä¾¿å†³å®šå¼€ä¸€ä¸ªç‹¬ç«‹çš„åŸŸåï¼Œè‡ªå·±è®°å½•Blogã€‚ ä¹‹å‰å°±äº†è§£Github Pagesï¼Œä¹Ÿæ–­æ–­ç»­ç»­ç”¨MarkDownâ€¦\",\"fields\":{\"slug\":\"/my-first-hexo-blog/\"},\"frontmatter\":{\"title\":\"æˆ‘çš„ç¬¬ä¸€ä¸ªhexo Blog\",\"date\":\"2015-07-26\",\"category\":\"default\",\"tags\":[\"hexo\",\"github\",\"githubPages\"]}}},{\"node\":{\"html\":\"<p>éœ€è¦åœ¨ä»£ç é‡Œé¢å‘é‚®ä»¶æ˜¯å¾ˆç»å¸¸çš„äº‹æƒ…ï¼ŒåŒ…æ‹¬æ‰¾å›å¯†ç ï¼Œé€šçŸ¥ç”¨æˆ·é¢†å¥–ï¼Œç›‘æ§æŠ¥è­¦ç­‰ã€‚</p>\\n<p>åœ¨Javaé‡Œé¢å®ç°æ¯”è¾ƒç®€å•ï¼ŒOracleè‡ªå·±æä¾›äº†<a href=\\\"http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-eeplat-419426.html#javamail-1.4.7-oth-JPR\\\">JavaMail</a>ï¼Œ ä¸è¿‡APIæ¯”è¾ƒåº•å±‚ï¼Œç”¨èµ·æ¥ä¸æ–¹ä¾¿ï¼Œå¯ä»¥è‡ªå·±å°è£…ä¸‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Apacheçš„å¼€æºé¡¹ç›®<a href=\\\"https://commons.apache.org/proper/commons-email/\\\">Commons Email</a>ã€‚ ä¸‹é¢çš„ä»£ç ï¼Œå¯ä»¥ä»¥å°é©¬å“¥çš„åä¹‰ç»™è‡ªå·±å‘é‚®ä»¶ï¼Œè¯¥åŠŸèƒ½ä»…ç”¨äºæµ‹è¯•ï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼Œäº§ç”Ÿçš„é—®é¢˜ï¼Œæœ¬äººæ¦‚ä¸è´Ÿè´£ã€‚ /å¾®ç¬‘</p>\\n<!-- more -->\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">import</span> org<span class=\\\"token punctuation\\\">.</span>apache<span class=\\\"token punctuation\\\">.</span>commons<span class=\\\"token punctuation\\\">.</span>mail<span class=\\\"token punctuation\\\">.</span>EmailAttachment<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> org<span class=\\\"token punctuation\\\">.</span>apache<span class=\\\"token punctuation\\\">.</span>commons<span class=\\\"token punctuation\\\">.</span>mail<span class=\\\"token punctuation\\\">.</span>EmailException<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> org<span class=\\\"token punctuation\\\">.</span>apache<span class=\\\"token punctuation\\\">.</span>commons<span class=\\\"token punctuation\\\">.</span>mail<span class=\\\"token punctuation\\\">.</span>MultiPartEmail<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>net<span class=\\\"token punctuation\\\">.</span>MalformedURLException<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>net<span class=\\\"token punctuation\\\">.</span>URL<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * Created by magicalli on 2015/7/6.\\n */</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">MultiPartEmailTest</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">main</span><span class=\\\"token punctuation\\\">(</span>String<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> args<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> EmailException<span class=\\\"token punctuation\\\">,</span> MalformedURLException <span class=\\\"token punctuation\\\">{</span>\\n        MultiPartEmail email <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">MultiPartEmail</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setHostName</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"smtp.tencent.com\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token comment\\\">//        email.setAuthentication(\\\"youremail@tencent.com\\\", \\\"***\\\");//é‚®ä»¶æœåŠ¡å™¨éªŒè¯ï¼šç”¨æˆ·å/å¯†ç </span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setCharset</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"UTF-8\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setFrom</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"pony@qq.com\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"é©¬åŒ–è…¾\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">addTo</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"magicalli@tencent.com\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setSubject</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"åŠ æ²¹å¥‹æ–—ï¼\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setMsg</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"come on! åŠ æ²¹å¥‹æ–—å§ï¼Œæ—©æ™šæœ‰ä¸€å¤©ä½ ä¼šå‡ºä»»CEOï¼Œè¿å¨¶ç™½å¯Œç¾ï¼Œèµ°ä¸Šäººç”Ÿå·…å³°ï¼ http://www.qq.com\\\\n\\\\n\\\\n pony\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        EmailAttachment attachment <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">EmailAttachment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setPath</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"d:/lzl.jpg\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">// æœ¬åœ°æ–‡ä»¶</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDisposition</span><span class=\\\"token punctuation\\\">(</span>EmailAttachment<span class=\\\"token punctuation\\\">.</span>ATTACHMENT<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDescription</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"æ—å¿—ç²1\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setName</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"lzl_1\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">attach</span><span class=\\\"token punctuation\\\">(</span>attachment<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        EmailAttachment attachment2 <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">EmailAttachment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setURL</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">URL</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"http://mat1.qq.com/datalib_img/star/pic/lib/2007-01-15/2007011511104716122311.jpg\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è¿œç¨‹æ–‡ä»¶, å¦‚æœä¸æ˜¯qq.comåŸŸåä¸‹ï¼Œå†…ç½‘æ˜¯è®¿é—®ä¸äº†çš„å“ˆ</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDisposition</span><span class=\\\"token punctuation\\\">(</span>EmailAttachment<span class=\\\"token punctuation\\\">.</span>ATTACHMENT<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setDescription</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"æ—å¿—ç²2\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        attachment2<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">setName</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"lzl_2\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">attach</span><span class=\\\"token punctuation\\\">(</span>attachment2<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        email<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p><a href=\\\"https://commons.apache.org/proper/commons-email/\\\">Commons Email</a>æ”¯æŒå¥½å‡ ç§æ ¼å¼ï¼ŒåŒ…æ‹¬ç®€å•æ–‡æœ¬ï¼Œhtmlï¼Œå¸¦é™„ä»¶ç­‰ã€‚éœ€è¦çš„å¯ä»¥è‡ªå·±æŸ¥çœ‹æ–‡æ¡£ã€‚</p>\\n<p>åŸºäºsmtpçš„åè®®é‚®ä»¶åè®®å¾ˆç®€å•ï¼Œå¤§å®¶ç”šè‡³å¯ä»¥ç›´æ¥ç”¨telnetæ¥å‘é€ï¼Œå¯ä»¥å‚è€ƒè¿™è¾¹æ–‡ç« <a href=\\\"http://blog.csdn.net/ghsau/article/details/8602076\\\">Java Mail(ä¸€)ï¼štelnetå®ç°å‘é€æ”¶å–é‚®ä»¶</a>. </p>\\n<p>ä¸€èˆ¬å…¬å¸å†…ç½‘æ²¡æœ‰éªŒè¯å‘é€æ–¹ï¼Œä½ å¯ä»¥å†’å……å…¬å¸ä»»ä½•ä¸€ä¸ªå‘˜å·¥å‘é€é‚®ä»¶ï¼ˆåŒ…æ‹¬ä½ ä»¬è€æ¿ï¼‰ï¼Œä¸€èˆ¬å¤–é¢çš„é‚®ä»¶æœåŠ¡å™¨ï¼Œæ¯”å¦‚qq, 126, 163ç­‰ï¼Œæ˜¯éœ€è¦éªŒè¯å¯†ç çš„ã€‚</p>\\n<p>é‡ç”³ä¸€éï¼Œåˆ«ç”¨è¿™ä¸ªä»£ç å¹²åäº‹ï¼Œåæœè‡ªè´Ÿï¼Œ ä¸æœ¬äººæ— å…³ï¼</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://blog.csdn.net/ghsau/article/details/8602076\\\">http://blog.csdn.net/ghsau/article/details/8602076</a></li>\\n<li><a href=\\\"http://blog.csdn.net/ghsau/article/details/17839983\\\">http://blog.csdn.net/ghsau/article/details/17839983</a></li>\\n<li><a href=\\\"http://haolloyin.blog.51cto.com/1177454/354320\\\">http://haolloyin.blog.51cto.com/1177454/354320</a></li>\\n<li><a href=\\\"http://www.runoob.com/java/java-sending-email.html\\\">http://www.runoob.com/java/java-sending-email.html</a></li>\\n<li><a href=\\\"https://commons.apache.org/proper/commons-email/\\\">https://commons.apache.org/proper/commons-email/</a></li>\\n<li><a href=\\\"http://blog.csdn.net/qiaqia609/article/details/11580589\\\">http://blog.csdn.net/qiaqia609/article/details/11580589</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":2,\"excerpt\":\"éœ€è¦åœ¨ä»£ç é‡Œé¢å‘é‚®ä»¶æ˜¯å¾ˆç»å¸¸çš„äº‹æƒ…ï¼ŒåŒ…æ‹¬æ‰¾å›å¯†ç ï¼Œé€šçŸ¥ç”¨æˆ·é¢†å¥–ï¼Œç›‘æ§æŠ¥è­¦ç­‰ã€‚ åœ¨Javaé‡Œé¢å®ç°æ¯”è¾ƒç®€å•ï¼ŒOracleè‡ªå·±æä¾›äº† JavaMail ï¼Œ ä¸è¿‡APIæ¯”è¾ƒåº•å±‚ï¼Œç”¨èµ·æ¥ä¸æ–¹ä¾¿ï¼Œå¯ä»¥è‡ªå·±å°è£…ä¸‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Apacheçš„å¼€æºé¡¹ç›® Commons Emailâ€¦\",\"fields\":{\"slug\":\"/java-email/\"},\"frontmatter\":{\"title\":\"Javaå‘é€é‚®ä»¶\",\"date\":\"2015-07-13\",\"category\":\"Java\",\"tags\":[\"Java\",\"Email\",\"JavaMail\",\"Apache Commons\"]}}},{\"node\":{\"html\":\"<p>ç»å¸¸é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨å†…å­˜é‡Œç¼“å­˜ä¸€æ‰¹æ•°æ®æ¥æé«˜æ•ˆç‡ï¼ˆé¿å…æ¯æ¬¡éƒ½è¯»å–DBï¼‰ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œè¿™äº›å¯¹è±¡åˆ°åº•ä¼šå ç”¨å¤šå¤§å†…å­˜å‘¢ï¼Œè¿™ç›´æ¥å†³å®šäº†å¯ä»¥ç¼“å­˜å¤šå°‘æ¡è®°å½•ï¼Œä»¥åŠä¸Šçº¿ä¹‹åæ˜¯å¦ä¼šå†…å­˜ä¸å¤Ÿç­‰é—®é¢˜ã€‚</p>\\n<p>æ¥çœ‹å‡ ç§è§£å†³æ–¹æ³•ã€‚</p>\\n<!-- more -->\\n<h1 id=\\\"æµ‹è¯•\\\"><a href=\\\"#%E6%B5%8B%E8%AF%95\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æµ‹è¯•</h1>\\n<p>å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ï¼æ¯”å¦‚ä½ è¦æƒ³cache10wæ¡è®°å½•ï¼Œé‚£ä½ å°±æŠŠ10wæ¡è®°å½•åŠ è½½åˆ°å†…å­˜ï¼Œç„¶åçœ‹çœ‹åˆ°åº•ç”¨äº†å¤šå°‘å†…å­˜ã€‚è‡³äºæ€ä¹ˆçœ‹å†…å­˜èŠ±äº†å¤šå°‘ï¼Œä½ å¯ä»¥</p>\\n<ol>\\n<li>ä»»åŠ¡ç®¡ç†å™¨</li>\\n<li>top</li>\\n<li>Java Runtimeç±»</li>\\n<li>blablaã€‚ã€‚ã€‚ã€‚</li>\\n</ol>\\n<p>æˆ‘ä»¬æ¥çœ‹çœ‹ç›´æ¥ä»Javaç¨‹åºé‡Œèƒ½è·å–åˆ°çš„Runtimeã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>util<span class=\\\"token punctuation\\\">.</span>*<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * Created by magicalli on 2015/2/3.\\n */</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">TestMemory</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">A</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">int</span> a<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">main</span><span class=\\\"token punctuation\\\">(</span>String<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> args<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"--- Memory Usage ---:\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        Runtime rt <span class=\\\"token operator\\\">=</span> Runtime<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getRuntime</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token comment\\\">//æ‰“å°æ€»å†…å­˜å¤§å° //æ‰“å°ç©ºé—²å†…å­˜å¤§å° //æ‰“å°å·²ç”¨å†…å­˜å¤§å° å•ä½(å­—èŠ‚)</span>\\n        <span class=\\\"token keyword\\\">long</span> usedMemory <span class=\\\"token operator\\\">=</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">-</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Total Memory= \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Free Memory = \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Usedã€€Memory=\\\"</span> <span class=\\\"token operator\\\">+</span> usedMemory<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token comment\\\">// æŠŠä½ è¦æµ‹è¯•çš„å ç”¨å†…å­˜çš„ä»£ç æ”¾åœ¨è¿™é‡Œ------start--------------</span>\\n        <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">int</span> N <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">100000</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">int</span><span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> arr <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">int</span><span class=\\\"token punctuation\\\">[</span>N<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        Integer<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> arr2 <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Integer</span><span class=\\\"token punctuation\\\">[</span>N<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        A<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> arrA <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">A</span><span class=\\\"token punctuation\\\">[</span>N<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> i <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;</span> N<span class=\\\"token punctuation\\\">;</span> i<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            arr<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> i<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token comment\\\">//            arr2[i] = i;</span>\\n<span class=\\\"token comment\\\">//            arrA[i] = new A();</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token comment\\\">//        List&lt;Integer> list = new ArrayList&lt;Integer>();</span>\\n        Map<span class=\\\"token generics function\\\"><span class=\\\"token punctuation\\\">&lt;</span>Integer<span class=\\\"token punctuation\\\">,</span> String<span class=\\\"token punctuation\\\">></span></span> map <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">HashMap</span><span class=\\\"token generics function\\\"><span class=\\\"token punctuation\\\">&lt;</span>Integer<span class=\\\"token punctuation\\\">,</span> String<span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token comment\\\">//        for (int i = 0; i &lt; N; i++) {</span>\\n<span class=\\\"token comment\\\">//            list.add(i);</span>\\n<span class=\\\"token comment\\\">//            map.put(i, UUID.randomUUID().toString());</span>\\n<span class=\\\"token comment\\\">//        }</span>\\n<span class=\\\"token comment\\\">//        System.out.println(map.size());</span>\\n        <span class=\\\"token comment\\\">// æŠŠä½ è¦æµ‹è¯•çš„å ç”¨å†…å­˜çš„ä»£ç æ”¾åœ¨è¿™é‡Œ------end--------------</span>\\n\\n        <span class=\\\"token keyword\\\">long</span> usedMemory2 <span class=\\\"token operator\\\">=</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">-</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Total Memory= \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">totalMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Free Memory = \\\"</span> <span class=\\\"token operator\\\">+</span> rt<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">freeMemory</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" Usedã€€Memory=\\\"</span> <span class=\\\"token operator\\\">+</span> usedMemory2<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">long</span> objMemory <span class=\\\"token operator\\\">=</span> usedMemory2 <span class=\\\"token operator\\\">-</span> usedMemory<span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"object use memory: \\\"</span> <span class=\\\"token operator\\\">+</span> objMemory <span class=\\\"token operator\\\">/</span> <span class=\\\"token number\\\">1024</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\"k\\\"</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token string\\\">\\\" each is: \\\"</span> <span class=\\\"token operator\\\">+</span> objMemory <span class=\\\"token operator\\\">/</span> N<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ä¸Šé¢æ–¹æ³•çš„æœ€å¤§å¥½å¤„å°±æ˜¯å¯ä»¥ç›´æ¥è·å¾—å®é™…å ç”¨å†…å­˜å¤§å°ï¼Œæ˜¯æ¯”è¾ƒç®€å•æœ‰æ•ˆçš„æ–¹æ³•ã€‚ä¸å¥½çš„åœ°æ–¹å°±æ˜¯å¦‚æœæ•°æ®é‡æ¯”è¾ƒå°ï¼Œå¯èƒ½åå·®æ¯”è¾ƒå¤§ï¼Œè€Œä¸”ä½ ä¹Ÿä¸èƒ½è§£é‡Šä¸ºä»€ä¹ˆInteger[]æ¯”int[]å ç”¨å†…å­˜å¤§å¾ˆå¤šï¼Œå…³é”®æ˜¯ä¸“å®¶è¯´ï¼šè¿™ç§å†…å­˜å ç”¨åº”è¯¥æ˜¯å¿ƒé‡Œç®—å‡ºæ¥çš„ï¼Œä½ è¿˜è¦å»runä¸€ä¸‹ç¨‹åºï¼Œæ˜æ˜¾å°±lowäº†ï¼Œè¿˜æƒ³æ™‹çº§ï¼Ÿå†ç»ƒç»ƒå§ï¼æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆææŒ‡ä¸€ç®—ï¼</p>\\n<h1 id=\\\"è®¡ç®—\\\"><a href=\\\"#%E8%AE%A1%E7%AE%97\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>è®¡ç®—</h1>\\n<p>è¿™ä¸ªéœ€è¦äº†è§£JVMé‡Œçš„å†…å­˜åˆ†å¸ƒï¼ŒçŸ¥é“æ¯ä¸ªå¯¹è±¡éƒ½æœ‰object headerï¼Œblabalã€‚è¿™é‡Œæ¨èä¸€ç¯‡å¥½æ–‡<a href=\\\"http://www.cnblogs.com/magialmoon/p/3757767.html\\\">ä¸€ä¸ªJavaå¯¹è±¡åˆ°åº•å ç”¨å¤šå¤§å†…å­˜ï¼Ÿ</a>ï¼Œæˆ‘å°±ä¸é‡å¤äº†ã€‚</p>\\n<p>è¿˜çœ‹åˆ°å¦ä¸€ç§è®¡ç®—æ–¹å¼ï¼Œç”¨çš„Unsafeï¼Œä¸è¿‡æ„Ÿè§‰æ²¡æœ‰å‰é¢ç”¨Instrumentationçš„å¥½ã€‚å‚è€ƒè¿™é‡Œ<a href=\\\"http://blog.csdn.net/bobpauline/article/details/20699233\\\">Javaè®¡ç®—ä¸€ä¸ªå¯¹è±¡å ç”¨å†…å­˜çš„å¤§å°</a></p>\\n<h1 id=\\\"çº¿ä¸ŠæŸ¥çœ‹\\\"><a href=\\\"#%E7%BA%BF%E4%B8%8A%E6%9F%A5%E7%9C%8B\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>çº¿ä¸ŠæŸ¥çœ‹</h1>\\n<p>å¦‚æœæ˜¯è¦æŸ¥çœ‹çº¿ä¸Šç¨‹åºå“ªä¸ªå¯¹è±¡å ç”¨äº†å¤§é‡å†…å­˜ï¼ˆæ¯”å¦‚åˆ†æå†…å­˜æ³„éœ²ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨jmapã€‚</p>\\n<h1 id=\\\"ç›¸å…³çŸ¥è¯†\\\"><a href=\\\"#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ç›¸å…³çŸ¥è¯†</h1>\\n<p>ä½ å¯èƒ½éœ€è¦äº†è§£jpsï¼Œjinfoï¼Œæ‰“åŒ…jarï¼Œmanifestï¼ŒæŸ¥çœ‹jvmè¿è¡Œå‚æ•°ç­‰ã€‚</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://www.importnew.com/14948.html\\\">http://www.importnew.com/14948.html</a></li>\\n<li><a href=\\\"http://www.cnblogs.com/magialmoon/p/3757767.html\\\">http://www.cnblogs.com/magialmoon/p/3757767.html</a></li>\\n<li><a href=\\\"http://www.oschina.net/question/1_4486\\\">http://www.oschina.net/question/1_4486</a></li>\\n<li><a href=\\\"http://blog.csdn.net/bobpauline/article/details/20699233\\\">http://blog.csdn.net/bobpauline/article/details/20699233</a></li>\\n<li><a href=\\\"http://happyqing.iteye.com/blog/2013639\\\">http://happyqing.iteye.com/blog/2013639</a></li>\\n<li><a href=\\\"http://sunqi.iteye.com/blog/1917802\\\">http://sunqi.iteye.com/blog/1917802</a></li>\\n<li><a href=\\\"http://www.blogjava.net/stone2083/archive/2013/06/08/400410.html\\\">http://www.blogjava.net/stone2083/archive/2013/06/08/400410.html</a></li>\\n<li><a href=\\\"http://yueyemaitian.iteye.com/blog/2033046\\\">http://yueyemaitian.iteye.com/blog/2033046</a></li>\\n<li><a href=\\\"http://www.ibm.com/developerworks/cn/java/j-lo-jse61/index.html\\\">http://www.ibm.com/developerworks/cn/java/j-lo-jse61/index.html</a></li>\\n<li><a href=\\\"http://www.ibm.com/developerworks/cn/java/j-lo-instrumentation/\\\">http://www.ibm.com/developerworks/cn/java/j-lo-instrumentation/</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":2,\"excerpt\":\"ç»å¸¸é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨å†…å­˜é‡Œç¼“å­˜ä¸€æ‰¹æ•°æ®æ¥æé«˜æ•ˆç‡ï¼ˆé¿å…æ¯æ¬¡éƒ½è¯»å–DBï¼‰ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œè¿™äº›å¯¹è±¡åˆ°åº•ä¼šå ç”¨å¤šå¤§å†…å­˜å‘¢ï¼Œè¿™ç›´æ¥å†³å®šäº†å¯ä»¥ç¼“å­˜å¤šå°‘æ¡è®°å½•ï¼Œä»¥åŠä¸Šçº¿ä¹‹åæ˜¯å¦ä¼šå†…å­˜ä¸å¤Ÿç­‰é—®é¢˜ã€‚ æ¥çœ‹å‡ ç§è§£å†³æ–¹æ³•ã€‚ æµ‹è¯• å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ï¼æ¯”å¦‚ä½ è¦æƒ³cache10wâ€¦\",\"fields\":{\"slug\":\"/how-big-is-a-java-object/\"},\"frontmatter\":{\"title\":\"ä¸€ä¸ªJavaå¯¹è±¡åˆ°åº•æœ‰å¤šå¤§\",\"date\":\"2015-06-13\",\"category\":\"Java\",\"tags\":[\"Java\",\"JVM\",\"Javaåå°„\"]}}},{\"node\":{\"html\":\"<p>java5ä¹‹åçš„java.util.concurrentåŒ…æ˜¯ä¸–ç•Œçº§å¹¶å‘å¤§å¸ˆDoug Leaçš„ä½œå“ï¼Œé‡Œé¢ä¸»è¦å®ç°äº†</p>\\n<ol>\\n<li>atomicåŒ…é‡ŒInteger/Longå¯¹åº”çš„åŸå­ç±»ï¼Œä¸»è¦åŸºäºCASï¼›</li>\\n<li>ä¸€äº›åŒæ­¥å­ï¼ŒåŒ…æ‹¬Lockï¼ŒCountDownLatchï¼ŒSemaphoreï¼ŒFutureTaskç­‰ï¼Œè¿™äº›éƒ½æ˜¯åŸºäºAbstractQueuedSynchronizerç±»ï¼›</li>\\n<li>å…³äºçº¿ç¨‹æ‰§è¡Œçš„Executorsç±»ç­‰ï¼›</li>\\n<li>ä¸€äº›å¹¶å‘çš„é›†åˆç±»ï¼Œæ¯”å¦‚ConcurrentHashMapï¼ŒConcurrentLinkedQueueï¼ŒCopyOnWriteArrayListç­‰ã€‚</li>\\n</ol>\\n<p>ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä»‹ç»AbstractQueuedSynchronizerè¿™ä¸ªå¯ä»¥è¯´æ˜¯æœ€æ ¸å¿ƒçš„ç±»ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚æ•´ä¸ªconcurrentåŒ…é‡Œï¼ŒåŸºæœ¬éƒ½ç›´æ¥æˆ–é—´æ¥åœ°ç”¨åˆ°äº†è¿™ä¸ªç±»ã€‚Doug Leaçš„è¿™ç¯‡<a href=\\\"http://gee.cs.oswego.edu/dl/papers/aqs.pdf\\\">è®ºæ–‡</a>é‡Œé¢è®²AQSçš„å®ç°ã€‚</p>\\n<!-- more -->\\n<h1 id=\\\"aqs\\\"><a href=\\\"#aqs\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>AQS</h1>\\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€é—´å±‹é‡Œæœ‰ä¸€ä¸ªå¤§å®¶éƒ½æƒ³è¦å¾—åˆ°çš„ä¼šè®©ä½ å¾ˆçˆ½çš„ä¸œè¥¿ï¼ˆsomething which makes you so happy, e.g. W.Cï¼‰ã€‚å½“æœ‰äººè¿›å»æŠŠé—¨å…³èµ·æ¥åœ¨ç‹¬å äº«ç”¨çš„æ—¶å€™ï¼Œå…¶ä»–äººå°±åªèƒ½åœ¨å¤–é¢æ’é˜Ÿç­‰å¾…ï¼Œæ—¢ç„¶åœ¨ç­‰å¾…ï¼Œä½ å°±ä¸èƒ½è€æ˜¯å»æ•²é—¨è¯´å“ï¼Œå¥½äº†æ²¡æœ‰å•Šã€‚è€æ˜¯è¿™æ ·çš„è¯é‡Œé¢çš„äººå°±å¾ˆä¸çˆ½äº†ï¼Œè€Œä¸”ä½ å¯ä»¥åˆ©ç”¨è¿™ç‚¹ç­‰å¾…æ—¶é—´å¹²ç‚¹åˆ«çš„ï¼Œæ¯”å¦‚çœ‹çœ‹å°è¯´è§†é¢‘èƒŒèƒŒå•è¯æˆ–è€…å°±å¹²è„†æ¤…å­ä¸Šç¡è§‰ï¼Œå½“å‰é¢ç‹¬å çš„äººçˆ½å®Œä¹‹åï¼Œå°±ä¼šå‡ºæ¥è¯´ï¼Œå•Šï¼Œå¥½çˆ½ï¼Œåˆ°ä½ ä»¬äº†ã€‚ç„¶åå¤§å®¶å¯èƒ½æŒ‰ç…§æ’é˜Ÿé¡ºåºè·å–æˆ–è€…å¤§å®¶ç–¯æŠ¢è¿™ä¸ªçŠ¶æ€ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªäººè‡ªå·±è¿›å»ç‹¬å ï¼Œæœ‰å¯èƒ½å‡ ä¸ªäººè¯´ï¼Œå“æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·æ¥ã€‚ç„¶åä»–ä»¬è¿›å»çˆ½ï¼Œçˆ½å®Œä¹‹åå†å‡ºæ¥é€šçŸ¥ä¸‹ä¸€ä¸ªã€‚</p>\\n<p>æˆ‘ä»¬æ¥æŠŠä¸Šé¢è¿™æ®µè¯ç¿»è¯‘æˆAQSé‡Œé¢çš„æœ¯è¯­ã€‚æœ‰ä¸€ä¸ªçŠ¶æ€stateï¼Œä¼šæœ‰å¤šä¸ªThreadå°è¯•è·å–ï¼Œå½“ä¸€ä¸ªThreadç‹¬å ï¼ˆEXCLUSIVEï¼Œæ¯”å¦‚Lockï¼‰ä¹‹åï¼Œå…¶ä»–åé¢åˆ°æ¥çš„Threadå°±ä¼šè¢«æ”¾åˆ°ä¸€ä¸ªQueueçš„é˜Ÿå°¾ï¼ˆtailï¼‰ï¼Œç„¶åç¡çœ ï¼ˆparkï¼‰ï¼Œä¸€ç›´ç­‰åˆ°å‰é¢çš„Threadå”¤é†’ï¼ˆunparkï¼‰å®ƒï¼Œå½“ç„¶è¿™é‡Œæœ‰å¯èƒ½è¢«å‡å”¤é†’ï¼ˆå°±å¥½æ¯”ä½ å®šäº†é—¹é’Ÿ8ç‚¹èµ·åºŠï¼Œç»“æœ7ç‚¹å°±è‡ªç„¶é†’æˆ–è€…è¢«å¤–é¢è½¦åµé†’ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªThreadä¼šåˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯åˆ°è‡ªå·±äº†ï¼Œæ²¡æœ‰çš„è¯å°±ç»§ç»­parkï¼ˆåœ¨ä¸€ä¸ªæ­»å¾ªç¯é‡Œï¼‰ï¼›å½“æ‹¥æœ‰stateçš„Threadé‡Šæ”¾ï¼ˆreleaseï¼‰ä¹‹åï¼Œå®ƒä¼šå”¤é†’Queueä¸­çš„ä¸‹ä¸€ä¸ªThreadï¼ˆunparkSuccessorï¼‰ã€‚ç„¶åä¸‹ä¸€ä¸ªThreadè·å–ï¼ˆacquireï¼‰åˆ°stateï¼Œå®Œæˆè‡ªå·±çš„ä»»åŠ¡ï¼Œç„¶åç»§ç»­unparkSuccessorã€‚å‰é¢ä¸»è¦è¯´çš„æ˜¯EXCLUSIVEæ¨¡å¼ï¼ŒAQSè¿˜æ”¯æŒå…±äº«ï¼ˆSHAREDï¼‰æ¨¡å¼ï¼ŒåŒºåˆ«åœ¨äºå°è¯•è·å–ï¼ˆtryAcquireSharedï¼‰çš„æ—¶å€™å³ä½¿ä¹‹å‰å·²ç»æœ‰Threadè·å–äº†stateï¼Œä½†æ˜¯å¯èƒ½ä»ç„¶èƒ½è·å–ï¼ˆæ¯”å¦‚ReadLockï¼‰ã€‚åŒæ ·é‡Šæ”¾ï¼ˆdoReleaseSharedï¼‰çš„æ—¶å€™é™¤äº†é€šçŸ¥Queueé‡Œé¢ç¬¬ä¸€ä¸ªï¼ˆheadï¼‰ï¼Œè¿˜ä¼šç»§ç»­é€šçŸ¥åç»­çš„èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼Œåªè¦å®ƒä»¬æ˜¯SHAREDã€‚</p>\\n<p>AQSå°±æ˜¯å®ç°äº†ï¼š</p>\\n<ol>\\n<li>è‡ªåŠ¨ç®¡ç†è¿™ä¸ªåŒæ­¥çŠ¶æ€stateï¼ˆintç±»å‹ï¼‰ï¼Œæ›´æ–°çš„æ—¶å€™éœ€è¦ç”¨CASä¿è¯åŸå­æ€§</li>\\n<li>é˜»å¡å’Œå”¤é†’çº¿ç¨‹park/unpark</li>\\n<li>é˜Ÿåˆ—ç®¡ç†ï¼Œä¸€ä¸ªåŒå‘é“¾è¡¨å®ç°queue</li>\\n</ol>\\n<p>AQSæ˜¯ä¸€ä¸ªabstract classï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿AQSï¼Œå®šä¹‰stateçš„å«ä¹‰ï¼Œä»¥åŠtryAcquireï¼ŒtryReleaseï¼Œä»¥åŠå¯¹åº”çš„shareæ¨¡å¼ä¸‹tryAcquireSharedï¼ŒtryReleaseSharedè¿™å‡ ä¸ªæ–¹æ³•ï¼Œå®šä¹‰å‡ºè‡ªå·±æƒ³è¦çš„åŒæ­¥å­ï¼ˆSynchronizersï¼‰ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ˜¯å®šä¹‰ä¸€ä¸ªå†…éƒ¨ç±»Sync extends AQSï¼Œå®ç°å‰é¢è¯´çš„å‡ ä¸ªæ–¹æ³•ï¼Œç„¶åå†åŒ…ä¸€å±‚ï¼Œæš´éœ²å‡ºç›¸åº”çš„æ–¹æ³•ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ä½ å¯ä»¥åœ¨åŒ…è£…å™¨ç±»é‡Œé¢å–æ›´ç›´è§‚çš„åå­—ï¼Œå¦‚ReentrantLocké‡Œçš„lockï¼Œunlockå’ŒCountDownLatché‡Œçš„countDownï¼Œawaitï¼Œè€Œä¸æ˜¯å¤ªé€šç”¨çš„acquireå’Œreleaseç­‰ã€‚è€Œä¸”AQSé‡Œé¢ä¸€äº›æ–¹æ³•æ˜¯ä¸ºäº†ç›‘æ§å’Œè°ƒè¯•ä½¿ç”¨ï¼Œç›´æ¥æš´éœ²å‡ºæ¥ä¹Ÿä¸å¥½ã€‚</p>\\n<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹J.U.Cé‡Œé¢ä¸¤ä¸ªå¸¸ç”¨çš„Synchronizersã€‚</p>\\n<h1 id=\\\"reentrantlock\\\"><a href=\\\"#reentrantlock\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ReentrantLock</h1>\\n<h2 id=\\\"ä½¿ç”¨\\\"><a href=\\\"#%E4%BD%BF%E7%94%A8\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ä½¿ç”¨</h2>\\n<p>ReentrantLockçš„è¯­ä¹‰è·Ÿsynchronizedå…³é”®å­—åŸºæœ¬ä¸€æ ·ï¼Œè€Œä¸”æˆ‘ä¹‹å‰çœ‹<a href=\\\"http://book.douban.com/subject/6522893/\\\">ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹</a>é‡Œé¢çš„è¯„æµ‹è¯´JDK6ä¹‹åï¼Œä¸¤è€…çš„æ•ˆç‡åŸºæœ¬ä¸€è‡´äº†ï¼ˆJDK5ä¹‹å‰ReentrantLockè¦æ¯”synchronizedå¿«å¾ˆå¤šï¼‰ã€‚Javadocé‡Œé¢è¯´åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">X</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">final</span> ReentrantLock lock <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">ReentrantLock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token comment\\\">// ...</span>\\n  <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">m</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    lock<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// block until condition holds</span>\\n    <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token comment\\\">// ... method body</span>\\n    <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n      lock<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">unlock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<h2 id=\\\"æºç \\\"><a href=\\\"#%E6%BA%90%E7%A0%81\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æºç </h2>\\n<p>ReentrantLockç”¨stateè¡¨ç¤ºæ˜¯å¦è¢«é”ï¼Œ0è¡¨ç¤ºæ²¡æœ‰çº¿ç¨‹è·å–åˆ°é”ï¼Œ>=1è¡¨ç¤ºæŸä¸ªçº¿ç¨‹è·å–äº†Næ¬¡é”ï¼ˆå› ä¸ºæ˜¯é‡å…¥çš„ï¼Œåªè¦ä¿è¯lockå’Œunlockæˆå¯¹å‡ºç°å°±æ²¡æœ‰é—®é¢˜ï¼‰ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token comment\\\">/** Synchronizer providing all implementation mechanics */</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">final</span> Sync sync<span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">abstract</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Sync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">AbstractQueuedSynchronizer</span> <span class=\\\"token punctuation\\\">{</span></code></pre>\\n      </div>\\n<p>å®šä¹‰äº†ä¸€ä¸ªå†…éƒ¨ç±»ï¼ŒåŸºæœ¬ä»»åŠ¡éƒ½ä»£ç†ç»™syncå®Œæˆã€‚è€ŒSyncåˆæ˜¯ä¸€ä¸ªabstract classï¼Œè¿™é‡Œä¸»è¦æ˜¯å› ä¸ºå®ç°äº†ä¸¤ç§æŠ¢å é”çš„æœºåˆ¶ï¼Œå…¬å¹³é”å’Œéå…¬å¹³é”ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">FairSync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Sync</span>\\n\\t\\n\\t<span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">NonfairSync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Sync</span></code></pre>\\n      </div>\\n<p>æ‰€è°“å…¬å¹³ä¸å…¬å¹³ç®€å•æ¥è¯´å°±æ˜¯æœ¬æ–‡å¼€å¤´è¯´çš„ï¼Œå½“èµ„æºé‡Šæ”¾çš„æ—¶å€™ï¼Œå¤§å®¶æ˜¯æŒ‰ç…§æ’é˜Ÿé¡ºåºå…ˆåˆ°å…ˆå¾—ï¼Œè¿˜æ˜¯æœ‰äººæ’é˜Ÿå¤§å®¶ç–¯æŠ¢ã€‚</p>\\n<p>æä¾›äº†ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">ReentrantLock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">NonfairSync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é»˜è®¤éå…¬å¹³é”ï¼ŒAQSè®ºæ–‡è¯´éå…¬å¹³é”æ•ˆç‡é«˜äº›ï¼Œç†ç”±å…¶å®å¾ˆç®€å•ï¼Œå…¬å¹³é”é€šçŸ¥é˜Ÿåˆ—ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¦æŠŠå®ƒå”¤é†’ï¼Œè€Œå”¤é†’æ˜¯éœ€è¦æ—¶é—´çš„ï¼Œåœ¨é”é‡Šæ”¾åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è¢«å”¤é†’è¿™æ®µæ—¶é—´å…¶å®é”æ˜¯å¯ä»¥ç”¨ä½†æ˜¯æ²¡æœ‰è¢«ç”¨çš„ï¼ˆavailable but not usedï¼‰ï¼›è€Œéå…¬å¹³é”ï¼Œé‡Šæ”¾äº†ä¹‹åç«‹é©¬å°±å¯ä»¥è¢«åˆ«äººç”¨ï¼Œæ‰€ä»¥æé«˜äº†æ•ˆç‡ï¼Œä½†æ˜¯æœ‰å¯èƒ½å¯¼è‡´é¥¥é¥¿é”ï¼Œè¿™ä¸ªå°±è¦å…·ä½“çœ‹ä¸šåŠ¡éœ€æ±‚äº†ã€‚</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">ReentrantLock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">boolean</span> fair<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync <span class=\\\"token operator\\\">=</span> fair <span class=\\\"token operator\\\">?</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">FairSync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">NonfairSync</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æŒ‡å®šå…¬å¹³ä¸å¦</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>åŠ é”çš„å®ç°</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ç®€å•ä»£ç†ç»™äº†syncï¼Œåœ¨FairSyncé‡Œä¸º</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\t\\t<span class=\\\"token function\\\">acquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\t<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>acquireçš„å®ç°åœ¨AQSé‡Œé¢ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">acquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n            <span class=\\\"token function\\\">acquireQueued</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node<span class=\\\"token punctuation\\\">.</span>EXCLUSIVE<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token function\\\">selfInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>tryAcquireæ˜¯è¦åœ¨å­ç±»é‡Œè‡ªå·±å®ç°çš„ï¼Œåœ¨FairSyncå¦‚ä¸‹;</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t <span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">final</span> Thread current <span class=\\\"token operator\\\">=</span> Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//0è¡¨ç¤ºé”æ²¡æœ‰è¢«çº¿ç¨‹ç”¨ï¼Œ1è¡¨ç¤ºå·²ç»æœ‰çº¿ç¨‹å ç”¨</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">hasQueuedPredecessors</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token comment\\\">//åˆ¤æ–­è‡ªå·±æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå®ç°å…¬å¹³</span>\\n                    <span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> acquires<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//CASæ›´æ–°çŠ¶æ€</span>\\n                    <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>current<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è®¾ç½®å½“å‰çº¿ç¨‹æ‹¥æœ‰çŠ¶æ€</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">else</span> <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>current <span class=\\\"token operator\\\">==</span> <span class=\\\"token function\\\">getExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//1è¡¨ç¤ºå·²ç»æœ‰çº¿ç¨‹å ç”¨ï¼Œå†åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦è¢«å½“å‰çº¿ç¨‹å ç”¨ï¼Œæ¥å®ç°é‡å…¥ï¼ˆReentrantï¼‰ç‰¹æ€§</span>\\n                <span class=\\\"token keyword\\\">int</span> nextc <span class=\\\"token operator\\\">=</span> c <span class=\\\"token operator\\\">+</span> acquires<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nextc <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Error</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Maximum lock count exceeded\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span>nextc<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æ›´æ–°çŠ¶æ€</span>\\n                <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¦‚æœè·å–å¤±è´¥ï¼ŒaddWaiter(Node.EXCLUSIVE)å°†å½“å‰çº¿ç¨‹åŠ å…¥é˜Ÿå°¾</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">private</span> Node <span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node mode<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        Node node <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Node</span><span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> mode<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//ç”¨å½“å‰çº¿ç¨‹æ„é€ Nodeï¼Œç‹¬å æ¨¡å¼</span>\\n        <span class=\\\"token comment\\\">// Try the fast path of enq; backup to full enq on failure</span>\\n        Node pred <span class=\\\"token operator\\\">=</span> tail<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>pred <span class=\\\"token operator\\\">!=</span> null<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            node<span class=\\\"token punctuation\\\">.</span>prev <span class=\\\"token operator\\\">=</span> pred<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetTail</span><span class=\\\"token punctuation\\\">(</span>pred<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å¿«é€Ÿåˆ¤æ–­ï¼ŒCASæ›´æ–°tailèŠ‚ç‚¹</span>\\n                pred<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">return</span> node<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token function\\\">enq</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¦‚æœå¤±è´¥ï¼Œè¿›å…¥enqæ–¹æ³•</span>\\n        <span class=\\\"token keyword\\\">return</span> node<span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n    \\n\\t <span class=\\\"token keyword\\\">private</span> Node <span class=\\\"token function\\\">enq</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">final</span> Node node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            Node t <span class=\\\"token operator\\\">=</span> tail<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>t <span class=\\\"token operator\\\">==</span> null<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">// Must initialize</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetHead</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Node</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//å¦‚æœè¿˜æ²¡æœ‰headï¼ŒCASåˆå§‹åŒ–ä¸€ä¸ªhead</span>\\n                    tail <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//è¿™æ®µä»£ç è·ŸaddWaiteré‡Œä¸€æ ·ï¼ŒCASæ›´æ–°tailèŠ‚ç‚¹</span>\\n                node<span class=\\\"token punctuation\\\">.</span>prev <span class=\\\"token operator\\\">=</span> t<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetTail</span><span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    t<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">return</span> t<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ç°åœ¨æˆ‘ä»¬å·²ç»å°†è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥é˜Ÿå°¾äº†ï¼Œç°åœ¨è¦å°†å®ƒæŒ‚èµ·acquireQueued(addWaiter(Node.EXCLUSIVE), arg))ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">acquireQueued</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">final</span> Node node<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">boolean</span> failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">boolean</span> interrupted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//åœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ï¼Œé¿å…å‡å”¤é†’</span>\\n                <span class=\\\"token keyword\\\">final</span> Node p <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">predecessor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è·å–å½“å‰èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯headè¯´æ˜è‡ªå·±æ˜¯ç¬¬ä¸€ä¸ªå¯ä»¥è·å–èµ„æºçš„çº¿ç¨‹ï¼Œå®ç°å…¬å¹³</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>p <span class=\\\"token operator\\\">==</span> head <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//æ˜¯ç¬¬ä¸€ä¸ªå¯ä»¥è·å–èµ„æºçš„çº¿ç¨‹å¹¶ä¸”å°è¯•è·å–æˆåŠŸ</span>\\n                    <span class=\\\"token function\\\">setHead</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    p<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// help GC</span>\\n                    failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">return</span> interrupted<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">shouldParkAfterFailedAcquire</span><span class=\\\"token punctuation\\\">(</span>p<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                    <span class=\\\"token function\\\">parkAndCheckInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//æ²¡æœ‰è·å–åˆ°èµ„æºï¼Œç¡çœ parkå»</span>\\n                    interrupted <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>failed<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">cancelAcquire</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">parkAndCheckInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        LockSupport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">park</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ä¸Šé¢å®Œæˆäº†è·å–é”çš„è¿‡ç¨‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯å°è¯•è·å–ï¼Œå¤±è´¥å°±åŠ å…¥é˜Ÿå°¾ï¼ŒæŒ‚èµ·ï¼Œç­‰å¾…è¢«å”¤é†’ã€‚</p>\\n<p>ä¸‹é¢æ¥çœ‹çœ‹é‡Šæ”¾é”</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">unlock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">release</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//ä»£ç†ç»™syncï¼Œè°ƒç”¨AQSçš„release</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">//ä¸‹é¢ä»£ç åœ¨AQSä¸­</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">release</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">tryRelease</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å°è¯•é‡Šæ”¾èµ„æºï¼Œéœ€è¦åœ¨å­ç±»é‡Œå®ç°</span>\\n            Node h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">!=</span> null <span class=\\\"token operator\\\">&amp;&amp;</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">!=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">unparkSuccessor</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é€šçŸ¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">unparkSuccessor</span><span class=\\\"token punctuation\\\">(</span>Node node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token comment\\\">/*\\n         * If status is negative (i.e., possibly needing signal) try\\n         * to clear in anticipation of signalling.  It is OK if this\\n         * fails or if status is changed by waiting thread.\\n         */</span>\\n        <span class=\\\"token keyword\\\">int</span> ws <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span>waitStatus<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>ws <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token function\\\">compareAndSetWaitStatus</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">,</span> ws<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token comment\\\">/*\\n         * Thread to unpark is held in successor, which is normally\\n         * just the next node.  But if cancelled or apparently null,\\n         * traverse backwards from tail to find the actual\\n         * non-cancelled successor.\\n         */</span>\\n         <span class=\\\"token comment\\\">// ä¸»è¦åœ¨è¿™é‡Œæ‰¾åˆ°ä¸‹ä¸€ä¸ªéœ€è¦é€šçŸ¥çš„èŠ‚ç‚¹ï¼Œå¦‚æœnode.nextå°±æ˜¯éœ€è¦é€šçŸ¥çš„èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥é€šçŸ¥ï¼›å¦åˆ™ï¼Œå¯èƒ½node.next == nullï¼ˆåŸå› æ˜¯åŒå‘é“¾è¡¨è®¾ç½®b.pre = aå’Œa.next = bçš„æ—¶å€™ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œåªèƒ½ä¿è¯b.pre = aæˆåŠŸï¼Œè¿™æ—¶å€™å¦ä¸€æ¡çº¿ç¨‹å¯èƒ½çœ‹åˆ°a.next == nullï¼‰æˆ–è€…s.waitStatus > 0ï¼ˆåŸå› æ˜¯çº¿ç¨‹ç­‰ä¸åŠè¢«å–æ¶ˆäº†static final int CANCELLED = 1;ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ä»é˜Ÿå°¾tailå¼€å§‹æ‰¾ï¼Œæ‰¾åˆ°ç¦»é˜Ÿå¤´headæœ€è¿‘çš„ä¸€ä¸ªéœ€è¦é€šçŸ¥çš„èŠ‚ç‚¹Nodeã€‚</span>\\n        Node s <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span>next<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>s <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> s<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">></span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            s <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span>Node t <span class=\\\"token operator\\\">=</span> tail<span class=\\\"token punctuation\\\">;</span> t <span class=\\\"token operator\\\">!=</span> null <span class=\\\"token operator\\\">&amp;&amp;</span> t <span class=\\\"token operator\\\">!=</span> node<span class=\\\"token punctuation\\\">;</span> t <span class=\\\"token operator\\\">=</span> t<span class=\\\"token punctuation\\\">.</span>prev<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>t<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">&lt;=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                    s <span class=\\\"token operator\\\">=</span> t<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>s <span class=\\\"token operator\\\">!=</span> null<span class=\\\"token punctuation\\\">)</span>\\n            LockSupport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">unpark</span><span class=\\\"token punctuation\\\">(</span>s<span class=\\\"token punctuation\\\">.</span>thread<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å”¤é†’çº¿ç¨‹</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>çœ‹çœ‹éœ€è¦åœ¨å­ç±»é‡Œå®ç°çš„tryReleaseï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t<span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryRelease</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> releases<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">-</span> releases<span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é‡Šæ”¾é”ï¼Œstateå‡å»ç›¸åº”çš„å€¼</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">!=</span> <span class=\\\"token function\\\">getExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">IllegalMonitorStateException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é¿å…Açº¿ç¨‹é”äº†ä¹‹åï¼ŒBçº¿ç¨‹æ•…æ„æ£ä¹±é‡Šæ”¾é”</span>\\n            <span class=\\\"token keyword\\\">boolean</span> free <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å½“å‰çº¿ç¨‹å·²ç»å®Œå…¨é‡Šæ”¾äº†é”</span>\\n                free <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>null<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//é‡Šæ”¾é”çš„æ‹¥æœ‰è€…</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span>c<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è®¾ç½®çŠ¶æ€ï¼Œè¿™ä¸ªæ–¹é¢æ²¡æœ‰åŒæ­¥ï¼Œæ²¡æœ‰CASï¼Œæœ‰åŒå­¦é—®è¿‡å²‚ä¸æ˜¯æœ‰çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼Ÿå…¶å®åˆ°è¿™é‡Œï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å¹¶å‘é”™è¯¯ï¼Œä»”ç»†æƒ³æƒ³ï¼Œæ˜¯å§ï¼Ÿæ˜¯å§ï¼Ÿ</span>\\n            <span class=\\\"token keyword\\\">return</span> free<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬éƒ½å·²ç»å®Œæˆï¼Œå¯¹äº†ï¼Œè¿˜æ²¡æœ‰è¯´éå…¬å¹³é”NonfairSyncæ˜¯æ€ä¹ˆæŠ¢å é”çš„ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">lock</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//å…ˆæŠ¢ä¸€æŠŠï¼ˆæ’é˜Ÿï¼‰ï¼Œä¸‡ä¸€æˆåŠŸäº†å°±ä¸æ’é˜Ÿï¼Œä¸å…¬å¹³æ€§å°±ä½“ç°åœ¨è¿™é‡Œï¼</span>\\n                <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">else</span>\\n                <span class=\\\"token function\\\">acquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>è·ŸFairSync.lock()å¯¹æ¯”ï¼Œå¯ä»¥çœ‹å‡ºï¼Œåªæ˜¯åœ¨acquire(1)ä¹‹å‰ï¼Œå…ˆæŠ¢ä¸€æŠŠï¼ŒæŠ¢ä¸åˆ°æ‰ä¹–ä¹–çš„å»æ’é˜Ÿã€‚</p>\\n<p>æˆ‘ä»¬å†çœ‹çœ‹NonfairSync.tryAcquire()æ€ä¹ˆå®ç°çš„</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t\\t<span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryAcquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token function\\\">nonfairTryAcquire</span><span class=\\\"token punctuation\\\">(</span>acquires<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è°ƒç”¨çˆ¶ç±»æ–¹æ³•nonfairTryAcquire</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t\\t<span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">nonfairTryAcquire</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">final</span> Thread current <span class=\\\"token operator\\\">=</span> Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> acquires<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//è·ŸFairSync.tryAcquireåªæœ‰è¿™é‡Œä¸€è¡Œæœ‰å·®å¼‚ï¼Œå³å°‘äº†!hasQueuedPredecessors()ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åˆ¤æ–­å‰é¢æœ‰æ²¡æœ‰äººï¼Œä»»ä½•æ—¶å€™åªè¦å®ƒé†’æ¥ï¼Œéƒ½ä¼šå»æŠ¢ï¼Œæ‰€ä»¥ä¸å…¬å¹³ï¼============åˆšåˆçœ‹äº†ä¸€éï¼Œå‘ç°å…¶å®final boolean acquireQueued(final Node node, int arg)æ–¹æ³•é‡Œå·²ç»æœ‰node.predecessor() == headçš„åˆ¤æ–­ï¼Œæ„Ÿè§‰è¿™ä¸ªä¸å…¬å¹³çš„tryAcquireè²Œä¼¼æ²¡æœ‰æ„ä¹‰ï¼Œå„ä½çœ‹å®˜æ€ä¹ˆçœ‹å‘¢ï¼Œè¯·ç•™è¨€å“ˆï¼Œè°¢è°¢~</span>\\n                    <span class=\\\"token function\\\">setExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span>current<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">else</span> <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>current <span class=\\\"token operator\\\">==</span> <span class=\\\"token function\\\">getExclusiveOwnerThread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">int</span> nextc <span class=\\\"token operator\\\">=</span> c <span class=\\\"token operator\\\">+</span> acquires<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nextc <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">// overflow</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Error</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"Maximum lock count exceeded\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token function\\\">setState</span><span class=\\\"token punctuation\\\">(</span>nextc<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<h1 id=\\\"countdownlatch\\\"><a href=\\\"#countdownlatch\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>CountDownLatch</h1>\\n<p>æˆ‘ä»¬ä¹‹å‰è¯´äº†ï¼ŒAQSæ”¯æŒç‹¬å EXCLUSIVEå’Œå…±äº«SHAREDä¸¤ç§æ¨¡å¼ï¼Œè€Œåˆšåˆšçš„ReentrantLockçš„å°±æ˜¯ç‹¬å æ¨¡å¼ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªä½¿ç”¨å…±äº«æ¨¡å¼çš„ç±»ã€‚</p>\\n<h2 id=\\\"ä½¿ç”¨-1\\\"><a href=\\\"#%E4%BD%BF%E7%94%A8-1\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>ä½¿ç”¨</h2>\\n<p>CountDownLatchå°±å¥½æ¯”ä¸€é“é—¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥ç­‰æ‰€æœ‰èµ„æºéƒ½åˆ°é½äº†ï¼Œæ‰å¼€é—¨ï¼Œè®©è¿™äº›çº¿ç¨‹åŒæ—¶é€šè¿‡ã€‚æ¯”å¦‚å¦‚ä¸‹æ˜¯CountDownLatchä¸€ä¸ªé€šç”¨ç”¨æ³•ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\"><span class=\\\"token keyword\\\">package</span> concurrentStudy<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">import</span> java<span class=\\\"token punctuation\\\">.</span>util<span class=\\\"token punctuation\\\">.</span>concurrent<span class=\\\"token punctuation\\\">.</span>CountDownLatch<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * Created by magicalli on 2014/12/13.\\n */</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">IndexPlusPlusTest01</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">int</span> NThreads <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">10</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">// çº¿ç¨‹æ•°</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">int</span> M <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">100000</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¾ªç¯æ¬¡æ•°ï¼Œå¤ªå°çš„è¯ï¼ˆæ¯”å¦‚10ï¼‰å¯èƒ½çœ‹ä¸å‡ºæ¥æ•ˆæœ</span>\\n    <span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">volatile</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">int</span> n <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//åŠ volatileçš„ç›®çš„æ˜¯ä¸ºäº†è¯æ˜volatileæ²¡æœ‰â€œåŸå­æ€§â€ï¼</span>\\n\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">main</span><span class=\\\"token punctuation\\\">(</span>String<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span> args<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">final</span> CountDownLatch startGate <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">CountDownLatch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">final</span> CountDownLatch endGate <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">CountDownLatch</span><span class=\\\"token punctuation\\\">(</span>NThreads<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> i <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;</span> NThreads<span class=\\\"token punctuation\\\">;</span> i<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Thread</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Runnable</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token annotation punctuation\\\">@Override</span>\\n                <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">run</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n                        startGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æ‰€æœ‰çº¿ç¨‹startä¹‹åç­‰å¾…â€œé—¨â€œæ‰“å¼€ï¼Œä¿è¯åŒæ—¶çœŸæ­£å¼€å§‹è¿è¡Œ</span>\\n                    <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">catch</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token class-name\\\">InterruptedException</span> e<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        e<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">printStackTrace</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n\\n                    <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> j <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> j <span class=\\\"token operator\\\">&lt;</span> M<span class=\\\"token punctuation\\\">;</span> j<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        n <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n\\n                    endGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">countDown</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">start</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n\\n        startGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">countDown</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//æ‰“å¼€â€œé—¨â€ï¼Œè®©æ‰€æœ‰çº¿ç¨‹åŒæ—¶runèµ·æ¥</span>\\n        <span class=\\\"token keyword\\\">long</span> t1 <span class=\\\"token operator\\\">=</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentTimeMillis</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        endGate<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//ç­‰æ‰€æœ‰çº¿ç¨‹éƒ½ç»“æŸä¹‹åæ‰æ‰“å°nï¼Œå¦åˆ™æ€»æ˜¯ä¼šæ‰“å‡ºé”™è¯¯çš„nï¼›æˆ‘è§è¿‡è¿™é‡Œç”¨Thread.sleep()ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºï¼Œä½ æ€ä¹ˆçŸ¥é“è¯¥ç­‰å¤šä¹…æ‰èƒ½ä¿è¯æ‰€æœ‰çº¿ç¨‹ç»“æŸä»¥åŠåˆšå¥½ç»“æŸå‘¢ï¼Ÿï¼</span>\\n        <span class=\\\"token keyword\\\">long</span> t2 <span class=\\\"token operator\\\">=</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">currentTimeMillis</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"cost time: \\\"</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token punctuation\\\">(</span>t2 <span class=\\\"token operator\\\">-</span> t1<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        System<span class=\\\"token punctuation\\\">.</span>out<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">println</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"n: \\\"</span> <span class=\\\"token operator\\\">+</span> n<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¯¹äº†ï¼Œä¸Šé¢ä»£ç æ˜¯æ‹¿æ¥éªŒè¯volatileä¸å…·å¤‡åŸå­æ€§çš„ï¼Œæ˜¯é”™è¯¯çš„ä»£ç å“¦ã€‚å¦‚æœæƒ³å¹¶å‘å®‰å…¨ï¼Œå¤§å®¶å¯ä»¥æƒ³æƒ³å¯ä»¥ç”¨å“ªäº›æ–¹å¼å®ç°ã€‚</p>\\n<h2 id=\\\"æºç -1\\\"><a href=\\\"#%E6%BA%90%E7%A0%81-1\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æºç </h2>\\n<p>CountDownLatchåŒæ ·ä¹Ÿæ˜¯å®šä¹‰äº†ä¸€ä¸ªç»§æ‰¿è‡ªAQSçš„å†…éƒ¨ç±»Syncï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Sync</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">AbstractQueuedSynchronizer</span></code></pre>\\n      </div>\\n<p>æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token function\\\">CountDownLatch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> count<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>count <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">IllegalArgumentException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"count &lt; 0\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>sync <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Sync</span><span class=\\\"token punctuation\\\">(</span>count<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>countè¡¨ç¤ºæœ‰å¤šå°‘ä¸ªä»»åŠ¡è¿˜åœ¨è¿è¡Œï¼Œæ¯ä¸ªThreadå®Œæˆäº†ä»»åŠ¡æˆ–è€…å‡†å¤‡å¥½å¼€å§‹ä¹‹å‰ï¼Œå°±ä¼šè°ƒç”¨countDownæ–¹æ³•å°†count-1ï¼Œå½“count==0æ—¶å€™ï¼Œawaitå°±ä¸å†é˜»å¡ï¼Œæ‰€æœ‰åœ¨ä¸Šé¢é˜»å¡çš„Threadéƒ½å¯ä»¥é¡ºåˆ©é€šè¿‡ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">acquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>ç›´æ¥è°ƒç”¨AQSçš„acquireSharedInterruptiblyæ–¹æ³•ï¼Œä»æ–¹æ³•åå¯ä»¥çœ‹å‡ºï¼Œæ”¯æŒä¸­æ–­å“åº”</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">acquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å“åº”ä¸­æ–­</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token function\\\">doAcquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>tryAcquireSharedåœ¨å­ç±»ä¸­å®ç°ï¼š</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">        <span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">int</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> acquires<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">?</span> <span class=\\\"token number\\\">1</span> <span class=\\\"token operator\\\">:</span> <span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¦‚æœstateä¸º0ï¼Œè¯´æ˜æ‰€æœ‰Threadå®Œæˆä»»åŠ¡ï¼Œå¯ä»¥ä¸é˜»å¡äº†</span>\\n        <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¦‚æœæ²¡æœ‰è·å–åˆ°ï¼Œå°†ThreadåŠ å…¥é˜Ÿå°¾ï¼ŒæŒ‚èµ·ã€‚ä¸‹é¢è¿™ä¸ªæ–¹æ³•è·Ÿç‹¬å æ¨¡å¼ä¸‹acquireQueued(addWaiter(Node.EXCLUSIVE), arg))è¿™ä¸ªæ–¹æ³•ä»£ç æ˜¯åŸºæœ¬ä¸€è‡´çš„ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">doAcquireSharedInterruptibly</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">final</span> Node node <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node<span class=\\\"token punctuation\\\">.</span>SHARED<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å…±äº«æ¨¡å¼</span>\\n        <span class=\\\"token keyword\\\">boolean</span> failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">final</span> Node p <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">predecessor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>p <span class=\\\"token operator\\\">==</span> head<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">int</span> r <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>r <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        <span class=\\\"token function\\\">setHeadAndPropagate</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">,</span> r<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è·ŸEXCLUSIVEçš„ä¸€å¤§åŒºåˆ«</span>\\n                        p<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// help GC</span>\\n                        failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token keyword\\\">return</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">shouldParkAfterFailedAcquire</span><span class=\\\"token punctuation\\\">(</span>p<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                    <span class=\\\"token function\\\">parkAndCheckInterrupt</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å“åº”ä¸­æ–­ï¼Œè¿™é‡Œç›´æ¥æŠ›å¼‚å¸¸</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>failed<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">cancelAcquire</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">setHeadAndPropagate</span><span class=\\\"token punctuation\\\">(</span>Node node<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">int</span> propagate<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        Node h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// Record old head for check below</span>\\n        <span class=\\\"token function\\\">setHead</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token comment\\\">/*\\n         * Try to signal next queued node if:\\n         *   Propagation was indicated by caller,\\n         *     or was recorded (as h.waitStatus either before\\n         *     or after setHead) by a previous operation\\n         *     (note: this uses sign-check of waitStatus because\\n         *      PROPAGATE status may transition to SIGNAL.)\\n         * and\\n         *   The next node is waiting in shared mode,\\n         *     or we don't know, because it appears null\\n         *\\n         * The conservatism in both of these checks may cause\\n         * unnecessary wake-ups, but only when there are multiple\\n         * racing acquires/releases, so most need signals now or soon\\n         * anyway.\\n         */</span>\\n         <span class=\\\"token comment\\\">// å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯æ„¿æ„å…±äº«ï¼Œå¹¶ä¸”ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿæ˜¯æ„¿æ„å…±äº«çš„ï¼Œé‚£ä¹ˆå°±è¿›å…¥doReleaseSharedï¼Œå”¤é†’ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸‹é¢ä¼šè¯¦è§£</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>propagate <span class=\\\"token operator\\\">></span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">||</span> h <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">||</span>\\n            <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            Node s <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span>next<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>s <span class=\\\"token operator\\\">==</span> null <span class=\\\"token operator\\\">||</span> s<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">isShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">doReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å‰é¢å®Œæˆäº†ç­‰å¾…CountDownLatchçš„countå˜æˆ0çš„è¿‡ç¨‹ï¼Œä¸‹é¢çœ‹çœ‹countDown</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">countDown</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">releaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è°ƒç”¨AQSçš„</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token comment\\\">// AQSä¸­</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">releaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">tryReleaseShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token comment\\\">//å°è¯•é‡Šæ”¾ï¼Œéœ€è¦åœ¨å­ç±»ä¸­å®ç°</span>\\n            <span class=\\\"token function\\\">doReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//çœŸæ­£é‡Šæ”¾</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t\\t<span class=\\\"token comment\\\">// Syncå­ç±»ä¸­å®ç°</span>\\n\\t    <span class=\\\"token keyword\\\">protected</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> releases<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token comment\\\">// Decrement count; signal when transition to zero</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">int</span> c <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">getState</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>c <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">int</span> nextc <span class=\\\"token operator\\\">=</span> c<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">compareAndSetState</span><span class=\\\"token punctuation\\\">(</span>c<span class=\\\"token punctuation\\\">,</span> nextc<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">// åœ¨æ­»å¾ªç¯ä¸­CASå°†count-1</span>\\n                    <span class=\\\"token keyword\\\">return</span> nextc <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        \\n    <span class=\\\"token comment\\\">// AQSä¸­</span>\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">void</span> <span class=\\\"token function\\\">doReleaseShared</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token comment\\\">/*\\n         * Ensure that a release propagates, even if there are other\\n         * in-progress acquires/releases.  This proceeds in the usual\\n         * way of trying to unparkSuccessor of head if it needs\\n         * signal. But if it does not, status is set to PROPAGATE to\\n         * ensure that upon release, propagation continues.\\n         * Additionally, we must loop in case a new node is added\\n         * while we are doing this. Also, unlike other uses of\\n         * unparkSuccessor, we need to know if CAS to reset status\\n         * fails, if so rechecking.\\n         */</span>\\n        <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            Node h <span class=\\\"token operator\\\">=</span> head<span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">!=</span> null <span class=\\\"token operator\\\">&amp;&amp;</span> h <span class=\\\"token operator\\\">!=</span> tail<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">int</span> ws <span class=\\\"token operator\\\">=</span> h<span class=\\\"token punctuation\\\">.</span>waitStatus<span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>ws <span class=\\\"token operator\\\">==</span> Node<span class=\\\"token punctuation\\\">.</span>SIGNAL<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">compareAndSetWaitStatus</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">,</span> Node<span class=\\\"token punctuation\\\">.</span>SIGNAL<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                        <span class=\\\"token keyword\\\">continue</span><span class=\\\"token punctuation\\\">;</span>            <span class=\\\"token comment\\\">// loop to recheck cases</span>\\n                    <span class=\\\"token function\\\">unparkSuccessor</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//éå†queueï¼Œé€šçŸ¥æ‰€æœ‰SHAREDçš„èŠ‚ç‚¹ï¼Œå› ä¸ºæ˜¯å…±äº«æ¨¡å¼ï¼Œè¿™äº›Nodeéƒ½åº”è¯¥è¢«å”¤é†’ï¼Œç›´åˆ°é‡åˆ°æŸä¸ªEXCLUSIVEçš„Node</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token keyword\\\">else</span> <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>ws <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                         <span class=\\\"token operator\\\">!</span><span class=\\\"token function\\\">compareAndSetWaitStatus</span><span class=\\\"token punctuation\\\">(</span>h<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> Node<span class=\\\"token punctuation\\\">.</span>PROPAGATE<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">continue</span><span class=\\\"token punctuation\\\">;</span>                <span class=\\\"token comment\\\">// loop on failed CAS</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>h <span class=\\\"token operator\\\">==</span> head<span class=\\\"token punctuation\\\">)</span>                   <span class=\\\"token comment\\\">// loop if head changed</span>\\n                <span class=\\\"token keyword\\\">break</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>unparkSuccessorè·Ÿä¹‹å‰ç‹¬å æ¨¡å¼é‡Œé¢çš„æ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œå³è°ƒç”¨unparkå”¤é†’Threadã€‚</p>\\n<p>æˆ‘ä»¬çŸ¥é“ä¸ºäº†é¿å…è·å–ä¸åˆ°é”é•¿æ—¶é—´ç­‰å¾…ï¼Œä¸€èˆ¬é˜»å¡çš„æ–¹æ³•éƒ½ä¼šæ”¯æŒå¸¦è¶…æ—¶æ—¶é—´çš„æ–¹æ³•ï¼Œæ¯”å¦‚CountDownLatché‡Œå°±æœ‰</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">await</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">long</span> timeout<span class=\\\"token punctuation\\\">,</span> TimeUnit unit<span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span> sync<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">tryAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> unit<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toNanos</span><span class=\\\"token punctuation\\\">(</span>timeout<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>è°ƒç”¨AQSé‡Œé¢çš„tryAcquireSharedNanosæ–¹æ³•</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">tryAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">long</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span> <span class=\\\"token operator\\\">||</span>\\n            <span class=\\\"token function\\\">doAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">,</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n\\n\\t<span class=\\\"token keyword\\\">private</span> <span class=\\\"token keyword\\\">boolean</span> <span class=\\\"token function\\\">doAcquireSharedNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">int</span> arg<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">long</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">throws</span> InterruptedException <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nanosTimeout <span class=\\\"token operator\\\">&lt;=</span> <span class=\\\"token number\\\">0</span>L<span class=\\\"token punctuation\\\">)</span>\\n            <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">long</span> deadline <span class=\\\"token operator\\\">=</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">nanoTime</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> nanosTimeout<span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">final</span> Node node <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">addWaiter</span><span class=\\\"token punctuation\\\">(</span>Node<span class=\\\"token punctuation\\\">.</span>SHARED<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">boolean</span> failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">try</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">final</span> Node p <span class=\\\"token operator\\\">=</span> node<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">predecessor</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>p <span class=\\\"token operator\\\">==</span> head<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                    <span class=\\\"token keyword\\\">int</span> r <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">tryAcquireShared</span><span class=\\\"token punctuation\\\">(</span>arg<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>r <span class=\\\"token operator\\\">>=</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        <span class=\\\"token function\\\">setHeadAndPropagate</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">,</span> r<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                        p<span class=\\\"token punctuation\\\">.</span>next <span class=\\\"token operator\\\">=</span> null<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// help GC</span>\\n                        failed <span class=\\\"token operator\\\">=</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">}</span>\\n                nanosTimeout <span class=\\\"token operator\\\">=</span> deadline <span class=\\\"token operator\\\">-</span> System<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">nanoTime</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>nanosTimeout <span class=\\\"token operator\\\">&lt;=</span> <span class=\\\"token number\\\">0</span>L<span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token boolean\\\">false</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//å¦‚æœå·²ç»æ²¡æ—¶é—´äº†ï¼Œç›´æ¥return false</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">shouldParkAfterFailedAcquire</span><span class=\\\"token punctuation\\\">(</span>p<span class=\\\"token punctuation\\\">,</span> node<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">&amp;&amp;</span>\\n                    nanosTimeout <span class=\\\"token operator\\\">></span> spinForTimeoutThreshold<span class=\\\"token punctuation\\\">)</span><span class=\\\"token comment\\\">//å¤§äºæŸä¸ªé˜ˆå€¼ï¼Œæ‰parkï¼Œå¦åˆ™è¿›å…¥è‡ªæ—‹</span>\\n                    LockSupport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">parkNanos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">,</span> nanosTimeout<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span><span class=\\\"token comment\\\">//è°ƒç”¨å¸¦è¶…æ—¶çš„parkæ–¹æ³•</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Thread<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">interrupted</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                    <span class=\\\"token keyword\\\">throw</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">InterruptedException</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">finally</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>failed<span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token function\\\">cancelAcquire</span><span class=\\\"token punctuation\\\">(</span>node<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·Ÿä¸å¸¦è¶…æ—¶çš„doAcquireSharedInterruptiblyæ–¹æ³•ç›¸æ¯”ï¼ŒåŒºåˆ«ä¸»è¦åœ¨äºæ¯æ¬¡forå¾ªç¯æœŸé—´ï¼Œæ£€æŸ¥æ—¶é—´æ˜¯å¦è¿‡æœŸå’Œè°ƒç”¨å¸¦è¶…æ—¶çš„parkã€‚nanosTimeout > spinForTimeoutThresholdè¿™ä¸ªåˆ¤æ–­ä¸»è¦æ˜¯å› ä¸ºpark/unparkæœ¬èº«ä¹Ÿéœ€è¦èŠ±æ—¶é—´ï¼Œä¸ºäº†æ›´å‡†ç¡®åœ°å®Œæˆè¶…æ—¶çš„æœºåˆ¶ï¼Œåœ¨è¶…æ—¶æ—¶é—´é©¬ä¸Šå°±è¦åˆ°äº†çš„æ—¶å€™ï¼Œå°±è¿›å…¥è‡ªæ—‹ï¼Œä¸å†parkäº†ï¼Œè¿™åº”è¯¥æ˜¯Doug Leaæµ‹è¯•äº†park/unparkæ—¶é—´æ¯”1000çº³ç§’è¦é•¿å§ã€‚</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-java\\\"><code class=\\\"language-java\\\">\\t<span class=\\\"token comment\\\">/**\\n     * The number of nanoseconds for which it is faster to spin\\n     * rather than to use timed park. A rough estimate suffices\\n     * to improve responsiveness with very short timeouts.\\n     */</span>\\n    <span class=\\\"token keyword\\\">static</span> <span class=\\\"token keyword\\\">final</span> <span class=\\\"token keyword\\\">long</span> spinForTimeoutThreshold <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1000</span>L<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h1 id=\\\"æ€»ç»“\\\"><a href=\\\"#%E6%80%BB%E7%BB%93\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>æ€»ç»“</h1>\\n<p>J.U.Cé‡ŒAQSæ˜¯ä¸€ä¸ªç›¸å½“æ ¸å¿ƒçš„ç±»ï¼Œå¯ä»¥è¯´æ²¡æœ‰å®ƒå°±æ²¡æœ‰J.U.CåŒ…ã€‚æ¨èå¤§å®¶çœ‹çœ‹<a href=\\\"http://gee.cs.oswego.edu/dl/papers/aqs.pdf\\\">AQS</a>è¿™ç¯‡è®ºæ–‡ï¼ˆç½‘ä¸Šæœ‰ä¸€äº›ç¿»è¯‘ï¼Œæ¨èå¤§å®¶è¿˜æ˜¯çœ‹åŸæ–‡å§ï¼‰ã€‚ä¸»è¦æ˜¯ç”¨ä¸€ä¸ªstateè¡¨ç¤ºçŠ¶æ€ï¼Œå­ç±»å¯ä»¥æ ¹æ®éœ€è¦æ¥å®šä¹‰stateçš„å«ä¹‰ï¼Œä»¥åŠè·å–é‡Šæ”¾èµ„æºæ—¶å…·ä½“å¦‚ä½•æ“ä½œstateï¼Œå½“ç„¶éœ€è¦é€šè¿‡CASå®ç°åŸå­æ›´æ”¹ã€‚å½“è·å–ä¸åˆ°stateçš„æ—¶å€™ï¼Œçº¿ç¨‹åŠ å…¥é˜Ÿåˆ—ï¼ŒæŒ‚èµ·ã€‚é‡Šæ”¾ä¹‹åï¼Œå”¤é†’é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ã€‚AQSæ”¯æŒä¸¤ç§æ¨¡å¼ï¼Œç‹¬å EXCLUSIVEå’Œå…±äº«SHAREDã€‚J.U.Cé‡Œæœ¬èº«ä¹Ÿæœ‰å¾ˆå¤šç›´æ¥ç»§æ‰¿AQSå®ç°çš„ç±»ï¼ŒåŒ…æ‹¬Lockï¼ŒCountDownLatchï¼ŒSemaphoreï¼ŒFutureTaskç­‰ï¼Œå¦‚æœè¿™äº›è¿˜ä¸èƒ½æ»¡è¶³ä½ çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ç»§æ‰¿AQSæ¥å®ç°éœ€è¦ã€‚</p>\\n<h1 id=\\\"refers\\\"><a href=\\\"#refers\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Refers</h1>\\n<ol>\\n<li><a href=\\\"http://gee.cs.oswego.edu/dl/papers/aqs.pdf\\\">http://gee.cs.oswego.edu/dl/papers/aqs.pdf</a></li>\\n<li><a href=\\\"http://ifeve.com/introduce-abstractqueuedsynchronizer/\\\">http://ifeve.com/introduce-abstractqueuedsynchronizer/</a></li>\\n<li><a href=\\\"http://ifeve.com/jdk1-8-abstractqueuedsynchronizer/\\\">http://ifeve.com/jdk1-8-abstractqueuedsynchronizer/</a></li>\\n<li><a href=\\\"http://ifeve.com/jdk1-8-abstractqueuedsynchronizer-part2/\\\">http://ifeve.com/jdk1-8-abstractqueuedsynchronizer-part2/</a></li>\\n<li><a href=\\\"http://book.douban.com/subject/6522893/\\\">http://book.douban.com/subject/6522893/</a></li>\\n<li><a href=\\\"http://my.oschina.net/magicly007/blog/364102\\\">http://my.oschina.net/magicly007/blog/364102</a></li>\\n</ol>\\n<blockquote>\\n<p>Written with <a href=\\\"https://stackedit.io/\\\">StackEdit</a>.</p>\\n</blockquote>\",\"timeToRead\":9,\"excerpt\":\"java5ä¹‹åçš„java.util.concurrentåŒ…æ˜¯ä¸–ç•Œçº§å¹¶å‘å¤§å¸ˆDoug Leaçš„ä½œå“ï¼Œé‡Œé¢ä¸»è¦å®ç°äº† atomicåŒ…é‡ŒInteger/Longå¯¹åº”çš„åŸå­ç±»ï¼Œä¸»è¦åŸºäºCASï¼› ä¸€äº›åŒæ­¥å­ï¼ŒåŒ…æ‹¬Lockï¼ŒCountDownLatchï¼ŒSemaphoreâ€¦\",\"fields\":{\"slug\":\"/java-concurrrency-3-juc-source-code-read/\"},\"frontmatter\":{\"title\":\"Java Concurrencyï¼ˆä¸‰ï¼‰â€”â€”J.U.C AQSæºç è§£è¯»\",\"date\":\"2015-01-13\",\"category\":\"Java\",\"tags\":[\"Java\",\"concurrency\",\"jdk\",\"æºç é˜…è¯»\"]}}}]}},\"pathContext\":{\"current\":5,\"skip\":40,\"total\":6}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/page-5.json\n// module id = 630\n// module chunks = 10891958300999"],"sourceRoot":""}